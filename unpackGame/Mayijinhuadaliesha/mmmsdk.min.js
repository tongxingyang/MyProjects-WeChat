function i() {
    for (var i in this.appid = "", this.pf = "", this.domain = "", this.openid = "", 
    this.session_key = "", this.options = wx.getLaunchOptionsSync(), this.systeminfo = wx.getSystemInfoSync(), 
    this.os = 1, this.via = "scene=" + this.options.scene + "&appplatform=" + this.systeminfo.AppPlatform, 
    -1 != this.systeminfo.system.indexOf("iOS") && (this.os = 2), this.options.query) this.via = this.via + "&" + i + "=" + this.options.query[i];
}

i.prototype.init = function(i, o, e, t) {
    this.appid = i, this.pf = o, this.domain = e, this.code2reg(t);
}, i.prototype.report = function(i, o, e) {
    wx.request({
        method: "POST",
        url: "https://report." + this.domain + ".com/rpt/" + i,
        data: o,
        header: {
            "content-type": "application/json"
        },
        success: function(i) {
            e(i);
        },
        fail: function(o) {
            console.log(i, "fail", o);
        }
    });
}, i.prototype.code2reg = function(i) {
    var o = this;
    try {
        var e = wx.getStorageSync("mmmgame_openid");
        if (e) return o.openid = e, o.session_key = "", o.login(), void (i && i({
            ret: 0,
            msg: "",
            openid: e,
            session_key: "",
            unionid: "",
            cached: 1
        }));
    } catch (e) {
        e = VM2_INTERNAL_STATE_DO_NOT_USE_OR_PROGRAM_WILL_FAIL.handleException(e);
        console.log(e);
    }
    wx.login({
        success: function(e) {
            if (e.code) {
                var t = {
                    appid: o.appid,
                    pf: o.pf,
                    via: o.via,
                    code: e.code,
                    mobile: o.systeminfo.brand,
                    mobiletype: o.systeminfo.model,
                    os: o.os,
                    version: o.systeminfo.version,
                    system: o.systeminfo.system,
                    systeminfo: o.systeminfo,
                    platform: o.systeminfo.platform
                };
                o.report("code2reg", t, function(t) {
                    o.openid = t.data.openid, o.session_key = t.data.session_key, 0 == t.data.ret && wx.setStorage({
                        key: "mmmgame_openid",
                        data: t.data.openid
                    }), i && i(e);
                });
            }
        }
    });
}, i.prototype.regchar = function(i, o, e, t) {
    var s = this;
    if ("" != s.openid) {
        var n = {
            appid: s.appid,
            openid: s.openid,
            pf: s.pf,
            via: s.via,
            mobile: s.systeminfo.brand,
            mobiletype: s.systeminfo.model,
            os: s.os,
            zoneid: i,
            zonename: o,
            roleid: e,
            rolename: t
        };
        s.report("regchar", n, function(i) {});
    }
}, i.prototype.login = function() {
    var i = this;
    if ("" != i.openid) {
        var o = {
            appid: i.appid,
            openid: i.openid,
            pf: i.pf,
            via: i.via,
            mobile: i.systeminfo.brand,
            mobiletype: i.systeminfo.model,
            os: i.os
        };
        i.report("login", o, function(i) {});
    }
}, wx.mmmsdk = new i();