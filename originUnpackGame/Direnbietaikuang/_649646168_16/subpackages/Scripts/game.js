
	var global = (function () { return this })();	if (!global && typeof GameGlobal !== 'undefined') global = GameGlobal;	var pluginInfoMap = {};	;	global.requirePlugin = global.requirePlugin || function(path) {		    var position = path.indexOf('/');    		var alias = '';    		var pagePath = '';    		if (position !== -1) {    		    alias = path.substr(0, position);    		    pagePath = path.substr(position + 1, path.length);    		}    		else {    		    alias = path;    		}    		if (pluginInfoMap.hasOwnProperty(alias)) {    		    var realPath = '';    		    if (pagePath.length === 0) {    		        realPath =  '__plugin__/' + pluginInfoMap[alias].appid;    		        return require(realPath);    		    } else {    		        realPath = '__plugin__/' + pluginInfoMap[alias].appid + '/' + pagePath;    		        return require(realPath);    		    }    		}    		else {    		    console.error('not found alias: ', alias);    		    throw new Error('Plugin ' + alias + ' is not defined.')    		}	};	define("subpackages/Scripts/game.js", function(require, module, exports){ 			
"use strict";var t,e;System.register("chunks:///_virtual/AdManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AppConfig.ts","./JJMgr.ts","./WxPlatformBannerAd.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,i=t.director},function(t){o=t.default},function(t){r=t.default},function(t){s=t.default}],execute:function(){n._RF.push({},"0f7d9IFvFFPkpPN29QuFbFm","AdManager",void 0),t("default",function(){function t(){this.videoAd=null,this.videoAdonClose=void 0}var n=t.prototype;return n.createRewardedVideoAd=function(t){var e=this;t||(t={}),t.onClose||(t.onClose=function(){}),t.onError||(t.onError=function(){}),window.wx.showLoading({title:"正在拉起广告...",mask:!0}),i.pause(),this.videoAd||(this.videoAd=window.wx.createRewardedVideoAd({adUnitId:o.wechat.videoAdUnitId[0]}),this.videoAd.onLoad((function(t){console.log("VideoAd广告加载事件：",t)})),this.videoAd.onError((function(e){console.log("VideoAd广告错误事件：",e),i.resume(),window.wx.hideLoading({}),t.onError(e)}))),this.videoAdonClose&&this.videoAd.offClose(this.videoAdonClose),this.videoAdonClose=function(n){i.resume(),window.wx.hideLoading({}),100*Math.random()<r.instance.dataConfig.front_double_vi_chance?n.isEnded?t.onClose(n):window.wx.showModal({title:"提示",content:"看完视频才会有奖励！！！",confirmText:"继续观看",cancelText:"下次再来",success:function(i){i.confirm?(console.log("用户点击确定"),e.createRewardedVideoAd(t)):i.cancel&&(console.log("用户点击取消"),t.onClose(n))}}):t.onClose(n),e.videoAd.offClose(e.videoAdonClose)},this.videoAd.onClose(this.videoAdonClose),this.videoAd.load().then((function(){e.videoAd.show().then((function(){window.wx.hideLoading({})}))}))},n.showHomeGridAd=function(){var t=o.wechat.gridAd,e=window.wx.createCustomAd({adUnitId:t[Math.floor(Math.random()*t.length)],style:{left:10,top:100,width:100,height:100}});e.onError((function(t){console.log("结算格子加载失败")})),e.onLoad((function(){console.log("结算格子加载成功")})),e.show()},n.showBanner=function(){s.Instance.showBannerFun2()},n.hideBanner=function(){s.Instance.hideBannerFun(!0)},e(t,null,[{key:"instance",get:function(){return null===t._instance&&(t._instance=new t),t._instance},set:function(e){t._instance=e}}]),t}())._instance=null,n._RF.pop()}}})),System.register("chunks:///_virtual/AircraftCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.BaseCtrl}],execute:function(){var s;n._RF.push({},"21773WhV8BMK5/HZ6IsTI+s","AircraftCtrl",void 0);var a=i.ccclass;i.property,t("AircraftCtrl",a("AircraftCtrl")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.Aircraft,this.init("Aircraft")},i.onDisable=function(){t.prototype.onDisable.call(this)},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/AircraftEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./RoleEntity.ts","./RoleAnimComp.ts","./JoystickMoveComp.ts","./GlobalSingle.ts","./PoolManager.ts","./Constant.ts","./BulletPlaneEntity.ts","./Util.ts","./StorageData.ts","./ThirdFreeLookCamera.ts","./EventManager.ts","./PlaneEntity.ts","./PlaneComp.ts","./AudioManager.ts","./ArrowComp.ts","./JJMgr.ts","./AdManager.ts","./UMEvent.ts","./UMTrack.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M,T,k,N,R,B,F,L,A,D,x,I,U,z,G,H,O,V,j;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose,s=t.createClass},function(t){a=t.cclegacy,l=t._decorator,c=t.Enum,u=t.Node,h=t.Label,p=t.BoxCollider,d=t.Vec3,f=t.Quat,g=t.v3,m=t.instantiate,v=t.MeshRenderer,y=t.physics,b=t.tween,C=t.RigidBody},function(t){_=t.ecs},function(t){E=t.CCComp},function(t){w=t.RoleEntity},function(t){S=t.RoleAnimComp},function(t){P=t.JoystickMoveComp},function(t){M=t.GlobalSingle},function(t){T=t.default},function(t){k=t.ResEnum,N=t.GameEvent,R=t.Sounds,B=t.GameState},function(t){F=t.BulletPlaneEntity},function(t){L=t.Util},function(t){A=t.StorageData},function(t){D=t.ThirdFreeLookCamera},function(t){x=t.EventManager},function(t){I=t.PlaneEntity},function(t){U=t.PlaneComp},function(t){z=t.default},function(t){G=t.ArrowComp},function(t){H=t.default},function(t){O=t.default},function(t){V=t.UMEvent},function(t){j=t.UMTrack}],execute:function(){var W,Q,J,X,q,Y,Z,K,$,tt,et,nt,it,ot,rt,st,at,lt,ct,ut,ht,pt,dt,ft,gt,mt;a._RF.push({},"0a4bcLIFKNGnZOsuOPYzK3h","AircraftEntity",void 0);var vt=l.ccclass,yt=l.property,bt=t("AircraftStatus",c({idle:0,downling:1,battle:2}));t("AircraftEntity",(W=vt("AircraftEntity"),Q=_.register("AircraftEntity",!1),J=yt(u),X=yt(u),q=yt(u),Y=yt(u),Z=yt(u),K=yt(u),$=yt(u),tt=yt(h),et=yt(p),nt=yt(u),it=yt(p),W(ot=Q((st=e((rt=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"PlaneNode",st,o(e)),i(e,"AirscrewNode",at,o(e)),i(e,"MarkNode",lt,o(e)),i(e,"LandingPos",ct,o(e)),i(e,"BombPlace",ut,o(e)),i(e,"BombItem",ht,o(e)),i(e,"Clock",pt,o(e)),i(e,"ClockLabel",dt,o(e)),i(e,"aircraftAdCollier",ft,o(e)),i(e,"adBtn",gt,o(e)),i(e,"collider",mt,o(e)),e.status=bt.idle,e._airscrewEuler=new d,e._airscrewQuat=new f,e._aQuat=new f,e._aircraftWorldPos=void 0,e.weaponData=void 0,e.bulletData=void 0,e.dropBombTime=0,e._bombNum=0,e.dropCount=0,e.roleEntity=void 0,e.spawnBombTime=0,e.currentTime=0,e._quat=new f,e.isFirst=!1,e._playAd=!1,e.buildingData=void 0,e}n(e,t);var a=e.prototype;return a.onLoad=function(){t.prototype.onLoad.call(this),this.buildingData=M.instance.tables.Building.Aircraft,this.weaponData=M.instance.tables.Weapon.Aircraft,this.bulletData=M.instance.tables.Bullet[this.weaponData.BulletID]},a.reset=function(){T.instance.putItem(k.Aircraft,this.node,!0)},a.onEnable=function(){this.collider.on("onTriggerEnter",this.onTriggerEnter,this),this.aircraftAdCollier.on("onTriggerEnter",this.AircraftAdCollierFun,this),x.instance.on(N.LevelEvent,this.LevelEventFun,this),x.instance.on(N.UpgradeTeamLevelUIClose,this.UpgradeTeamLevelUICloseFun,this),x.instance.on(N.UseAircraft,this.UseAircraftFun,this),x.instance.on(N.StatusEvent,this.StatusEventFun,this),x.instance.on(N.HouseMaxLevel,this.HouseMaxLevelFun,this),this.MarkNode.setScale(g(this.weaponData.Range/5,1,this.weaponData.Range/5)),this.BombPlace.destroyAllChildren();for(var t=0;t<this.buildingData.UpperLimit;t++){var e=m(this.BombItem);e.parent=this.BombPlace,e.setPosition(g(t%5*-1,0,-2*Math.floor(t/5)))}this.schedule(this.clockLoop,1),this.firstUnlock()},a.update=function(){this.status==bt.idle?this.bombNum<this.BombPlace.children.length&&(this.spawnBombTime+=1/60,this.currentTime+=1/60,this.spawnBombTime>this.weaponData.CD/this.BombPlace.children.length&&(this.spawnBombTime=0,this.spawnOneBomb())):this.status==bt.downling?this.updateAirscrew():(this.updateAirscrew(),this.dropBombTime+=1/60,this.dropCount<=0&&this.dropBombTime>2&&(this.dropCount=5,this.schedule(this.dropBomb,.4)),(this.bombNum<=0||M.instance.enemyEntities.length<=0&&this.PlaneNode.getComponent(I).ent.has(U))&&(this.status=bt.downling,this.roleEntity.ent.get(P).moveTarget=null,this.PlaneNode.getComponent(I).backAirport1()))},a.updateAirscrew=function(){f.rotateZ(this._aQuat,this.AirscrewNode.getRotation(),-.2),this.AirscrewNode.setRotation(this._aQuat),this._aircraftWorldPos=this.PlaneNode.getWorldPosition(),this._aircraftWorldPos.y=this.MarkNode.position.y,this.MarkNode.setWorldPosition(this._aircraftWorldPos)},a.onDisable=function(){this.collider.off("onTriggerEnter",this.onTriggerEnter,this),this.aircraftAdCollier.off("onTriggerEnter",this.AircraftAdCollierFun,this),x.instance.off(N.LevelEvent,this.LevelEventFun,this),x.instance.off(N.UpgradeTeamLevelUIClose,this.UpgradeTeamLevelUICloseFun,this),x.instance.off(N.UseAircraft,this.UseAircraftFun,this),x.instance.off(N.StatusEvent,this.StatusEventFun,this),x.instance.off(N.HouseMaxLevel,this.HouseMaxLevelFun,this),this.unschedule(this.clockLoop),this.unschedule(this.dropBomb),this.ent&&this.ent.destroy(!0)},a.AircraftAdCollierFun=function(){this.playAd||(z.instance.playSoundEffect(R.Button),O.instance.createRewardedVideoAd({onClose:function(t){t.isEnded&&(j.instance.trackEvent(V.chufa_vi_hongzji),x.instance.emit(N.UseAircraft))}}))},a.UseAircraftFun=function(){this.playAd=!0,this.refreshCD()},a.LevelEventFun=function(){this.firstUnlock()},a.UpgradeTeamLevelUICloseFun=function(){this.currentTime=0},a.StatusEventFun=function(){this.ent.has(G)&&A.instance.status==B.win&&this.PlaneNode.getComponent(I).ent.has(G)&&this.PlaneNode.getComponent(I).ent.remove(G)},a.HouseMaxLevelFun=function(){this.firstUnlock()},a.firstUnlock=function(){A.instance.level==this.buildingData.Level&&M.instance.houseMaxLevel>0&&(this.refreshCD(),M.instance.enemyEntities.length>0&&!this.PlaneNode.getComponent(I).ent.has(G)&&this.PlaneNode.getComponent(I).ent.add(G).init(this.PlaneNode,!0),H.instance.dataConfig.front_fhzj_vi_switch?(this.isFirst=!1,this.playAd=!1):(this.isFirst=!0,this.playAd=!0))},a.refreshCD=function(){this.currentTime=this.weaponData.CD,this.clockLoop();for(var t=0;t<this.BombPlace.children.length;t++)this.BombPlace.children[t].children.length<=0&&this.spawnBomb(this.BombPlace.children[t])},a.clockLoop=function(){var t=Math.floor(this.weaponData.CD-this.currentTime);t>=0&&(this.ClockLabel.string=L.instance.formatSecondsMS(t),this.ClockLabel.node.active=!0,this.ClockLabel.updateRenderData(!0),this.ClockLabel.node.active=!1,this.Clock.getComponent(v).material.setProperty("mainTexture",this.ClockLabel.spriteFrame.texture))},a.onTriggerEnter=function(t){var e=t.otherCollider.node.getComponent(w);this.bombNum>=this.BombPlace.children.length&&e&&e.isPlayer&&(j.instance.trackEvent(V.chufa_hongzji),this.PlaneNode.getComponent(I).ent.has(G)&&this.PlaneNode.getComponent(I).ent.remove(G),M.instance.enemyEntities.length>0?(this.roleEntity=e,this.isFirst?this.startFly():this.playAd&&(this.startFly(),this.playAd=!1)):console.log("没有敌人，不能起飞"))},a.startFly=function(){var t=this;z.instance.playSoundEffect(R.PlaneFlight,!0),x.instance.emit(N.AircraftUnlock,!1);var e=g(0,.4,.2);this.roleEntity.node.parent=this.PlaneNode,this.roleEntity.node.setPosition(e),this.roleEntity.ent.get(S).sit(),this.roleEntity.node.setRotationFromEuler(g(0,0,0)),this.roleEntity.ent.get(P).moveTarget=null,this.roleEntity.rigidbody.type=y.ERigidBodyType.STATIC,this.MarkNode.active=!0,M.instance.camera3d.getComponent(D).yDel=-5;for(var n=0;n<this.BombPlace.children.length;n++){var i=this.BombPlace.children[n];i.children.length>0&&function(){var e=i.children[0];b(e).to(.05*n,{worldPosition:t.PlaneNode.worldPosition}).call((function(){e.getComponent(F).ent.destroy(!0)})).start()}()}this.roleEntity.isTakePlane=!0,this.status=bt.battle,b(this.PlaneNode).delay(.05*this.BombPlace.children.length).call((function(){t.PlaneNode.getComponent(I).init(t),t.roleEntity.ent.get(P).moveTarget=t.PlaneNode})).start()},a.spawnOneBomb=function(){for(var t=0;t<this.BombPlace.children.length;t++){var e=this.BombPlace.children[t];if(e.children.length<=0){this.spawnBomb(e);break}}},a.spawnBomb=function(t){var e=this,n=k.bulletPath+"/"+this.bulletData.Prefab;T.instance.getItemSync(n).then((function(i){i&&i.isValid&&t&&t.isValid&&(i.parent=t,e.bombNum++,i.setRotationFromEuler(g(-90,0,0)),i.setPosition(0,.1,0),i.getComponent(C).useGravity=!1,i.getComponent(p).enabled=!1,i.getComponent(F).ptah=n,e.bombNum==e.BombPlace.children.length&&(e.currentTime=e.weaponData.CD,e.clockLoop()))}))},a.dropBomb=function(){if(this.dropCount>0&&M.instance.enemyEntities.length>0)for(var t,e=r(M.instance.enemyEntities);!(t=e()).done;){var n=t.value;if(n.get(w)){var i=n.get(w).node.getWorldPosition();if(i.y=0,d.distance(this._aircraftWorldPos,i)<this.weaponData.Range){this.dropOneBomb();break}}}},a.dropOneBomb=function(){var t=this,e=k.bulletPath+"/"+this.bulletData.Prefab;T.instance.getItemSync(e).then((function(n){n.parent=M.instance.map,n.setRotationFromEuler(g(0,0,0)),n.setWorldPosition(t.PlaneNode.getWorldPosition()),n.getComponent(F).ptah=e,n.getComponent(F).setData(t.weaponData.Range,t.bulletData.Atk),t.bombNum>0&&(t.bombNum--,t.dropCount--,t.dropCount<=0&&(t.dropBombTime=0,t.unschedule(t.dropBomb)))}))},a.backAirport=function(){this.MarkNode.active=!1,M.instance.camera3d.getComponent(D).yDel=3,this.PlaneNode.getComponent(I).resetPlane(),this.PlaneNode.setRotationFromEuler(g(0,180,0)),z.instance.stopSoundEffect(R.PlaneFlight),this.roleEntity.rigidbody.type=y.ERigidBodyType.DYNAMIC,this.roleEntity.node.parent=M.instance.map,this.roleEntity.node.setWorldPosition(this.PlaneNode.getWorldPosition()),this.roleEntity.ent.get(P).moveTarget=this.roleEntity.node,this.status=bt.idle,this.currentTime=this.bombNum*(this.weaponData.CD/this.BombPlace.children.length),this.playAd=!1,this.roleEntity.isTakePlane=!1,this.isFirst&&(this.isFirst=!1,x.instance.emit(N.ShowPlaneAndNbomb))},s(e,[{key:"bombNum",get:function(){return this._bombNum},set:function(t){this._bombNum=t,x.instance.emit(N.PlaneDropBombEvent,this.bombNum),this.bombNum>=this.BombPlace.children.length&&x.instance.emit(N.AircraftUnlock,!0)}},{key:"playAd",get:function(){return this._playAd},set:function(t){this._playAd=t,this._playAd?this.adBtn.active=!1:this.adBtn.active=!0}}]),e}(E)).prototype,"PlaneNode",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=e(rt.prototype,"AirscrewNode",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lt=e(rt.prototype,"MarkNode",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ct=e(rt.prototype,"LandingPos",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ut=e(rt.prototype,"BombPlace",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ht=e(rt.prototype,"BombItem",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pt=e(rt.prototype,"Clock",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dt=e(rt.prototype,"ClockLabel",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ft=e(rt.prototype,"aircraftAdCollier",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gt=e(rt.prototype,"adBtn",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mt=e(rt.prototype,"collider",[it],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ot=rt))||ot)||ot)),a._RF.pop()}}})),System.register("chunks:///_virtual/AirDropComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"3e3d1nxnYlGR6nQUclbjXl+","AirDropComp",void 0);var s=i.ccclass;i.property,t("AirDropComp",s("AirDropComp")(r=o.register("AirDropComp")(r=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).borthPos=void 0,e.awardType=void 0,e.awardNum=void 0,e}return e(n,t),n.prototype.reset=function(){},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/AirDropCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./JJMgr.ts","./AirDropEntity.ts","./EventManager.ts","./PoolManager.ts","./Constant.ts","./StorageData.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.default},function(t){r=t.AirDropEntity},function(t){s=t.EventManager},function(t){a=t.default},function(t){l=t.GameEvent,c=t.ResEnum,u=t.GameState},function(t){h=t.StorageData},function(t){p=t.BaseCtrl}],execute:function(){var d;n._RF.push({},"c9b34L+WcJDz7IXOZJ7fufz","AirDropCtrl",void 0);var f=i.ccclass;i.property,t("AirDropCtrl",f("AirDropCtrl")(d=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),s.instance.on(l.ShowAirDrop,this.ShowAirDropFun,this),this.init()},i.onDisable=function(){t.prototype.onDisable.call(this),s.instance.off(l.ShowAirDrop,this.ShowAirDropFun,this),this.unschedule(this.showPrefab)},i.ShowAirDropFun=function(){var t=this;a.instance.getItemSync(c.AirDrop).then((function(e){e&&(e.getComponent(r).fromType=1,e.parent=t.node)}))},i.init=function(){this.scheduleOnce(this.showPrefab,o.instance.dataConfig.front_kongtou_interval_time||300)},i.showPrefab=function(){var t=this;this.isUnlocked=!0,h.instance.status==u.win?this.scheduleOnce(this.showPrefab,o.instance.dataConfig.front_kongtou_interval_time||300):a.instance.getItemSync(c.AirDrop).then((function(e){e&&(e.getComponent(r).fromType=0,e.getComponent(r).complete=function(){t.scheduleOnce(t.showPrefab,o.instance.dataConfig.front_kongtou_interval_time||300)},e.parent=t.node)}))},n}(p))||d),n._RF.pop()}}})),System.register("chunks:///_virtual/AirDropEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./AirDropComp.ts","./Constant.ts","./GlobalSingle.ts","./RoleEntity.ts","./PoolManager.ts","./ThirdFreeLookCamera.ts","./AudioManager.ts","./BaseCtrl.ts","./BadgeStackEntity.ts","./UIManager.ts","./PlaneEntity.ts","./EventManager.ts","./AdManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M,T,k,N;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.BoxCollider,c=t.Animation,u=t.Vec3},function(t){h=t.ecs},function(t){p=t.CCComp},function(t){d=t.AirDropComp},function(t){f=t.ResEnum,g=t.BadgeType,m=t.Sounds,v=t.GameEvent,y=t.UIID},function(t){b=t.GlobalSingle},function(t){C=t.RoleEntity},function(t){_=t.default},function(t){E=t.ThirdFreeLookCamera},function(t){w=t.default},function(t){S=t.BaseCtrl},function(t){P=t.BadgeStackEntity},function(t){M=t.UIManager},function(t){T=t.PlaneEntity},function(t){k=t.EventManager},function(t){N=t.default}],execute:function(){var R,B,F,L,A,D,x,I,U,z;r._RF.push({},"1b28auUZlVGRqqOwfUFA9++","AirDropEntity",void 0);var G=s.ccclass,H=s.property;t("AirDropEntity",(R=G("AirDropEntity"),B=h.register("AirDropEntity",!1),F=H(a),L=H(a),A=H(a),R(D=B((I=e((x=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"animNode",I,o(e)),i(e,"videoBtn",U,o(e)),i(e,"badges",z,o(e)),e.airDropComp=null,e.collider=null,e.skeAnim=void 0,e._isOpen=!1,e.complete=void 0,e.fromType=0,e._temPos=void 0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this),this.collider=this.node.getComponent(l)},r.reset=function(){this._isOpen=!1,_.instance.putItem(f.AirDrop,this.node)},r.onEnable=function(){this.airDropComp=new d,this.airDropComp.awardType=g.gray,this.airDropComp.awardNum=10,this.ent.add(this.airDropComp),this.collider.enabled=!1,this.skeAnim=this.animNode.getComponent(c),this.skeAnim.on(c.EventType.FINISHED,this.animEvenFun,this),this.collider.on("onTriggerEnter",this.onTriggerEnter,this),this._isOpen=!1,b.instance.camera3d&&b.instance.camera3d.getComponent(E).target&&b.instance.camera3d.getComponent(E).target.getComponent(C)&&b.instance.camera3d.getComponent(E).setFollowTarget(this.animNode.getChildByName("Extras_1")),this.fromType?this.videoBtn.active=!1:this.videoBtn.active=!0},r.onDisable=function(){this.skeAnim.off(c.EventType.FINISHED,this.animEvenFun,this),this.collider.off("onTriggerEnter",this.onTriggerEnter,this),this.ent&&this.ent.destroy(!0)},r.animEvenFun=function(t,e){t==c.EventType.FINISHED&&("AirDropFalling"==e.name&&(w.instance.playSoundEffect(m.DropBoxDown),this.collider.enabled=!0,"Extras_1"==b.instance.camera3d.getComponent(E).target.name&&b.instance.camera3d.getComponent(E).setFollowTarget(b.instance.player),k.instance.emit(v.AirDropEnable)),"AirDropOpen"==e.name&&(w.instance.playSoundEffect(m.DropBoxOpen),this._isOpen=!0))},r.spawnBadgeStack=function(t,e){var n=this;_.instance.getItemSync(f.BadgeStack).then((function(i){i.parent=n.node,i.getComponent(P).initStack(t,e),i.getComponent(P).badgeStackComp.completeStack=function(){console.log("空投被拾取"),n.complete&&n.complete(),n.ent&&n.ent.destroy(!0)}}))},r.onTriggerEnter=function(t){var e=this,n=t.otherCollider.node.getComponent(C);n&&n.isPlayer&&!this._isOpen&&(this.fromType?M.instance.open(y.BuffUi,{closeUi:function(t){e.spawnBadgeStack(t?20:10,0),e.skeAnim.play("AirDropOpen")}}):N.instance.createRewardedVideoAd({onClose:function(t){t.isEnded&&(e.spawnBadgeStack(0,10),e.skeAnim.play("AirDropOpen"))}}))},r.showAirDrop=function(){w.instance.playSoundEffect(m.DropBoxFalling),this.getRandomPos(),this.node.setWorldPosition(this.airDropComp.borthPos),this.animNode.active=!0,this.skeAnim.play("AirDropFalling")},r.getRandomPos=function(){this.airDropComp.borthPos=b.instance.player.getWorldPosition(),this.airDropComp.borthPos.x+=60*Math.random()-30,this.airDropComp.borthPos.z+=60*Math.random()-30,this.airDropComp.borthPos.y=0;for(var t=!0,e=0;e<b.instance.enemyEntities.length;e++)if(this._temPos=b.instance.enemyEntities[e].get(C).node.getWorldPosition(),this._temPos.y=0,u.distance(this.airDropComp.borthPos,this._temPos)<3){t=!1;break}(this.airDropComp.borthPos.x>37||this.airDropComp.borthPos.x<-37||this.airDropComp.borthPos.z>37||this.airDropComp.borthPos.z<-29)&&(t=!1);for(var n=b.instance.map.getComponentsInChildren(S),i=0;i<n.length;i++)if(this._temPos=n[i].node.getWorldPosition(),this._temPos.y=0,u.distance(this.airDropComp.borthPos,this._temPos)<5){t=!1;break}n=null;for(var o=b.instance.map.getComponentsInChildren(T),r=0;r<o.length;r++)if(this._temPos=o[r].node.getWorldPosition(),this._temPos.y=0,u.distance(this.airDropComp.borthPos,this._temPos)<5){t=!1;break}o=null,t||this.getRandomPos()},e}(p)).prototype,"animNode",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(x.prototype,"videoBtn",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(x.prototype,"badges",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=x))||D)||D)),r._RF.pop()}}})),System.register("chunks:///_virtual/AirDropSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AirDropComp.ts","./AirDropEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator},function(t){r=t.AirDropComp},function(t){s=t.AirDropEntity},function(t){a=t.ecs}],execute:function(){var l;i._RF.push({},"624a7yowCVLQ4bkJzyEfKt5","AirDropSys",void 0);var c=o.ccclass;t("AirDropSys",c("AirDropSys")(l=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var o=i.prototype;return o.filter=function(){return a.allOf(r)},o.init=function(){},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value.get(s);o.animNode.active=!1,o.showAirDrop()}},o.firstUpdate=function(t){},o.update=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},i}(a.ComblockSystem))||l),i._RF.pop()}}})),System.register("chunks:///_virtual/AirDropUi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./JJMgr.ts","./UMTrack.ts","./GameUtil.ts","./UMEvent.ts","./AdManager.ts","./UIManager.ts","./UIView.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Toggle,l=t.Node},function(t){c=t.default},function(t){u=t.UMTrack},function(t){h=t.GameUtil},function(t){p=t.UMEvent},function(t){d=t.default},function(t){f=t.UIManager},function(t){g=t.UIView}],execute:function(){var m,v,y,b,C,_,E,w,S;r._RF.push({},"b02a5wzvs9HH7XS+gF2K+rI","AirDropUi",void 0);var P=s.ccclass,M=s.property;t("AirDropUi",(m=P("AirDropUi"),v=M(a),y=M(l),b=M(l),m((E=e((_=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"videoToggle",E,o(e)),i(e,"toggleArea",w,o(e)),i(e,"videoIcon",S,o(e)),e}n(e,t);var r=e.prototype;return r.onOpen=function(t){this.videoToggle.isChecked=!0,this.videoToggle.isChecked=!0,this.toggleCheckEvent(),c.instance.dataConfig.front_show_jiangli_switch?this.toggleArea.active=!0:this.toggleArea.active=!1,d.instance.showBanner()},r.onClose=function(){d.instance.hideBanner()},r.update=function(t){},r.toggleFun=function(){this.videoToggle.isChecked=!this.videoToggle.isChecked},r.toggleCheckEvent=function(){this.videoToggle.isChecked?this.videoIcon.active=!0:this.videoIcon.active=!1},r.confirm=function(){var t=this;this.videoToggle.isChecked?d.instance.createRewardedVideoAd({onClose:function(e){e.isEnded&&(u.instance.trackEvent(p.chufa_vi_kongtou),Math.random()<.5?(h.instance.showToast("恭喜获得10个金色铭牌"),h.instance.awardBadgeStack(10,0)):(h.instance.showToast("恭喜获得10个银色铭牌"),h.instance.awardBadgeStack(0,10)),f.instance.close(t))}}):f.instance.close(this)},r.closeUi=function(){f.instance.close(this)},e}(g)).prototype,"videoToggle",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(_.prototype,"toggleArea",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=e(_.prototype,"videoIcon",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=_))||C)),r._RF.pop()}}})),System.register("chunks:///_virtual/animation-curve.ts",["cc"],(function(t){var e,n,i;return{setters:[function(t){e=t.cclegacy,n=t.CurveRange,i=t.geometry}],execute:function(){function o(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var r=new i.Keyframe;return r.time=t,r.value=e,r.inTangent=n,r.outTangent=o,r}e._RF.push({},"6e273txUKRNG6K/6j/PEtnf","animation-curve",void 0),t("default",function(){function t(){}return t.linear=function(t,e,i,r){var s=(r-e)/(i-t),a=new n;return a.mode=n.Mode.Curve,a.curve.keyFrames.length=0,t===i?a.curve.addKey(o(t,e)):(a.curve.addKey(o(t,e,0,s)),a.curve.addKey(o(i,r,s,0))),a},t.easeInOut=function(t,e,i,r){var s=new n;return s.mode=n.Mode.Curve,s.curve.keyFrames.length=0,t===i?s.curve.addKey(o(t,e)):(s.curve.addKey(o(t,e,0,0)),s.curve.addKey(o(i,r,0,0))),s},t.constant=function(t){var e=new n;return e.constant=t,e},t.one=function(){return this.constant(1)},t.zero=function(){return this.constant(0)},t}()),e._RF.pop()}}})),System.register("chunks:///_virtual/AnimFinishRecycle.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./Recycle.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Animation},function(t){r=t.default},function(t){s=t.Recycle}],execute:function(){var a;n._RF.push({},"d0ba26D6JVOJL88SxD/ea9s","AnimFinishRecycle",void 0);var l=i.ccclass;i.property,t("AnimFinishRecycle",l("AnimFinishRecycle")(a=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).anim=void 0,e}e(n,t);var i=n.prototype;return i.onEnable=function(){this.anim=this.node.getComponent(o),this.anim||(this.anim=this.node.getComponentInChildren(o)),this.anim.on(o.EventType.FINISHED,this.animEvenFun,this),this.anim.play()},i.update=function(t){},i.onDisable=function(){this.anim.off(o.EventType.FINISHED,this.animEvenFun,this)},i.animEvenFun=function(t,e){t==o.EventType.FINISHED&&this.recycle()},i.recycle=function(){this.anim.off(o.EventType.FINISHED,this.animEvenFun,this),r.instance.putItem(this.path,this.node)},n}(s))||a),n._RF.pop()}}})),System.register("chunks:///_virtual/Arrow3dEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs},function(t){r=t.CCComp}],execute:function(){var s;n._RF.push({},"459e8Sw5XNGG7qA4ax0x8TM","Arrow3dEntity",void 0);var a=i.ccclass;i.property,t("Arrow3dEntity",a("Arrow3dEntity")(s=o.register("Arrow3dEntity",!1)(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this)},i.reset=function(){},i.onEnable=function(){},i.start=function(){},i.onDisable=function(){},n}(r))||s)||s),n._RF.pop()}}})),System.register("chunks:///_virtual/ArrowComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./PoolManager.ts","./ArrowEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.GlobalSingle},function(t){s=t.default},function(t){a=t.ArrowEntity},function(t){l=t.ecs}],execute:function(){var c;n._RF.push({},"9fa400pay5BT4KDzW5rxxjA","ArrowComp",void 0);var u=i.ccclass;i.property,t("ArrowComp",u("ArrowComp")(c=l.register("ArrowComp")(c=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).target=null,e.ArrowNode=void 0,e.Arrow3dNode=void 0,e.Arrow3dIcon=void 0,e}e(n,t);var i=n.prototype;return i.reset=function(){s.instance.putItem(o.Arrow,this.ArrowNode,!0),s.instance.putItem(o.Arrow3d,this.Arrow3dNode,!0),this.ArrowNode=null,this.Arrow3dNode=null},i.init=function(t,e){var n=this;void 0===e&&(e=!1),this.target=t,this.ArrowNode||s.instance.getItemSync(o.Arrow).then((function(t){n.ArrowNode=t,n.ArrowNode.name="ArrowNode"+r.instance.guideStep,r.instance.canvas.node.insertChild(n.ArrowNode,0),n.ArrowNode.getComponent(a).tips1.active=!1,n.ArrowNode.getComponent(a).tips2.active=!1,n.ArrowNode.getComponent(a).tips3.active=!1,n.ArrowNode.getComponent(a).tips4.active=!1,n.ArrowNode.getComponent(a).tips5.active=!1,e||(1==r.instance.guideStep&&(n.ArrowNode.getComponent(a).tips1.active=!0),2==r.instance.guideStep&&(n.ArrowNode.getComponent(a).tips2.active=!0),3==r.instance.guideStep&&(n.ArrowNode.getComponent(a).tips3.active=!0),4==r.instance.guideStep&&(n.ArrowNode.getComponent(a).tips4.active=!0),5==r.instance.guideStep&&(n.ArrowNode.getComponent(a).tips5.active=!0))})),this.Arrow3dNode||s.instance.getItemSync(o.Arrow3d).then((function(t){n.Arrow3dNode=t,n.Arrow3dNode.name="Arrow3dNode"+r.instance.guideStep,n.Arrow3dNode.parent=r.instance.map,n.Arrow3dIcon=n.Arrow3dNode.getChildByName("Arrow3dIcon")}))},n}(l.Comp))||c)||c),n._RF.pop()}}})),System.register("chunks:///_virtual/ArrowEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.tween,c=t.v3},function(t){u=t.ecs},function(t){h=t.CCComp}],execute:function(){var p,d,f,g,m,v,y,b,C,_,E,w,S,P,M,T;r._RF.push({},"2662cEcMJ1BJ4ExqniCX/Bb","ArrowEntity",void 0);var k=s.ccclass,N=s.property;t("ArrowEntity",(p=k("ArrowEntity"),d=u.register("ArrowEntity",!1),f=N(a),g=N(a),m=N(a),v=N(a),y=N(a),b=N(a),p(C=d((E=e((_=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"ArrowIcon",E,o(e)),i(e,"tips1",w,o(e)),i(e,"tips2",S,o(e)),i(e,"tips3",P,o(e)),i(e,"tips4",M,o(e)),i(e,"tips5",T,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){},r.onEnable=function(){l(this.ArrowIcon).to(.1,{scale:c(.8,.8,1)}).to(.1,{scale:c(1,1,1)}).union().start()},r.start=function(){},r.onDisable=function(){},e}(h)).prototype,"ArrowIcon",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(_.prototype,"tips1",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=e(_.prototype,"tips2",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(_.prototype,"tips3",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(_.prototype,"tips4",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(_.prototype,"tips5",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=_))||C)||C)),r._RF.pop()}}})),System.register("chunks:///_virtual/asset-operation.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"4915a+F6HRKOqzthrteei1v","asset-operation",void 0),t("createMesh",void 0),t("saveMesh",void 0),e._RF.pop()}}})),System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameUtil.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,i=t.AudioSource},function(t){o=t.GameUtil}],execute:function(){n._RF.push({},"19595mbECtMgaAuunkvW31B","AudioManager",void 0),t("default",function(){function t(){this._audio_sources={}}var n=t.prototype;return n.playSoundEffect=function(t,e,n){var o=this;if(void 0===e&&(e=!1),void 0===n&&(n=1),this._audio_sources[t])this._audio_sources[t].source.loop=e,this._audio_sources[t].source.volume=n,this._audio_sources[t].clip&&(e?this._audio_sources[t].source.play():this._audio_sources[t].source.playOneShot(this._audio_sources[t].clip,1));else{var r=new i;r.loop=e,r.volume=n,this._audio_sources[t]={source:r,clip:null},this.loadAudio(t).then((function(n){o._audio_sources[t].clip=n,o._audio_sources[t].source.clip=o._audio_sources[t].clip,e?o._audio_sources[t].source.play():o._audio_sources[t].source.playOneShot(o._audio_sources[t].clip,1)})).catch((function(t){console.warn("音频加载出错",t)}))}},n.stopSoundEffect=function(t){this._audio_sources[t]&&this._audio_sources[t].source.stop()},n.loadAudio=function(t){return new Promise((function(e,n){o.instance.getBundle("first").then((function(i){i.load("sound/"+t,(function(t,i){t?n(t):e(i)}))}))}))},e(t,null,[{key:"instance",get:function(){return null===t._instance&&(t._instance=new t),t._instance},set:function(e){t._instance=e}}]),t}())._instance=null,n._RF.pop()}}})),System.register("chunks:///_virtual/AwardUi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UMTrack.ts","./GameUtil.ts","./UMEvent.ts","./AdManager.ts","./UIManager.ts","./UIView.ts"],(function(t){var e,n,i,o,r,s,a,l,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.UMTrack},function(t){r=t.GameUtil},function(t){s=t.UMEvent},function(t){a=t.default},function(t){l=t.UIManager},function(t){c=t.UIView}],execute:function(){var u;n._RF.push({},"6538bitY+5CgpBx6d96xc8j","AwardUi",void 0);var h=i.ccclass;i.property,t("AwardUi",h("AwardUi")(u=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onOpen=function(t){a.instance.showBanner()},i.onClose=function(){a.instance.hideBanner()},i.confirm=function(){var t=this;a.instance.createRewardedVideoAd({onClose:function(e){if(e.isEnded){o.instance.trackEvent(s.chufa_vi_upgrade_more_glod);var n=r.instance.getRandomFromServer("AwardUi");r.instance.showToast("恭喜获得"+n+"个金色铭牌"),r.instance.awardBadgeStack(n,0),l.instance.close(t)}}})},i.closeUi=function(){l.instance.close(this)},n}(c))||u),n._RF.pop()}}})),System.register("chunks:///_virtual/BadgeComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./PoolManager.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.default},function(t){s=t.ecs}],execute:function(){var a;n._RF.push({},"52c1dFK9SFA+JxdCbBlJZsG","BadgeComp",void 0);var l=i.ccclass;i.property,t("BadgeComp",l("BadgeComp")(a=s.register("BadgeComp")(a=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).badge=null,e}return e(n,t),n.prototype.reset=function(){r.instance.putItem(o.Badge,this.badge)},n}(s.Comp))||a)||a),n._RF.pop()}}})),System.register("chunks:///_virtual/BadgeEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./Constant.ts","./EventManager.ts","./BadgeComp.ts","./StorageData.ts","./Util.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator,r=t.v3,s=t.Tween,a=t.RigidBody,l=t.BoxCollider,c=t.ERigidBodyType},function(t){u=t.ecs},function(t){h=t.CCComp},function(t){p=t.GameEvent,d=t.BadgeType},function(t){f=t.EventManager},function(t){g=t.BadgeComp},function(t){m=t.StorageData},function(t){v=t.Util}],execute:function(){var y;i._RF.push({},"88afcUpsolLa4zRn0PUuDdE","BadgeEntity",void 0);var b=o.ccclass;o.property,t("BadgeEntity",b("BadgeEntity")(y=u.register("BadgeEntity",!1)(y=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).rigidbody=void 0,e.collider=void 0,e._badgeType=d.gray,e._uniqueId=void 0,e}e(i,t);var o=i.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this)},o.reset=function(){this.collider.enabled=!0,this.collider.isTrigger=!1,this.node.setRotationFromEuler(r(0,0,0))},o.onEnable=function(){f.instance.on(p.PackageEvent,this.packageEventFun,this)},o.onDisable=function(){f.instance.off(p.PackageEvent,this.packageEventFun,this)},o.packageEventFun=function(t,e){e?(s.stopAllByTarget(this.node),this.ent.destroy(!0)):"bag"!=this.node.parent.name&&"GunFactoryBadges"!=this.node.parent.name&&this.ent.destroy(!0)},o.initBadge=function(t){this.rigidbody=this.getComponent(a),this.collider=this.getComponent(l),this.setType(this.badgeType),this.ent&&(this.ent.add(g).badge=t)},o.setType=function(t){t==d.yellow?(this.node.getChildByName("EnemyTag_1").active=!0,this.node.getChildByName("GrayTag_1").active=!1):(this.node.getChildByName("EnemyTag_1").active=!1,this.node.getChildByName("GrayTag_1").active=!0)},o.appyForceImpulse=function(t,e){var n=this;void 0===t&&(t=100),void 0===e&&(e=1),this.node.setRotationFromEuler(r(0,0,0)),this.rigidbody.type=c.DYNAMIC,this.collider.isTrigger=!1,this.collider.enabled=!0,this.rigidbody.clearState(),this.scheduleOnce((function(){n.rigidbody.applyLocalImpulse(r(-1*e+2*Math.random()*e,5*e+10*Math.random()*e,-1*e+2*Math.random()*e)),n.rigidbody.applyLocalTorque(r(-2*t+2*Math.random()*t,-1*t+1*Math.random()*t,-1*t+1*Math.random()*t))}),1/60),this.uniqueId||(this.uniqueId=v.instance.getUniqueNum())},n(i,[{key:"badgeType",get:function(){return this._badgeType},set:function(t){this._badgeType!=t&&this.setType(t),this._badgeType=t}},{key:"uniqueId",get:function(){return this._uniqueId},set:function(t){t?m.instance.groundBadges[t]={worPos:this.node.worldPosition,type:this.badgeType}:delete m.instance.groundBadges[this.uniqueId],this._uniqueId=t,m.instance.groundBadges=m.instance.groundBadges}}]),i}(h))||y)||y),i._RF.pop()}}})),System.register("chunks:///_virtual/BadgePopComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./PoolManager.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum,r=t.BadgeType},function(t){s=t.default},function(t){a=t.ecs}],execute:function(){var l;n._RF.push({},"0ac0cbI1TtMgpID0ifg1vml","BadgePopComp",void 0);var c=i.ccclass;i.property,t("BadgePopComp",c("BadgePopComp")(l=a.register("BadgePopComp")(l=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).badgePopNode=null,e.attachNode=null,e.badgeType=r.gray,e}return e(n,t),n.prototype.reset=function(){s.instance.putItem(o.BadgePop,this.badgePopNode),this.badgePopNode=null},n}(a.Comp))||l)||l),n._RF.pop()}}})),System.register("chunks:///_virtual/BadgePopEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./PoolManager.ts","./Constant.ts","./BadgeStackEntity.ts","./GlobalSingle.ts","./BadgePopComp.ts","./RoleEntity.ts","./GameUtil.ts","./AdManager.ts","./UMTrack.ts","./UMEvent.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs},function(t){r=t.CCComp},function(t){s=t.default},function(t){a=t.BadgeType,l=t.ResEnum},function(t){c=t.BadgeStackEntity},function(t){u=t.GlobalSingle},function(t){h=t.BadgePopComp},function(t){p=t.RoleEntity},function(t){d=t.GameUtil},function(t){f=t.default},function(t){g=t.UMTrack},function(t){m=t.UMEvent}],execute:function(){var v;n._RF.push({},"287f5f6o+tLEY5kFnGkALmA","BadgePopEntity",void 0);var y=i.ccclass;i.property,t("BadgePopEntity",y("BadgePopEntity")(v=o.register("BadgePopEntity",!1)(v=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).badgeType=a.gray,e}e(n,t);var i=n.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this)},i.reset=function(){},i.onEnable=function(){},i.confirm=function(){var t=this;f.instance.createRewardedVideoAd({onClose:function(e){if(e.isEnded){var n=d.instance.getRandomFromServer();t.badgeType==a.gray&&(g.instance.trackEvent(m.chufa_vi_sliver),d.instance.showToast("恭喜获得"+n+"个银色铭牌"),t.spawnBadgeStack(0,n)),t.badgeType==a.yellow&&(g.instance.trackEvent(m.chufa_vi_gold),d.instance.showToast("恭喜获得"+n+"个金色铭牌"),t.spawnBadgeStack(n,0)),u.instance.player.getComponent(p).ent.remove(h,!0)}}})},i.onDisable=function(){this.ent.destroy(!0)},i.spawnBadgeStack=function(t,e){s.instance.getItemSync(l.BadgeStack).then((function(n){n.getComponent(c).initStack(t,e),n.parent=u.instance.map,n.setWorldPosition(u.instance.player.worldPosition)}))},n}(r))||v)||v),n._RF.pop()}}})),System.register("chunks:///_virtual/BadgePopSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./PoolManager.ts","./BadgePopComp.ts","./BadgePopEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Camera,s=t.Vec3},function(t){a=t.ResEnum},function(t){l=t.GlobalSingle},function(t){c=t.default},function(t){u=t.BadgePopComp},function(t){h=t.BadgePopEntity},function(t){p=t.ecs}],execute:function(){var d;i._RF.push({},"805d7nrPzhLTbybMsLPpBjh","BadgePopSys",void 0);var f=o.ccclass;t("BadgePopSys",f("BadgePopSys")(d=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._pos=new s,e}e(i,t);var o=i.prototype;return o.filter=function(){return p.allOf(u)},o.init=function(){},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value;this.spawnBadgePop(o.get(u))}},o.firstUpdate=function(t){},o.entityRemove=function(t){},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value;o.get(u).badgePopNode&&(l.instance.camera3d.getComponent(r).convertToUINode(o.get(u).attachNode.worldPosition,o.get(u).badgePopNode.parent,this._pos),this._pos.y+=270,o.get(u).badgePopNode.setPosition(this._pos))}},o.spawnBadgePop=function(t){c.instance.getItemSync(a.BadgePop).then((function(e){t.badgePopNode=e,t.badgePopNode.getComponent(h).badgeType=t.badgeType,l.instance.canvas.node.insertChild(e,3)}))},i}(p.ComblockSystem))||d),i._RF.pop()}}})),System.register("chunks:///_virtual/BadgeStackComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"b8890ZpsWROXLY95P5MWK4h","BadgeStackComp",void 0);var s=i.ccclass;i.property,t("BadgeStackComp",s("BadgeStackComp")(r=o.register("BadgeStackComp")(r=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).stackNode=null,e.yellowNum=null,e.grayNum=null,e.completeStack=void 0,e}return e(n,t),n.prototype.reset=function(){this.completeStack=null},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/BadgeStackCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ArrowComp.ts","./BadgeStackEntity.ts","./EventManager.ts","./PoolManager.ts","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ArrowComp},function(t){r=t.BadgeStackEntity},function(t){s=t.EventManager},function(t){a=t.default},function(t){l=t.GameEvent,c=t.ResEnum},function(t){u=t.GlobalSingle},function(t){h=t.StorageData},function(t){p=t.BaseCtrl}],execute:function(){var d;n._RF.push({},"4d650SbU7BD8owqT+ci8C2+","BadgeStackCtrl",void 0);var f=i.ccclass;i.property,t("BadgeStackCtrl",f("BadgeStackCtrl")(d=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).myNode=null,e}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),s.instance.on(l.GuideStep,this.GuideStepFun,this),h.instance.badgeStackUsed||this.showPrefab()},i.onDisable=function(){t.prototype.onDisable.call(this),s.instance.off(l.GuideStep,this.GuideStepFun,this)},i.showPrefab=function(){var t=this;this.isUnlocked=!0;var e=u.instance.tables.EnemyLevel[h.instance.level];console.log("关卡数据",e),(e.Tag1>0||e.Tag2>0)&&a.instance.getItemSync(c.BadgeStack).then((function(n){n.parent=t.node,n.getComponent(r).initStack(e.Tag1,e.Tag2,!0),n.getComponent(r).badgeStackComp.completeStack=function(){h.instance.badgeStackUsed=1},t.myNode=n}))},i.GuideStepFun=function(){this.showGuide()},i.showGuide=function(){1==h.instance.level&&u.instance.guideStep<1&&this.myNode&&(u.instance.guideStep=1,this.myNode.getComponent(r).ent.has(o)||this.myNode.getComponent(r).ent.add(o).init(this.node))},n}(p))||d),n._RF.pop()}}})),System.register("chunks:///_virtual/BadgeStackEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./Constant.ts","./BadgeStackComp.ts","./RoleEntity.ts","./BagComp.ts","./StorageData.ts","./ArrowComp.ts","./GlobalSingle.ts","./PoolManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.BoxCollider},function(t){c=t.ecs},function(t){u=t.CCComp},function(t){h=t.ResEnum},function(t){p=t.BadgeStackComp},function(t){d=t.RoleEntity},function(t){f=t.BagComp},function(t){g=t.StorageData},function(t){m=t.ArrowComp},function(t){v=t.GlobalSingle},function(t){y=t.default}],execute:function(){var b,C,_,E,w,S;r._RF.push({},"abdebj/cpdP8oHHnJ5RyK+T","BadgeStackEntity",void 0);var P=s.ccclass,M=s.property;t("BadgeStackEntity",(b=P("BadgeStackEntity"),C=c.register("BadgeStackEntity",!1),_=M(a),b(E=C((S=e((w=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"stackNode",S,o(e)),e.collider=null,e.badgeStackComp=void 0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){this.badgeStackComp=null,y.instance.putItem(h.BadgeStack,this.node,!0)},r.onEnable=function(){this.collider=this.node.getComponent(l),this.collider.on("onTriggerEnter",this.onTriggerEnterFun,this)},r.onDisable=function(){this.collider.off("onTriggerEnter",this.onTriggerEnterFun,this),this.ent&&this.ent.destroy(!0)},r.initStack=function(t,e,n){void 0===n&&(n=!1),this.badgeStackComp=new p,this.badgeStackComp.stackNode=this.stackNode,this.badgeStackComp.yellowNum=t,this.badgeStackComp.grayNum=e,this.ent.add(this.badgeStackComp),g.instance.level>1&&g.instance.grayNum<=0&&n&&(v.instance.guideStep=1,this.ent.has(m)||this.ent.add(m).init(this.node))},r.onTriggerEnterFun=function(t){var e=t.otherCollider.node.getComponent(d);if(e&&e.isPlayer&&this.badgeStackComp.stackNode.children.length>0){for(var n=this.badgeStackComp.stackNode.children.length-1;n>=0;n--)e.ent.get(f).pushBadge(this.badgeStackComp.stackNode.children[n]);this.badgeStackComp.completeStack&&this.badgeStackComp.completeStack(),this.ent&&this.ent.has(m)&&this.ent.remove(m),this.node.active=!1}},e}(u)).prototype,"stackNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=w))||E)||E)),r._RF.pop()}}})),System.register("chunks:///_virtual/BadgeStackSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./PoolManager.ts","./BadgeStackComp.ts","./BadgeEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.ERigidBodyType,s=t.v3},function(t){a=t.BadgeType,l=t.ResEnum},function(t){c=t.default},function(t){u=t.BadgeStackComp},function(t){h=t.BadgeEntity},function(t){p=t.ecs}],execute:function(){var d;i._RF.push({},"faaf7DosHFMvLvujzbRsojp","BadgeStackSys",void 0);var f=o.ccclass;t("BadgeStackSys",f("BadgeStackSys")(d=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var o=i.prototype;return o.filter=function(){return p.allOf(u)},o.init=function(){},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;){for(var o=e.value.get(u),r=0;r<o.grayNum;r++)this.spawnOne(o,o.stackNode,a.gray);for(var s=0;s<o.yellowNum;s++)this.spawnOne(o,o.stackNode,a.yellow)}},o.firstUpdate=function(t){},o.entityRemove=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},o.update=function(t){},o.spawnOne=function(t,e,n){c.instance.getItemSync(l.Badge).then((function(i){var o=i.getComponent(h);o.badgeType=n,i.parent=e,o.initBadge(i),o.collider.isTrigger=!0,o.rigidbody.type=r.KINEMATIC,i.setPosition(s(0,.1*e.children.length,0)),t.spawnFinish=!0}))},i}(p.ComblockSystem))||d),i._RF.pop()}}})),System.register("chunks:///_virtual/BadgesUi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UMTrack.ts","./Constant.ts","./GameUtil.ts","./UMEvent.ts","./AdManager.ts","./UIManager.ts","./UIView.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.Label,c=t.Node,u=t.Toggle},function(t){h=t.UMTrack},function(t){p=t.BadgeType},function(t){d=t.GameUtil},function(t){f=t.UMEvent},function(t){g=t.default},function(t){m=t.UIManager},function(t){v=t.UIView}],execute:function(){var y,b,C,_,E,w,S,P,M,T,k,N,R;s._RF.push({},"54d63vz1g9MJ4CGh9UQW9tu","BadgesUi",void 0);var B=a.ccclass,F=a.property;t("BadgesUi",(y=B("BadgesUi"),b=F(l),C=F(c),_=F(c),E=F(u),w=F(c),y((M=e((P=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"numLabel",M,o(e)),i(e,"grayIcon",T,o(e)),i(e,"yellowIcon",k,o(e)),i(e,"videoToggle",N,o(e)),i(e,"videoIcon",R,o(e)),e._awardNum=0,e.args=void 0,e}n(e,t);var s=e.prototype;return s.onOpen=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.args=n,this.args[0].badgeType==p.yellow?(this.grayIcon.active=!1,this.yellowIcon.active=!0):(this.grayIcon.active=!0,this.yellowIcon.active=!1),this.videoToggle.isChecked=!0,this.toggleCheckEvent(),this.awardNum=this.args[0].badgeNum,g.instance.showBanner()},s.onClose=function(){g.instance.hideBanner()},s.toggleCheckEvent=function(){this.videoToggle.isChecked?(this.videoIcon.active=!0,this.awardNum=this.args[0].badgeNum):(this.videoIcon.active=!1,this.awardNum=0)},s.toggleBtnFun=function(){this.videoToggle.isChecked=!this.videoToggle.isChecked},s.confirm=function(){var t=this;this.videoToggle.isChecked?g.instance.createRewardedVideoAd({onClose:function(e){e.isEnded&&(t.args[0].badgeType==p.yellow?(h.instance.trackEvent(f.chufa_vi_lack_gold),d.instance.showToast("恭喜获得"+t.awardNum+"个金色铭牌"),d.instance.awardBadgeStack(t.awardNum,0)):(h.instance.trackEvent(f.chufa_vi_lack_silver),d.instance.showToast("恭喜获得"+t.awardNum+"个银色铭牌"),d.instance.awardBadgeStack(0,t.awardNum)),m.instance.close(t))}}):m.instance.close(this)},s.closeUi=function(){m.instance.close(this)},r(e,[{key:"awardNum",get:function(){return this._awardNum},set:function(t){this._awardNum=t,this._awardNum>0&&(this.numLabel.string=";"+this._awardNum)}}]),e}(v)).prototype,"numLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(P.prototype,"grayIcon",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(P.prototype,"yellowIcon",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(P.prototype,"videoToggle",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(P.prototype,"videoIcon",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=P))||S)),s._RF.pop()}}})),System.register("chunks:///_virtual/BagComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GameUtil.ts","./GlobalSingle.ts","./StorageData.ts","./AudioManager.ts","./EventManager.ts","./PoolManager.ts","./BadgeEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator,r=t.ERigidBodyType,s=t.Quat,a=t.v3,l=t.tween},function(t){c=t.GameEvent,u=t.Sounds,h=t.BadgeType,p=t.ResEnum},function(t){d=t.GameUtil},function(t){f=t.GlobalSingle},function(t){g=t.StorageData},function(t){m=t.default},function(t){v=t.EventManager},function(t){y=t.default},function(t){b=t.BadgeEntity},function(t){C=t.ecs}],execute:function(){var _;i._RF.push({},"50017HS8gdAs7/IxTZP7y7M","BagComp",void 0);var E=o.ccclass;o.property,t("BagComp",E("BagComp")(_=C.register("BagComp")(_=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._badgeArry=[],e._bag=null,e.grayNum=void 0,e.yellowNum=void 0,e}e(i,t);var o=i.prototype;return o.reset=function(){v.instance.off(c.LevelEvent,this.LevelEventFun,this)},o.init=function(){v.instance.on(c.LevelEvent,this.LevelEventFun,this),this.restoreBadge(),this.restoreGroundBadge()},o.LevelEventFun=function(){this.restoreBadgeLevelAward(),this.resizePos()},o.pushBadge=function(t,e){var n=this;m.instance.playSoundEffect(u.CollectTag);var i=t.worldPosition;t.parent=this.bag,t.setWorldPosition(i),t.getComponent(b).rigidbody.type=r.KINEMATIC,t.getComponent(b).collider.enabled=!1,t.getComponent(b).uniqueId=null;var o=new s;s.fromEuler(o,0,0,0);var c=a(0,.1*this.bag.children.length,0);l(t).to(.05,{position:c,rotation:o}).call((function(){n.resizePos(),e&&e()})).start()},o.getBadgeByType=function(t,e){if(f.instance.houseMaxLevel>0||"House"==e||"StorageBox"==e||"Desk"==e){m.instance.playSoundEffect(u.UseTag),v.instance.emit(c.GetBadge,{badgeType:t});for(var n=this.bag.children.length-1;n>=0;n--)if(t==this.bag.children[n].getComponent(b).badgeType)return this.bag.children[n]}else console.log("先解锁兵营，才能使用徽章");return null},o.resizePos=function(){this.grayNum=0,this.yellowNum=0;for(var t=0;t<this.bag.children.length;t++)this.bag.children[t].setPosition(a(0,.1*t,0)),this.bag.children[t].getComponent(b).badgeType==h.gray?this.grayNum++:this.yellowNum++;g.instance.grayNum=this.grayNum,g.instance.yellowNum=this.yellowNum,v.instance.emit(c.BagChangeEvent)},o.boomBag=function(t){for(var e=0;e<this._bag.children.length;e++)this._badgeArry.push(this._bag.children[e]);for(var n=0;n<this._badgeArry.length;n++)this._badgeArry[n].parent=f.instance.map,this._badgeArry[n].setWorldPosition(t),this._badgeArry[n].getComponent(b).appyForceImpulse();this._badgeArry=[],this.resizePos()},o.restoreBadge=function(){for(var t=0;t<g.instance.grayNum;t++)this.spawnPutOneBadge(h.gray);for(var e=0;e<g.instance.yellowNum;e++)this.spawnPutOneBadge(h.yellow)},o.spawnPutOneBadge=function(t){var e=this;d.instance.spawnOneBadge(t).then((function(t){e.pushBadge(t)}))},o.restoreBadgeLevelAward=function(){for(var t=0;t<f.instance.levelAwardYellowNum;t++)this.spawnPutOneBadge(h.yellow);f.instance.levelAwardYellowNum=0},o.restoreGroundBadge=function(){for(var t in g.instance.groundBadges)if(Object.prototype.hasOwnProperty.call(g.instance.groundBadges,t)){var e=g.instance.groundBadges[t];e.worPos.z<6?this.spanwOneGroundBadge(t,e.type,e.worPos):delete g.instance.groundBadges[t]}},o.spanwOneGroundBadge=function(t,e,n){y.instance.getItemSync(p.Badge).then((function(i){var o=i.getComponent(b);o.badgeType=e,i.parent=f.instance.map,o.initBadge(i),i.setWorldPosition(n),o.uniqueId=t,o.appyForceImpulse(0,0),i.setRotationFromEuler(a(360*Math.random(),360*Math.random(),360*Math.random()))}))},n(i,[{key:"bag",get:function(){return this._bag},set:function(t){if(this._bag){for(var e=0;e<this._bag.children.length;e++)this._badgeArry.push(this._bag.children[e]);for(var n=0;n<this._badgeArry.length;n++)this._badgeArry[n].parent=t;this._badgeArry=[]}this._bag=t}}]),i}(C.Comp))||_)||_),i._RF.pop()}}})),System.register("chunks:///_virtual/BaseCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UpgradeComp.ts","./UpgradeAreaEntity.ts","./AudioManager.ts","./ThirdFreeLookCamera.ts","./EventManager.ts","./PoolManager.ts","./Constant.ts","./GlobalSingle.ts","./StorageData.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.createClass},function(t){o=t.cclegacy,r=t._decorator,s=t.CCBoolean,a=t.tween,l=t.v3,c=t.Component},function(t){u=t.UpgradeComp},function(t){h=t.UpgradeAreaEntity},function(t){p=t.default},function(t){d=t.ThirdFreeLookCamera},function(t){f=t.EventManager},function(t){g=t.default},function(t){m=t.GameEvent,v=t.ResEnum,y=t.Sounds},function(t){b=t.GlobalSingle},function(t){C=t.StorageData}],execute:function(){var _,E,w,S;o._RF.push({},"03f1foefWFJF6nuG5f5PNig","BaseCtrl",void 0);var P=r.ccclass,M=r.property;t("BaseCtrl",(_=P("BaseCtrl"),E=M({type:s,tooltip:"调试开关",displayName:"开启调试"}),_((e((S=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._debug=!1,e.buildingName=void 0,e.pPath=null,e.buildingData=null,e.isFocuing=!1,e.isUnlocked=!1,e.isShowPrefab=!1,e}n(e,t);var o=e.prototype;return o.debugSwitch=function(){this.node.removeAllChildren(),this.debug&&this.showPrefab()},o.onEnable=function(){f.instance.on(m.PackageEvent,this.packageEventFun,this),f.instance.on(m.LevelEvent,this.LevelEventFun,this),f.instance.on(m.UpgradeTeamLevelUIClose,this.UpgradeTeamLevelUICloseFun,this)},o.onDisable=function(){f.instance.off(m.PackageEvent,this.packageEventFun,this),f.instance.off(m.LevelEvent,this.LevelEventFun,this),f.instance.off(m.UpgradeTeamLevelUIClose,this.UpgradeTeamLevelUICloseFun,this),this.isUnlocked=!1,this.isShowPrefab=!1,C.instance.builds[this.buildingName]=null},o.LevelEventFun=function(){this.setUnlock(),this.cameraFocus()},o.UpgradeTeamLevelUICloseFun=function(){this.setUnlock(),this.cameraFocus()},o.cameraFocus=function(){var t=this;this.buildingData&&this.buildingData.Level==C.instance.level&&this.buildingData.Requirement==C.instance.teamLevel&&!this.isFocuing&&(this.isFocuing=!0,this.scheduleOnce((function(){b.instance.camera3d.getComponent(d).setFollowTarget(t.node)}),1),this.scheduleOnce((function(){b.instance.camera3d.getComponent(d).setFollowTarget(b.instance.player),t.isFocuing=!1}),3))},o.init=function(t){this.buildingName=t,this.buildingData=b.instance.tables.Building[t],this.setUnlock()},o.setUnlock=function(){!this.isUnlocked&&this.buildingData&&C.instance.level>=this.buildingData.Level&&(this.cameraFocus(),this.buildingData.Silver<=0?C.instance.teamLevel>=this.buildingData.Requirement&&this.showPrefab():this.showUpgrade(this.buildingData))},o.showUpgrade=function(t){var e=this;this.isUnlocked=!0,g.instance.getItemSync(v.UpgradeArea).then((function(n){n.parent=e.node;var i=n.getComponent(h),o=C.instance.builds[e.buildingName];null==o&&(o=t.Silver),i.initUpgradeArea(t.Requirement,o,t.Silver,t.ID),i.ent.get(u).complete=function(){i.ent.destroy(!0),p.instance.playSoundEffect(y.Build),e.showPrefab()},i.ent.get(u).progress=function(){C.instance.builds[e.buildingName]=i.ent.get(u).currentBadge,C.instance.builds=C.instance.builds},o<=0?(i.ent.destroy(!0),e.showPrefab()):i.ent.get(u).setNameQuad(i.NameQuad,i.NameQuad2,t.ID)}))},o.showPrefab=function(){var t=this;this.isUnlocked=!0,g.instance.getItemSync(this.pPath).then((function(e){e.parent=t.node}))},o.packageEventFun=function(t,e){e?this.node&&this.node.isValid&&this.node.active&&(this.node.active=!1):a(this.node).to(.3,{scale:l(0,0,0)}).start()},i(e,[{key:"debug",get:function(){return this._debug},set:function(t){this._debug=t,this.debugSwitch()}}]),e}(c)).prototype,"debug",[E],Object.getOwnPropertyDescriptor(S.prototype,"debug"),S.prototype),w=S))||w)),o._RF.pop()}}})),System.register("chunks:///_virtual/BattleBtnCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ArrowComp.ts","./BattleBtnEntity.ts","./EventManager.ts","./PoolManager.ts","./Constant.ts","./StorageData.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ArrowComp},function(t){r=t.BattleBtnEntity},function(t){s=t.EventManager},function(t){a=t.default},function(t){l=t.GameEvent,c=t.ResEnum,u=t.GameState},function(t){h=t.StorageData},function(t){p=t.BaseCtrl}],execute:function(){var d;n._RF.push({},"6132aNScVRI15k928/9eSMn","BattleBtnCtrl",void 0);var f=i.ccclass;i.property,t("BattleBtnCtrl",f("BattleBtnCtrl")(d=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).myNode=null,e}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),s.instance.on(l.StatusEvent,this.statusChangeFun,this),this.showPrefab()},i.update=function(t){},i.onDisable=function(){t.prototype.onDisable.call(this),s.instance.off(l.StatusEvent,this.statusChangeFun,this)},i.showPrefab=function(){var t=this;this.isUnlocked=!0,a.instance.getItemSync(c.BattleBtn).then((function(e){e.parent=t.node,t.myNode=e}))},i.statusChangeFun=function(t,e){1==h.instance.level&&h.instance.status==u.battle&&this.myNode.getComponent(r).ent.has(o)&&this.myNode.getComponent(r).ent.remove(o)},n}(p))||d),n._RF.pop()}}})),System.register("chunks:///_virtual/BattleBtnEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./EventManager.ts","./SoldierComp.ts","./SpawnPosComp.ts","./RoleEntity.ts","./ArrowComp.ts","./PoolManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.BoxCollider},function(t){c=t.ecs},function(t){u=t.CCComp},function(t){h=t.ResEnum,p=t.GameEvent,d=t.GameState},function(t){f=t.GlobalSingle},function(t){g=t.StorageData},function(t){m=t.EventManager},function(t){v=t.SoldierComp},function(t){y=t.SpawnPosComp},function(t){b=t.RoleEntity},function(t){C=t.ArrowComp},function(t){_=t.default}],execute:function(){var E,w,S,P,M,T;r._RF.push({},"f7ae4YHhEpPO6ApH4+1yqvE","BattleBtnEntity",void 0);var k=s.ccclass,N=s.property;t("BattleBtnEntity",(E=k("BattleBtnEntity"),w=c.register("BattleBtnEntity",!1),S=N(a),E(P=w((T=e((M=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"ReadyFX",T,o(e)),e.collider=null,e}n(e,t);var r=e.prototype;return r.reset=function(){_.instance.putItem(h.BattleBtn,this.node)},r.onEnable=function(){this.collider=this.getComponent(l),this.collider.on("onTriggerEnter",this.onTriggerEnter,this),this.collider.on("onTriggerExit",this.onTriggerExit,this),m.instance.on(p.RoleNumChangeEvent,this.soldierChangeEventFun,this),m.instance.on(p.StatusEvent,this.StatusEventFun,this),this.soldierChangeEventFun()},r.onDisable=function(){this.collider.off("onTriggerEnter",this.onTriggerEnter,this),this.collider.off("onTriggerExit",this.onTriggerExit,this),m.instance.off(p.RoleNumChangeEvent,this.soldierChangeEventFun,this),m.instance.off(p.StatusEvent,this.StatusEventFun,this),this.ent&&this.ent.destroy(!0)},r.StatusEventFun=function(){g.instance.status!=d.ready&&(this.ReadyFX.active=!1)},r.soldierChangeEventFun=function(){var t=c.query(c.allOf(y));g.instance.status==d.ready&&t.length>0&&t.length==f.instance.soldierEntities.length-1?(this.ReadyFX.active=!0,1==g.instance.level&&f.instance.guideStep<4&&(f.instance.guideStep=4,this.ent.has(C)||this.ent.add(C).init(this.node))):this.ReadyFX.active=!1},r.onTriggerEnter=function(t){var e=t.otherCollider.node.getComponent(b);e&&e.isPlayer&&c.query(c.allOf(v)).length>1&&m.instance.emit(p.TouchStartBtnEvent,!0)},r.onTriggerExit=function(t){var e=t.otherCollider.node.getComponent(b);e&&e.isPlayer&&m.instance.emit(p.TouchStartBtnEvent,!1)},r.update=function(t){},e}(u)).prototype,"ReadyFX",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=M))||P)||P)),r._RF.pop()}}})),System.register("chunks:///_virtual/Boot.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./ECS.ts","./RootSys.ts","./UIManager.ts","./UMEvent.ts","./UMTrack.ts","./JJMgr.ts","./WxPlatform.ts","./GameUtil.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.AnimationClip,c=t.find,u=t.Canvas,h=t.Camera,p=t.Prefab,d=t.instantiate,f=t.JsonAsset,g=t.Component},function(t){m=t.ResEnum,v=t.UICF},function(t){y=t.GlobalSingle},function(t){b=t.ecs},function(t){C=t.RootSys},function(t){_=t.UIManager},function(t){E=t.UMEvent},function(t){w=t.UMTrack},function(t){S=t.default},function(t){P=t.default},function(t){M=t.GameUtil}],execute:function(){var T,k,N,R,B,F,L,A,D;r._RF.push({},"d3b8a80b/FJho9STMdmDFMx","Boot",void 0);var x=s.ccclass,I=s.property;t("Boot",(T=x("Boot"),k=I(a),N=I(a),R=I([l]),T((L=e((F=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"game3d",L,o(e)),i(e,"camera3d",A,o(e)),i(e,"animClips",D,o(e)),e.rootSys=void 0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){y.instance.canvas=c("Canvas").getComponent(u),y.instance.camera2d=c("Canvas/Camera2d").getComponent(h),y.instance.camera3d=this.camera3d,y.instance.game3d=this.game3d,y.instance.clips=this.animClips,w.instance.trackEvent(E.Loading_in)},r.initECS=function(){window.ecs=b,this.rootSys=new C,this.rootSys.init()},r.start=function(){},r.update=function(t){this.rootSys.execute(t),y.instance.navMeshCrowd&&y.instance.navMeshCrowd.update(t)},r.loadAll=function(t,e){var n=this,i=(new Date).getTime();this.initECS(),Promise.all([this.loadTable(),this.initJJ()]).then((function(o){console.log(o),M.instance.getBundle("res").then((function(o){o.load(m.MapNode,p,(function(e,n,i){t(e,n,i)}),(function(t,o){if(t)console.warn(t);else{var r=d(o);n.node.addChild(r);var s="初始化地图池耗时:"+((new Date).getTime()-i)/1e3+"s";console.log(s),e(t,o)}}))})),w.instance.trackEvent(E.Game_in),_.instance.initUIConf(v)})).catch((function(t){console.log(t)}))},r.loadTable=function(){return new Promise((function(t,e){var n=(new Date).getTime();M.instance.getBundle("res").then((function(e){e.loadDir(m.tables,f,(function(e,i){for(var o=0;o<i.length;o++){var r=i[o];"模板"!=r.name&&(y.instance.tables[r.name]=r.json)}console.log("配表数据：",y.instance.tables),t("加载表格数据耗时:"+((new Date).getTime()-n)/1e3+"s")}))}))}))},r.initJJ=function(){return new Promise((function(t,e){var n=(new Date).getTime();S.instance.initJJ((function(){S.instance.dataConfig.front_loading_ad_switch&&P.instance.showInterAd(),t("initJJ耗时："+((new Date).getTime()-n)/1e3+"s")}))}))},e}(g)).prototype,"game3d",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(F.prototype,"camera3d",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(F.prototype,"animClips",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=F))||B)),r._RF.pop()}}})),System.register("chunks:///_virtual/BtnFreeItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.ProgressBar,l=t.Component}],execute:function(){var c,u,h,p,d;r._RF.push({},"62c60dGtdhEEaPYybFTyEIx","BtnFreeItem",void 0);var f=s.ccclass,g=s.property;t("BtnFreeItem",(c=f("BtnFreeItem"),u=g(a),c((d=e((p=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"progressBar",d,o(e)),e.nowTime=0,e.cdTime=30,e}n(e,t);var r=e.prototype;return r.onEnable=function(){this.nowTime=this.cdTime,this.progressBar.progress=1},r.update=function(t){this.nowTime-=1/60,this.progressBar.progress=this.nowTime/this.cdTime,this.progressBar.progress<=0&&(this.node.active=!1)},r.onDisable=function(){},e}(l)).prototype,"progressBar",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=p))||h)),r._RF.pop()}}})),System.register("chunks:///_virtual/BtnStatusComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AppConfig.ts","./BottomGridAdMgr.ts","./JJMgr.ts","./UMTrack.ts","./VehicleSys.ts","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./UMEvent.ts","./Util.ts","./AdManager.ts","./AudioManager.ts","./EventManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.Label,c=t.Component},function(t){u=t.default,h=t.AppIDs},function(t){p=t.default},function(t){d=t.default},function(t){f=t.UMTrack},function(t){g=t.VehicleType},function(t){m=t.GameEvent,v=t.Sounds},function(t){y=t.GlobalSingle},function(t){b=t.StorageData},function(t){C=t.UMEvent},function(t){_=t.Util},function(t){E=t.default},function(t){w=t.default},function(t){S=t.EventManager}],execute:function(){var P,M,T,k,N,R,B,F,L,A,D,x,I,U,z,G,H,O,V,j,W,Q,J;r._RF.push({},"d1318eMuQ5O161bH6T5FAQt","BtnStatusComp",void 0);var X=s.ccclass,q=s.property;t("BtnStatusComp",(P=X("BtnStatusComp"),M=q(a),T=q(a),k=q(a),N=q(a),R=q(l),B=q(a),F=q(l),L=q(a),A=q(a),D=q(a),P((U=e((I=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"btnAirDropFree",U,o(e)),i(e,"btnPlaneFree",z,o(e)),i(e,"btnNbmobFree",G,o(e)),i(e,"btnMoto",H,o(e)),i(e,"motoVideoCountLabel",O,o(e)),i(e,"motoTips",V,o(e)),i(e,"airDropTimeLabel",j,o(e)),i(e,"AirDropFreeWarn",W,o(e)),i(e,"BtnMoto2",Q,o(e)),i(e,"BtnNbmob2",J,o(e)),e.btnArry=[],e.airDorpTime=void 0,e.isShowAd=!1,e.isBanner=!1,e}n(e,t);var r=e.prototype;return r.onEnable=function(){S.instance.on(m.LevelEvent,this.LevelEventFun,this),S.instance.on(m.NbombUnlock,this.NbombUnlockFun,this),S.instance.on(m.AircraftUnlock,this.AircraftUnlockFun,this),S.instance.on(m.ShowPlaneAndNbomb,this.showPlaneAndNbombFun,this),this.showAirDrop(),this.showPlaneAndNbombFun(),this.schedule(this.loopTime,30),this.airDorpTime=180,this.schedule(this.airDorpTimeFun,1),this.showMoto()},r.start=function(){this.loopAd()},r.onDisable=function(){S.instance.off(m.LevelEvent,this.LevelEventFun,this),S.instance.off(m.NbombUnlock,this.NbombUnlockFun,this),S.instance.off(m.AircraftUnlock,this.AircraftUnlockFun,this),S.instance.off(m.ShowPlaneAndNbomb,this.showPlaneAndNbombFun,this),this.unschedule(this.loopTime)},r.loopTime=function(){this.motoTips.active=!this.motoTips.active,this.loopAd()},r.loopAd=function(){this.isShowAd=!this.isShowAd;var t=[],e=y.instance.tables.Building.NBomb;b.instance.level>=e.Level&&b.instance.teamLevel>=e.Requirement&&t.push(this.BtnNbmob2),b.instance.level>1&&d.instance.dataConfig.front_show_qimotuo_switch&&t.push(this.BtnMoto2);for(var n=Math.floor(Math.random()*t.length),i=0;i<t.length;i++)this.isShowAd&&i==n?t[i].active=!0:t[i].active=!1;(t.length<=0||!this.isShowAd)&&u.wechat.appid==h.drbtk&&d.instance.dataConfig.front_bot_dlgez_switch?p.instance.showGrid():p.instance.hideGrid()},r.airDorpTimeFun=function(){this.airDorpTime--,this.airDorpTime<=0?(this.airDorpTime=0,this.AirDropFreeWarn.active=!0,this.airDropTimeLabel.node.active=!1):(this.AirDropFreeWarn.active=!1,this.airDropTimeLabel.node.active=!0),this.airDropTimeLabel.string=_.instance.formatSecondsMS(this.airDorpTime).replace(":","@")},r.LevelEventFun=function(){this.showPlaneAndNbombFun(),this.showAirDrop(),1==y.instance.tables.EnemyLevel[b.instance.level].Level2&&S.instance.emit(m.AircraftUnlock,!1),this.showMoto()},r.AircraftUnlockFun=function(t,e){e&&(this.btnPlaneFree.active=!1)},r.NbombUnlockFun=function(t,e){e&&(this.btnNbmobFree.active=!1)},r.lockMoto=function(){y.instance.vehicleType=null},r.showPlaneAndNbombFun=function(){var t=y.instance.tables.Building.Aircraft;b.instance.level>=t.Level&&b.instance.teamLevel>=t.Requirement&&(this.btnPlaneFree.active=!0);var e=y.instance.tables.Building.NBomb;b.instance.level>=e.Level&&b.instance.teamLevel>=e.Requirement&&(this.btnNbmobFree.active=!0)},r.showAirDrop=function(){this.btnAirDropFree.active=!0},r.showMoto=function(){b.instance.level>1&&b.instance.motoVideoCount<4?(this.btnMoto.active=!0,this.motoVideoCountLabel.string=(4-b.instance.motoVideoCount).toString()):this.btnMoto.active=!1},r.btnAirDrop=function(){var t=this;this.airDorpTime<=0?(this.airDorpTime=180,S.instance.emit(m.ShowAirDrop)):(w.instance.playSoundEffect(v.Button),E.instance.createRewardedVideoAd({onClose:function(e){e.isEnded&&(t.airDorpTime=180,S.instance.emit(m.ShowAirDrop))}}))},r.btnUseAircraft=function(){var t=this;w.instance.playSoundEffect(v.Button),E.instance.createRewardedVideoAd({onClose:function(e){e.isEnded&&(S.instance.emit(m.UseAircraft),t.btnPlaneFree.active=!1)}})},r.btnUseNbomb=function(){var t=this;w.instance.playSoundEffect(v.Button),E.instance.createRewardedVideoAd({onClose:function(e){e.isEnded&&(S.instance.emit(m.UseNbomb),t.btnNbmobFree.active=!1,t.isBanner&&(f.instance.trackEvent(C.chufa_vi_bot_banner),t.isBanner=!1))}})},r.btnMotoFun=function(){var t=this;w.instance.playSoundEffect(v.Button),E.instance.createRewardedVideoAd({onClose:function(e){e.isEnded&&(y.instance.vehicleType=g.moto,b.instance.motoVideoCount++,b.instance.motoVideoCount<4&&(t.motoVideoCountLabel.string=(4-b.instance.motoVideoCount).toString(),t.unschedule(t.lockMoto),t.scheduleOnce(t.lockMoto,60)))}})},r.btnNbomb2Fun=function(){f.instance.trackEvent(C.chufa_bot_banner),this.isBanner=!0,this.btnUseNbomb()},r.btnMoto2Fun=function(){var t=this;w.instance.playSoundEffect(v.Button),f.instance.trackEvent(C.chufa_bot_banner),E.instance.createRewardedVideoAd({onClose:function(e){e.isEnded&&(f.instance.trackEvent(C.chufa_vi_bot_banner),y.instance.vehicleType=g.moto,t.unschedule(t.lockMoto),t.scheduleOnce(t.lockMoto,60))}})},r.btnMoreGameFun=function(){},e}(c)).prototype,"btnAirDropFree",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(I.prototype,"btnPlaneFree",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(I.prototype,"btnNbmobFree",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(I.prototype,"btnMoto",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(I.prototype,"motoVideoCountLabel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(I.prototype,"motoTips",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(I.prototype,"airDropTimeLabel",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(I.prototype,"AirDropFreeWarn",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(I.prototype,"BtnMoto2",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(I.prototype,"BtnNbmob2",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=I))||x)),r._RF.pop()}}})),System.register("chunks:///_virtual/BuffUi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./JoystickMoveComp.ts","./RoleAnimComp.ts","./RoleEntity.ts","./GlobalSingle.ts","./AdManager.ts","./UIManager.ts","./UIView.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Toggle,l=t.Label,c=t.Node},function(t){u=t.JoystickMoveComp},function(t){h=t.RoleAnimComp},function(t){p=t.RoleEntity},function(t){d=t.GlobalSingle},function(t){f=t.default},function(t){g=t.UIManager},function(t){m=t.UIView}],execute:function(){var v,y,b,C,_,E,w,S,P;r._RF.push({},"81f75JG1oZJbaqdnc6jSMO/","BuffUi",void 0);var M=s.ccclass,T=s.property;t("BuffUi",(v=M("BuffUi"),y=T(a),b=T(l),C=T(c),v((w=e((E=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"videoToggle",w,o(e)),i(e,"numLabel",S,o(e)),i(e,"videoIcon",P,o(e)),e.args=void 0,e}n(e,t);var r=e.prototype;return r.onOpen=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.args=n,d.instance.player.getComponent(p).ent.get(u).moveTarget=null,d.instance.player.getComponent(p).ent.get(h).idle(),this.videoToggle.isChecked=!0,this.toggleCheckFun(),f.instance.showBanner()},r.onClose=function(){f.instance.hideBanner(),this.args&&this.args[0].closeUi(this.videoToggle.isChecked),d.instance.player.getComponent(p).ent.get(u).moveTarget=d.instance.player},r.confirmBtn=function(){var t=this;this.videoToggle.isChecked?f.instance.createRewardedVideoAd({onClose:function(e){e.isEnded&&g.instance.close(t)}}):g.instance.close(this)},r.toggleFun=function(){this.videoToggle.isChecked=!this.videoToggle.isChecked},r.toggleCheckFun=function(){this.videoToggle.isChecked?(this.numLabel.string="+20",this.videoIcon.active=!0):(this.numLabel.string="+10",this.videoIcon.active=!1)},e}(m)).prototype,"videoToggle",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=e(E.prototype,"numLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(E.prototype,"videoIcon",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=E))||_)),r._RF.pop()}}})),System.register("chunks:///_virtual/BulletEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./Constant.ts","./GlobalSingle.ts","./EnemyComp.ts","./FlyComp.ts","./Util.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.RigidBody,r=t.BoxCollider},function(t){s=t.ecs},function(t){a=t.CCComp},function(t){l=t.RigidBodyGroup,c=t.ResEnum},function(t){u=t.GlobalSingle},function(t){h=t.EnemyComp},function(t){p=t.FlyComp},function(t){d=t.Util}],execute:function(){var f;n._RF.push({},"3628cYdwcJB95mmQnNJfQfL","BulletEntity",void 0);var g=i.ccclass;i.property,t("BulletEntity",g("BulletEntity")(f=s.register("BulletEntity",!1)(f=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).rigidbody=void 0,e.collider=void 0,e.Atk=1,e}e(n,t);var i=n.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this)},i.reset=function(){},i.setData=function(t,e,n,i,s){this.rigidbody=this.getComponent(o),this.collider=this.getComponent(r),this.node.parent=u.instance.map,this.Atk=n.Atk,e.has(h)?(this.rigidbody.setGroup(1<<l.BulletEnemy),this.rigidbody.setMask(1<<l.Soldier|1<<l.Building|1<<l.Player)):(this.rigidbody.setGroup(1<<l.BulletSoldier),this.rigidbody.setMask(1<<l.Enemy|1<<l.Building));var a=new p;a.flyNode=this.node,a.resPath=t,a.startWorldPos=i,a.destWorldPos=s,a.Speed=n.Speed,this.ent.add(a)},i.onEnable=function(){this.collider.on("onTriggerEnter",this.onTriggerEnter,this)},i.onDisable=function(){this.collider.off("onTriggerEnter",this.onTriggerEnter,this)},i.onTriggerEnter=function(t){d.instance.playFX(c.HitFX,u.instance.map,this.node.worldPosition,.1),this.ent.destroy(!0)},n}(a))||f)||f),n._RF.pop()}}})),System.register("chunks:///_virtual/BulletHowitzerComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./ECS.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.default},function(t){r=t.ecs}],execute:function(){var s;n._RF.push({},"3a423DxoXlBR5T4iy3QH3C3","BulletHowitzerComp",void 0);var a=i.ccclass;i.property,t("BulletHowitzerComp",a("BulletHowitzerComp")(s=r.register("BulletHowitzerComp")(s=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).path=void 0,e.flyTarget=null,e.startWorldPos=null,e.desWorldPos=null,e._flyTime=3,e._nowTime=0,e._Vxyz=void 0,e}return e(n,t),n.prototype.reset=function(){this._nowTime=0,o.instance.putItem(this.path,this.flyTarget)},n}(r.Comp))||s)||s),n._RF.pop()}}})),System.register("chunks:///_virtual/BulletHowitzerEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./PoolManager.ts","./GlobalSingle.ts","./RoleEntity.ts","./BulletHowitzerComp.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.BoxCollider,s=t.Quat,a=t.Vec3},function(t){l=t.ecs},function(t){c=t.CCComp},function(t){u=t.default},function(t){h=t.GlobalSingle},function(t){p=t.RoleEntity},function(t){d=t.BulletHowitzerComp}],execute:function(){var f;i._RF.push({},"a61aaE90MtM5KgGFOvyiTwm","BulletHowitzerEntity",void 0);var g=o.ccclass;o.property,t("BulletHowitzerEntity",g("BulletHowitzerEntity")(f=l.register("BulletHowitzerEntity",!1)(f=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).ptah=void 0,e.collider=void 0,e.Atk=void 0,e.Range=void 0,e}e(i,t);var o=i.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this)},o.reset=function(){u.instance.putItem(this.ptah,this.node)},o.onEnable=function(){this.collider=this.getComponent(r),this.collider.on("onCollisionEnter",this.onCollisionEnter,this)},o.onDisable=function(){this.collider.off("onCollisionEnter",this.onCollisionEnter,this)},o.setData=function(t,e,n,i,o){this.Range=i,this.Atk=o;var r=this.ent.add(d);r.flyTarget=this.node,r.startWorldPos=e,r.desWorldPos=n,r.path=t,this.node.setWorldPosition(r.startWorldPos);var l=r.desWorldPos.clone();l.y=0;var c=r.desWorldPos.clone();c.y=0;var u=c.subtract(l),h=new s;s.fromViewUp(h,u,a.UP),this.node.setWorldRotation(h)},o.onCollisionEnter=function(t){if(h.instance.enemyEntities.length>0)for(var e,i=n(h.instance.enemyEntities);!(e=i()).done;){var o=e.value;a.distance(this.node.getWorldPosition(),o.get(p).node.getWorldPosition())<this.Range&&o.get(p).beHit(this.Atk)}this.ent.destroy(!0)},i}(c))||f)||f),i._RF.pop()}}})),System.register("chunks:///_virtual/BulletPlaneEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./PoolManager.ts","./GlobalSingle.ts","./RoleEntity.ts","./Util.ts","./Constant.ts","./AudioManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.v3,s=t.RigidBody,a=t.BoxCollider,l=t.Vec3},function(t){c=t.ecs},function(t){u=t.CCComp},function(t){h=t.default},function(t){p=t.GlobalSingle},function(t){d=t.RoleEntity},function(t){f=t.Util},function(t){g=t.ResEnum,m=t.Sounds},function(t){v=t.default}],execute:function(){var y;i._RF.push({},"aebe4RIfIdIo50p1cT5U+fO","BulletPlaneEntity",void 0);var b=o.ccclass;o.property,t("BulletPlaneEntity",b("BulletPlaneEntity")(y=c.register("BulletPlaneEntity",!1)(y=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).ptah=void 0,e.collider=void 0,e.Atk=void 0,e.Range=void 0,e}e(i,t);var o=i.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this)},o.reset=function(){this.node.setRotationFromEuler(r(0,0,0)),this.node.getComponent(s).useGravity=!0,this.node.getComponent(a).enabled=!0,h.instance.putItem(this.ptah,this.node)},o.onEnable=function(){this.collider=this.getComponent(a),this.collider.on("onCollisionEnter",this.onCollisionEnter,this)},o.onDisable=function(){this.collider.off("onCollisionEnter",this.onCollisionEnter,this)},o.setData=function(t,e){this.Range=t,this.Atk=e},o.onCollisionEnter=function(t){if(p.instance.enemyEntities.length>0)for(var e,i=n(p.instance.enemyEntities);!(e=i()).done;){var o=e.value;o.get(d)&&l.distance(this.node.getWorldPosition(),o.get(d).node.getWorldPosition())<this.Range&&o.get(d).beHit(this.Atk)}f.instance.playFX(g.DropBomeFX,p.instance.map,this.node.worldPosition,.2),v.instance.playSoundEffect(m.Bomb),this.ent.destroy(!0)},i}(u))||y)||y),i._RF.pop()}}})),System.register("chunks:///_virtual/CameraUtil.ts",["cc"],(function(t){var e,n,i;return{setters:[function(t){e=t.cclegacy,n=t.Vec3,i=t.view}],execute:function(){e._RF.push({},"0f461DgfhdKBopARiqWhq84","CameraUtil",void 0),t("CameraUtil",function(){function t(){}return t.isInView=function(t,e){var o=t.node.getWorldPosition(),r=t.worldToScreen(e),s=n.normalize(new n,e.subtract(o)),a=t.node.forward,l=n.dot(a,s),c=i.getViewportRect();return l>0&&r.x<=c.width&&r.x>=0&&r.y<=c.height&&r.y>=0},t}()),e._RF.pop()}}})),System.register("chunks:///_virtual/CarComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"7704eVraVBLzoJ7wspkaSxg","CarComp",void 0);var s=i.ccclass;i.property,t("CarComp",s("CarComp")(r=o.register("CarComp")(r=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.reset=function(){},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/CarCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./StorageData.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.StorageData},function(t){s=t.BaseCtrl}],execute:function(){var a;n._RF.push({},"aaa3ckzSrlK5L4uUQ3voml4","CarCtrl",void 0);var l=i.ccclass;i.property,t("CarCtrl",l("CarCtrl")(a=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.Car,this.init("Car")},i.onDisable=function(){t.prototype.onDisable.call(this)},i.setUnlock=function(){!this.isUnlocked&&this.buildingData&&(r.instance.level>=this.buildingData.Level||r.instance.motoVideoCount>=4)&&(this.cameraFocus(),this.buildingData.Silver<=0?r.instance.teamLevel>=this.buildingData.Requirement&&this.showPrefab():this.showUpgrade(this.buildingData))},n}(s))||a),n._RF.pop()}}})),System.register("chunks:///_virtual/CarEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./Constant.ts","./PoolManager.ts","./UpgradeAreaEntity.ts","./UpgradeComp.ts","./EventManager.ts","./GlobalSingle.ts","./VehicleSys.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node},function(t){l=t.ecs},function(t){c=t.CCComp},function(t){u=t.ResEnum,h=t.GameEvent},function(t){p=t.default},function(t){d=t.UpgradeAreaEntity},function(t){f=t.UpgradeComp},function(t){g=t.EventManager},function(t){m=t.GlobalSingle},function(t){v=t.VehicleType}],execute:function(){var y,b,C,_,E,w;r._RF.push({},"aea60BWeDpCLIxTjYvp9Uaz","CarEntity",void 0);var S=s.ccclass,P=s.property;t("CarEntity",(y=S("CarEntity"),b=l.register("CarEntity",!1),C=P(a),y(_=b((w=e((E=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"moto",w,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){p.instance.putItem(u.Car,this.node,!0)},r.onEnable=function(){g.instance.on(h.VehicleDestroy,this.VehicleDestroyFun,this),this.moto.active=!0,m.instance.vehicleType=v.moto},r.onDisable=function(){g.instance.off(h.VehicleDestroy,this.VehicleDestroyFun,this),this.ent&&this.ent.destroy(!0)},r.VehicleDestroyFun=function(){this.reLiveCar()},r.reLiveCar=function(){var t=this;p.instance.getItemSync(u.UpgradeArea).then((function(e){e.parent=t.node,t.moto.active=!1;var n=e.getComponent(d);n.initUpgradeArea(0,5,5),n.ent.get(f).complete=function(){n.ent.destroy(!0),t.moto.active=!0,m.instance.vehicleType=v.moto}}))},e}(c)).prototype,"moto",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=E))||_)||_)),r._RF.pop()}}})),System.register("chunks:///_virtual/CCComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator,r=t.Component},function(t){s=t.ecs}],execute:function(){var a,l;i._RF.push({},"70150DXt9ZByZntKSj1Ov5i","CCComp",void 0);var c=o.ccclass;o.property,t("CCComp",c("CCComp")(((l=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).canRecycle=void 0,e._ent=void 0,e}e(i,t);var o=i.prototype;return o.onLoad=function(){},o.unuse=function(){this.node.active=!0},o.reuse=function(){this.node.active=!0},n(i,[{key:"ent",get:function(){return this._ent||(this.ent=s.createEntity(),this.ent.add(this)),this._ent},set:function(t){this._ent=t}}]),i}(r)).tid=-1,l.compName=void 0,a=l))||a),i._RF.pop()}}})),System.register("chunks:///_virtual/Constant.ts",["cc"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy,n=t.Enum}],execute:function(){var i,o,r,s,a,l,c;t({GameEvent:void 0,ResEnum:void 0,RoleClips:void 0,RoleName:void 0,Sounds:void 0,UIID:void 0}),e._RF.push({},"9a14eAwynVAd7MQDIlBrugl","Constant",void 0),function(t){t[t.Game3dUi=0]="Game3dUi",t[t.FinishUi=1]="FinishUi",t[t.BuffUi=2]="BuffUi",t[t.UpgradeLevelUi=3]="UpgradeLevelUi",t[t.HpWarnUi=4]="HpWarnUi",t[t.AirDropUi=5]="AirDropUi",t[t.AwardUi=6]="AwardUi",t[t.NbombUi=7]="NbombUi",t[t.BadgesUi=8]="BadgesUi"}(o||(o=t("UIID",{}))),t("UICF",((i={})[o.Game3dUi]={prefab:"prefab/ui/Game3dUi",zIndex:11},i[o.FinishUi]={prefab:"prefab/ui/FinishUi",zIndex:12},i[o.BuffUi]={prefab:"prefab/ui/BuffUi",zIndex:14},i[o.UpgradeLevelUi]={prefab:"prefab/ui/UpgradeLevelUi",zIndex:16},i[o.HpWarnUi]={prefab:"prefab/ui/HpWarnUi",zIndex:18},i[o.AirDropUi]={prefab:"prefab/ui/AirDropUi",zIndex:20},i[o.AwardUi]={prefab:"prefab/ui/AwardUi",zIndex:20},i[o.BadgesUi]={prefab:"prefab/ui/BadgesUi",zIndex:20},i[o.NbombUi]={prefab:"prefab/ui/NbombUi",zIndex:20},i)),function(t){t.gunPath="prefab/gun",t.bulletPath="prefab/bullet",t.team="texture/team",t.roleTexture="texture/role",t.tables="tables",t.MapNode="prefab/game/MapNode",t.Role="prefab/game/Role",t.Badge="prefab/game/Badge",t.TeamLevel="prefab/game/TeamLevel",t.Bullet1="prefab/bullet/Bullet1",t.PlaneBomb="prefab/bullet/PlaneBomb",t.Game3d="prefab/game/Game3d",t.level="prefab/level/",t.HpProgressBar="prefab/game/HpProgressBar",t.HitFX="prefab/Fx/HitFX",t.LvlUpFX="prefab/Fx/LvlUpFX",t.FireFX="prefab/Fx/FireFX",t.ExplosionFX="prefab/Fx/ExplosionFX",t.ConfettiFX="prefab/Fx/ConfettiFX",t.PacketSmokeFX="prefab/Fx/PacketSmokeFX",t.RebornFX="prefab/Fx/RebornFX",t.BoomFX="prefab/Fx/BoomFX",t.DropBomeFX="prefab/Fx/DropBomeFX",t.GunFX="prefab/Fx/GunFX",t.Aircraft="prefab/gameCtrl/Aircraft",t.AirDrop="prefab/gameCtrl/AirDrop",t.BadgeStack="prefab/gameCtrl/BadgeStack",t.BattleBtn="prefab/gameCtrl/BattleBtn",t.Car="prefab/gameCtrl/Car",t.Desk="prefab/gameCtrl/Desk",t.GunFactory="prefab/gameCtrl/GunFactory",t.House="prefab/gameCtrl/House",t.Howitzer="prefab/gameCtrl/Howitzer",t.Medic="prefab/gameCtrl/Medic",t.NBomb="prefab/gameCtrl/NBomb",t.Post="prefab/gameCtrl/Post",t.ReadyArea="prefab/gameCtrl/ReadyArea",t.StorageBox="prefab/gameCtrl/StorageBox",t.WoodenBarrier="prefab/gameCtrl/WoodenBarrier",t.Tower="prefab/gamePart/Tower",t.ReadyPos="prefab/game/ReadyPos",t.Plane="prefab/game/Plane",t.UpgradeArea="prefab/game/UpgradeArea",t.Truck="prefab/game/Truck",t.Arrow="prefab/game/Arrow",t.Arrow3d="prefab/game/Arrow3d",t.Moto="prefab/game/Moto",t.BadgePop="prefab/game/BadgePop",t.FullGunPop="prefab/game/FullGunPop",t.Toast="prefab/game/Toast"}(r||(r=t("ResEnum",{}))),t("GameState",n({ready:1,battle:2,win:3})),t("RigidBodyGroup",n({Building:1,Soldier:2,Enemy:3,BulletEnemy:4,BulletSoldier:5,Badge:6,Player:7})),t("ReadyPosType",n({solider:0,tanker:1})),t("HouseType",n({soldier:0,tanker:1})),function(t){t.commander_1="commander_1",t.commander_2="commander_2",t.commander_3="commander_3",t.commander_4="commander_4",t.commander_5="commander_5",t.Armored_Soldier="Armored_Soldier",t.MedicSoldier="MedicSoldier",t.MuscularSoldier4="MuscularSoldier4",t.PrivateSoldier="PrivateSoldier",t.Tanker="Tanker"}(s||(s=t("RoleName",{}))),t("RoleModel",n({commander_1:0,commander_2:1,commander_3:2,commander_4:3,commander_5:4,Armored_Soldier:5,MedicSoldier:6,MuscularSoldier4:7,PrivateSoldier:8,Tanker:9})),function(t){t.idle="idle",t.run="run",t.attack2="attack2",t.carry="carry",t.attack1="attack1",t.die="die",t.sit="sit",t.motorcycle="motorcycle"}(a||(a=t("RoleClips",{}))),function(t){t.StatusEvent="StatusEvent",t.LevelEvent="LevelEvent",t.TeamLevelEvent="TeamLevelEvent",t.HouseLevelEvent="HouseLevelEvent",t.TouchStartBtnEvent="TouchStartBtnEvent",t.PackageEvent="PackageEvent",t.RoleNumChangeEvent="SoldierChangeEvent",t.BagChangeEvent="BagChangeEvent",t.ShowAirDrop="showAirDrop",t.UpgradeTeamLevelUIClose="UpgradeTeamLevelUIClose",t.PlaneDropBombEvent="PlaneDropBombEvent",t.NbombUnlock="NbombUnlock",t.AircraftUnlock="AircraftUnlock",t.UseNbomb="UseNbomb",t.UseAircraft="UseAircraft",t.GrayNumEvent="GrayNumEvent",t.YellowNumEvent="YellowNumEvent",t.GuideStep="GuideStep",t.NbombBmob="NbombBmob",t.YellowNumTeamEvent="YellowNumTeamEvent",t.RestoreSoldiers="RestoreSoldiers",t.ShowPlaneAndNbomb="ShowPlaneAndNbomb",t.HouseMaxLevel="HouseMaxLevel",t.VehicleDestroy="VehicleDie",t.GetBadge="GetBadge",t.FireNbomb="FireNbomb",t.NBombFinish="NBombFinish",t.UpgradeComp_BadgeLack="UpgradeComp_BadgeLack",t.AirDropEnable="AirDropEnable",t.FullGun="FullGun"}(l||(l=t("GameEvent",{}))),t("BadgeType",n({gray:0,yellow:1})),function(t){t.BGM="BGM",t.Button="Button",t.GunAttack="GunAttack",t.CollectTag="CollectTag",t.UseTag="UseTag",t.Build="Build",t.RankUp="RankUp",t.DropBoxFalling="DropBoxFalling",t.DropBoxDown="DropBoxDown",t.DropBoxOpen="DropBoxOpen",t.Enlist="Enlist",t.FactoryIdle="FactoryIdle",t.Charge="Charge",t.Dead="Dead",t.TankAttack="TankAttack",t.MotorIdle="MotorIdle",t.NuBombLaunch="NuBombLaunch",t.PlaneFlight="PlaneFlight",t.HowitzerLaunch="HowitzerLaunch",t.NuBomb="NuBomb",t.Bomb="Bomb",t.Flag="Flag",t.TruckCarry="TruckCarry",t.Win="Win"}(c||(c=t("Sounds",{}))),e._RF.pop()}}})),System.register("chunks:///_virtual/continuous-line-controller.ts",["./rollupPluginModLoBabelHelpers.js","cc","./controller.ts","./utils.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy},function(t){i=t.default},function(t){o=t.createLineShape}],execute:function(){n._RF.push({},"c404dqgha9J1YgpZRVg/sHq","continuous-line-controller",void 0),t("default",function(t){function n(e){var n;return(n=t.call(this,e)||this)._lineShape=null,n.initShape(),n}e(n,t);var i=n.prototype;return i.initShape=function(){this.createShapeNode("ContinuousLineController"),this._lineShape=o("Continuous Line"),this._lineShape.parent=this.shape},i.updatePoints=function(t){this._lineShape.updatePoints(t)},n}(i)),n._RF.pop()}}})),System.register("chunks:///_virtual/controller.ts",["cc","./index.ts","./utils.ts","./npm.ts"],(function(t){var e,n,i;return{setters:[function(t){e=t.cclegacy,n=t.js},null,null,function(t){i=t.cce}],execute:function(){e._RF.push({},"aa4a2A2+8hPZLJSXNh0jqHD","controller",void 0),t("default",function(){var t=e.prototype;function e(t){this.shape=null,this._lockSize=!0,n.addon(this,new i.gizmos.ControllerBase(t))}return t.createShapeNode=function(t){return i.gizmos.ControllerBase.prototype.createShapeNode.call(this,t)},t.initHandle=function(t,e){return i.gizmos.ControllerBase.prototype.initHandle.call(this,t,e)},t.updateController=function(){return i.gizmos.ControllerBase.prototype.updateController.call(this)},t.show=function(){return i.gizmos.ControllerBase.prototype.show.call(this)},t.hide=function(){return i.gizmos.ControllerBase.prototype.hide.call(this)},t.registerCameraMovedEvent=function(){return i.gizmos.ControllerBase.prototype.registerCameraMovedEvent.call(this)},t.unregisterCameraMoveEvent=function(){return i.gizmos.ControllerBase.prototype.unregisterCameraMoveEvent.call(this)},t.adjustControllerSize=function(){return i.gizmos.ControllerBase.prototype.adjustControllerSize.call(this)},t.onControllerMouseDown=function(t){},t.onControllerMouseMove=function(t){},t.onControllerMouseUp=function(t){},t.onMouseDown=function(t){this.onControllerMouseDown(t)},t.onMouseMove=function(t){this.onControllerMouseMove(t)},t.onMouseUp=function(t){this.onControllerMouseUp(t)},t.onMouseLeave=function(t){this.onMouseUp(t)},e}()),CC_EDITOR,e._RF.pop()}}})),System.register("chunks:///_virtual/cubic-bezier-curve.ts",["./rollupPluginModLoBabelHelpers.js","cc","./curve-sample.ts","./event.ts","./mathf.ts","./pool.ts"],(function(t){var e,n,i,o,r,s,a;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,i=t.Vec3},function(t){o=t.default},function(t){r=t.default},function(t){s=t.default},function(t){a=t.default}],execute:function(){n._RF.push({},"5325fLfN2hCK5YSAMQE0ffY","cubic-bezier-curve",void 0),t("default",function(){function t(t,e){this.n1=void 0,this.n2=void 0,this.samples=[],this.changed=new r,this.length=0,this._gizmoEditing=!1,this._points=[],this._minPos=new i,this._maxPos=new i,this.n1=t,this.n2=e,this.computeSamples=this.computeSamples.bind(this),t.changed.addListener(this.computeSamples),e.changed.addListener(this.computeSamples),this.computeSamples()}var n=t.prototype;return n.connectStart=function(t){this.n1.changed.removeListener(this.computeSamples),this.n1=t,t.changed.addListener(this.computeSamples),this.computeSamples()},n.connectEnd=function(t){this.n2.changed.removeListener(this.computeSamples),this.n2=t,t.changed.addListener(this.computeSamples),this.computeSamples()},n.getInverseDirection=function(t){return(t=t||new i).set(this.n2.position).multiplyScalar(2).subtract(this.n2.direction)},n.getLocation=function(t,e){e=e||new i;var n=1-t,o=n*n,r=t*t,s=a.Vec3.get(),l=a.Vec3.get(),c=a.Vec3.get();return e.set(this.n1.position).multiplyScalar(o*n),e.add(s.set(this.n1.direction).multiplyScalar(3*o*t)),e.add(this.getInverseDirection(c).multiplyScalar(3*n*r)),e.add(l.set(this.n2.position).multiplyScalar(r*t)),a.Vec3.put(s),a.Vec3.put(l),a.Vec3.put(c),e},n.getTangent=function(t,e){e=e||new i;var n=1-t,o=n*n,r=t*t;return new i(this.n1.position).multiplyScalar(-o).add(new i(this.n1.direction).multiplyScalar(3*o-2*n)).add(this.getInverseDirection().multiplyScalar(-3*r+2*t)).add(new i(this.n2.position).multiplyScalar(r)).normalize()},n.getUp=function(t){return this.n1.up.clone().lerp(this.n2.up,t)},n.getScale=function(t){return this.n1.scale.clone().lerp(this.n2.scale,t)},n.getRoll=function(t){return s.lerp(this.n1.roll,this.n2.roll,t)},n.getSamples=function(){return this.samples},n.computeSamples=function(){var t=this.samples;t.length=31,this.length=0;for(var e=this.getLocation(0),n=0;n<=30;n++){var r=.03333333333333333*n,s=this.getLocation(r);this.length+=i.distance(e,s),e=s,t[n]||(t[n]=new o),this.updateSample(t[n],this.length,r)}this._points.length=0,this.changed.invoke()},n.updateSample=function(t,e,n){return t.set(this.getLocation(n),this.getTangent(n),this.getUp(n),this.getScale(n),this.getRoll(n),e,n)},n.getSample=function(t,e){!function(t){if(t<0||t>1)throw new Error("Time must be between 0 and 1 (was "+t+").")}(t);for(var n=this.samples,i=n[0],r=null,s=0;s<n.length;s++){var a=n[s];if(a.timeInCurve>=t){r=a;break}i=a}if(null==r)throw new Error("Can't find curve samples.");var l=r==i?0:(t-i.timeInCurve)/(r.timeInCurve-i.timeInCurve);return o.lerp(i,r,l,e)},n.getSampleAtDistance=function(t,e){if(t<0||t>this.length)throw new Error("Distance must be positive and less than curve length. Length = "+this.length+", given distance was "+t);0===t?t=.001:t===this.length&&(t=this.length-.001);for(var n=this.samples,i=n[0],r=null,s=0;s<n.length;s++){var a=n[s];if(a.distanceInCurve>=t){r=a;break}i=a}if(null==r)throw new Error("Can't find curve samples.");var l=r==i?0:(t-i.distanceInCurve)/(r.distanceInCurve-i.distanceInCurve);return o.lerp(i,r,l,e)},n.getPoints=function(){return 0===this._points.length&&this._caclBoundingBox(),this._points},n.getBounding=function(t,e){0===this._points.length&&this._caclBoundingBox(),t.set(this._minPos),e.set(this._maxPos)},n._caclBoundingBox=function(){for(var t=this._points,e=this._minPos.set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),n=this._maxPos.set(-Number.MAX_SAFE_INTEGER,-Number.MAX_SAFE_INTEGER,-Number.MAX_SAFE_INTEGER),i=this.getSamples(),o=0;o<i.length;o++){var r=t[o]=i[o].location;e.x=Math.min(e.x,r.x),e.y=Math.min(e.y,r.y),e.z=Math.min(e.z,r.z),n.x=Math.max(n.x,r.x),n.y=Math.max(n.y,r.y),n.z=Math.max(n.z,r.z)}t.length=i.length},e(t,[{key:"gizmoEditing",get:function(){return this._gizmoEditing},set:function(t){this._gizmoEditing=t}}]),t}()),n._RF.pop()}}})),System.register("chunks:///_virtual/curve-sample.ts",["./rollupPluginModLoBabelHelpers.js","cc","./mathf.ts","./mesh-vertex.ts","./pool.ts"],(function(t){var e,n,i,o,r,s,a,l,c;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,i=t.Vec3,o=t.Quat,r=t.Vec2},function(t){s=t.default},function(t){a=t.default},function(t){l=t.default,c=t.Pool}],execute:function(){n._RF.push({},"e97a3DFPW5DtprWvZMLUB55","curve-sample",void 0);var u=new i(0,0,1),h=Math.PI/180,p=o.fromEuler(new o,0,-90,0);t("default",function(){function t(){this.location=new i,this.tangent=new i,this.up=new i,this.scale=new r,this.roll=0,this.distanceInCurve=0,this.timeInCurve=0,this._transformedUp=null,this._rotation=null,this._bentRotation=null}t.create=function(e,n,i,o,r,s,a){return(new t).set(e,n,i,o,r,s,a)};var n=t.prototype;return n.set=function(t,e,n,i,o,r,s){return this.location.set(t),this.tangent.set(e),this.up.set(n),this.scale.set(i),this.roll=o,this.distanceInCurve=r,this.timeInCurve=s,this._transformedUp&&(l.Vec3.put(this._transformedUp),this._transformedUp=null),this._rotation&&(l.Quat.put(this._rotation),this._rotation=null),this._bentRotation&&(l.Quat.put(this._bentRotation),this._bentRotation=null),this},t.lerp=function(e,n,o,a){var c=l.Vec3.get(),u=l.Vec3.get(),h=l.Vec3.get(),p=l.Vec2.get();return(a=a||new t).set(i.lerp(c,e.location,n.location,o),i.lerp(u,e.tangent,n.tangent,o).normalize(),i.lerp(h,e.up,n.up,o),r.lerp(p,e.scale,n.scale,o),s.lerp(e.roll,n.roll,o),s.lerp(e.distanceInCurve,n.distanceInCurve,o),s.lerp(e.timeInCurve,n.timeInCurve,o)),l.Vec3.put(c),l.Vec3.put(u),l.Vec3.put(h),l.Vec2.put(p),a},n.getBent=function(t,e){e?e!==t&&e.set(t):e=a.create(t);var n=l.Vec3.get();i.multiply(e.position,e.position,n.set(0,this.scale.y,this.scale.x)),l.Vec3.put(n);var r=l.Quat.get();return o.fromAxisAngle(r,i.RIGHT,this.roll*h),i.transformQuat(e.position,e.position,r),i.transformQuat(e.normal,e.normal,r),i.transformQuat(e.tangent,e.tangent,r),l.Quat.put(r),e.position.x=0,r=this.bentRotation,i.transformQuat(e.position,e.position,r),e.position.add(this.location),i.transformQuat(e.normal,e.normal,r),i.transformQuat(e.tangent,e.tangent,r),e},e(t,[{key:"transformedUp",get:function(){if(!this._transformedUp){var t=l.Quat.get(),e=l.Vec3.get();o.fromAxisAngle(t,u,this.roll*h),i.transformQuat(e,this.up,t),this._transformedUp=i.cross(new i,this.tangent,i.cross(e,e,this.tangent).normalize()),l.Quat.put(t),l.Vec3.put(e)}return this._transformedUp}},{key:"rotation",get:function(){return this._rotation||(this._rotation=o.fromViewUp(new o,this.tangent,this.transformedUp)),this._rotation}},{key:"bentRotation",get:function(){if(!this._bentRotation){var t=l.Vec3.get(),e=l.Vec3.get();t.set(this.tangent),e.set(this.up),Math.abs(i.dot(t,this.up)-1)<.01&&(t.x+=.01,t.normalize()),i.cross(e,t,e).normalize(),i.cross(e,e,t);var n=new o;o.fromViewUp(n,t,e),this._bentRotation=o.multiply(n,n,p),l.Vec3.put(t),l.Vec3.put(e)}return this._bentRotation}}],[{key:"pool",get:function(){return this._pool||(this._pool=new c(t)),this._pool}}]),t}())._pool=void 0,n._RF.pop()}}})),System.register("chunks:///_virtual/DelayRecycle.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./Recycle.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.ParticleSystem},function(t){r=t.default},function(t){s=t.Recycle}],execute:function(){var a;n._RF.push({},"bec25UomNFPWpViqmZ+HQjM","DelayRecycle",void 0);var l=i.ccclass;i.property,t("DelayRecycle",l("DelayRecycle")(a=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).delayTime=1,e}e(n,t);var i=n.prototype;return i.onEnable=function(){for(var t=this.node.getComponentsInChildren(o),e=0;e<t.length;e++)t[e].stop(),t[e].clear(),t[e].play();this.scheduleOnce(this.recycle,this.delayTime)},i.update=function(t){},i.onDisable=function(){this.unschedule(this.recycle)},i.recycle=function(){r.instance.putItem(this.path,this.node)},n}(s))||a),n._RF.pop()}}})),System.register("chunks:///_virtual/DeskComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"1ebf8V9+D9A9ZIu3A27l+Rk","DeskComp",void 0);var s=i.ccclass;i.property,t("DeskComp",s("DeskComp")(r=o.register("DeskComp")(r=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.reset=function(){},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/DeskCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.BaseCtrl}],execute:function(){var s;n._RF.push({},"f6538Xp5ZFNPa60VXBjoz+M","DeskCtrl",void 0);var a=i.ccclass;i.property,t("DeskCtrl",a("DeskCtrl")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.Desk,this.init("Desk")},i.onDisable=function(){t.prototype.onDisable.call(this)},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/DeskEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./DeskComp.ts","./RoleEntity.ts","./BagComp.ts","./Constant.ts","./BadgeEntity.ts","./GlobalSingle.ts","./PoolManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.BoxCollider,l=t.Node,c=t.Quat,u=t.tween,h=t.v3},function(t){p=t.ecs},function(t){d=t.CCComp},function(t){f=t.DeskComp},function(t){g=t.RoleEntity},function(t){m=t.BagComp},function(t){v=t.ResEnum,y=t.BadgeType},function(t){b=t.BadgeEntity},function(t){C=t.GlobalSingle},function(t){_=t.default}],execute:function(){var E,w,S,P,M,T,k,N,R,B;r._RF.push({},"cbc3dtqPRRDgYCNIiM07OH/","DeskEntity",void 0);var F=s.ccclass,L=s.property;t("DeskEntity",(E=F("DeskEntity"),w=p.register("DeskEntity",!1),S=L(a),P=L(l),M=L(l),E(T=w((N=e((k=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"collider",N,o(e)),i(e,"yellowPos",R,o(e)),i(e,"grayPos",B,o(e)),e.canUnload=!1,e.quat=new c,e.unloading=!1,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){this.canUnload=!1,this.unloading=!1,_.instance.putItem(v.Desk,this.node,!0)},r.onEnable=function(){var t=new f;this.ent.add(t),this.collider.on("onTriggerEnter",this.onTriggerEnter,this),this.collider.on("onTriggerStay",this.onTriggerStay,this),this.collider.on("onTriggerExit",this.onTriggerExit,this)},r.onDisable=function(){this.collider.off("onTriggerEnter",this.onTriggerEnter,this),this.collider.off("onTriggerStay",this.onTriggerStay,this),this.collider.on("onTriggerExit",this.onTriggerExit,this),this.ent&&this.ent.destroy(!0)},r.onTriggerEnter=function(t){var e=t.otherCollider.node.getComponent(g);e&&e.ent.has(m)&&(this.canUnload=!0)},r.onTriggerStay=function(t){var e=t.otherCollider.node.getComponent(g);this.canUnload&&e&&e.isPlayer&&(C.instance.joystickMoving?this.unloading&&(this.unloading=!1):this.unloading||(this.unloading=!0,this.startChange(e.ent.get(m))))},r.onTriggerExit=function(t){var e=t.otherCollider.node.getComponent(g);e&&e.ent&&e.ent.has(m)&&(this.canUnload=!1,this.unloading=!1)},r.startChange=function(t){var e=this,n=t.getBadgeByType(y.yellow,"Desk");if(this.unloading&&this.canUnload&&n){var i=n.worldPosition;n.parent=this.yellowPos,n.setWorldPosition(i),t.resizePos(),c.fromEuler(this.quat,90,0,0),u(n).to(.03,{position:h(0,0,0),rotation:this.quat}).call((function(){i=n.worldPosition,n.parent=e.grayPos,n.setWorldPosition(i)})).to(.01,{position:h(0,0,0)}).call((function(){n.getComponent(b).badgeType=y.gray})).call((function(){t.pushBadge(n,(function(){e.startChange(t)}))})).start()}},e}(d)).prototype,"collider",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(k.prototype,"yellowPos",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(k.prototype,"grayPos",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=k))||T)||T)),r._RF.pop()}}})),System.register("chunks:///_virtual/DeskSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DeskComp.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator},function(t){r=t.DeskComp},function(t){s=t.ecs}],execute:function(){var a;i._RF.push({},"881fe+oYx9LXq4iKuKrh1Wy","DeskSys",void 0);var l=o.ccclass;t("DeskSys",l("DeskSys")(a=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var o=i.prototype;return o.filter=function(){return s.allOf(r)},o.init=function(){},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},o.firstUpdate=function(t){},o.entityRemove=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},o.update=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},i}(s.ComblockSystem))||a),i._RF.pop()}}})),System.register("chunks:///_virtual/DrawGround.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RoleEntity.ts","./EventManager.ts","./spline.ts","./spline-smoother.ts","./Constant.ts","./GlobalSingle.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.v3,c=t.Vec3,u=t.Component},function(t){h=t.RoleEntity},function(t){p=t.EventManager},function(t){d=t.default},function(t){f=t.splineSmoother},function(t){g=t.GameEvent},function(t){m=t.GlobalSingle}],execute:function(){var v,y,b,C,_;r._RF.push({},"95919mblB5GE5AQ8cC3SJCz","DrawGround",void 0);var E=s.ccclass,w=s.property;t("DrawGround",(v=E("DrawGround"),y=w(a),v((_=e((C=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"sower",_,o(e)),e._spline=void 0,e._splineSmoother=void 0,e.enemyCount=0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){this._spline=this.sower.getComponent(d)},r.onEnable=function(){p.instance.on(g.RoleNumChangeEvent,this.DrawGroundLineFun,this),this.scheduleOnce(this.drawLine,.1)},r.update=function(t){},r.onDisable=function(){p.instance.off(g.RoleNumChangeEvent,this.DrawGroundLineFun,this)},r.DrawGroundLineFun=function(){this.enemyCount!=m.instance.enemyEntities.length&&(this.enemyCount=m.instance.enemyEntities.length,this.unschedule(this.drawLine),this.scheduleOnce(this.drawLine,.1))},r.clearAll=function(){this._spline._nodes.length>0&&(this._spline.removeNode(0),this.clearAll())},r.drawLine=function(){if(m.instance.enemyEntities.length>0){this.sower.active=!0,this._splineSmoother=this.getComponent(f),this._splineSmoother&&this._splineSmoother.isValid&&(this._splineSmoother.destroy(),this._splineSmoother=null),this.clearAll();for(var t=null,e=null,n=null,i=null,o=null,r=0;r<m.instance.enemyEntities.length;r++)t=m.instance.enemyEntities[r].get(h).node.worldPosition,e?t.x<e.x&&(e=t.clone()):e=t.clone(),n?t.x>n.x&&(n=t.clone()):n=t.clone(),i?t.z<i.z&&(i=t.clone()):i=t.clone(),o?t.z>o.z&&(o=t.clone()):o=t.clone();var s=[],a=l((e.x+n.x)/2,.5,(i.z+o.z)/2);e.x-=5,n.x+=5,m.instance.enemyEntities.sort((function(t,e){return t.get(h).node.worldPosition.x-e.get(h).node.worldPosition.x})),s.push(e);for(var u=0;u<m.instance.enemyEntities.length;u++)(t=m.instance.enemyEntities[u].get(h).node.worldPosition).z>a.z&&(Math.abs(s[s.length-1].x-t.x)>5?s.push(t.clone()):t.z>s[s.length-1].z&&(s[s.length-1]=t.clone()));m.instance.enemyEntities.sort((function(t,e){return e.get(h).node.worldPosition.x-t.get(h).node.worldPosition.x})),s.push(n);for(var p=0;p<m.instance.enemyEntities.length;p++)(t=m.instance.enemyEntities[p].get(h).node.worldPosition).z<a.z&&(Math.abs(s[s.length-1].x-t.x)>5?s.push(t.clone()):t.z<s[s.length-1].z&&(s[s.length-1]=t.clone()));s.push(e),s.length<=3&&(s=[],i.z-=5,o.z+=5,s.push(i),s.push(n),s.push(o),s.push(e),s.push(i));for(var d=0;d<s.length;d++)s[d].z<a.z?s[d].z-=3:s[d].z+=3,this._spline.addNode(s[d],c.UP);this._splineSmoother=this.addComponent(f),this._spline.isLoop=!0}else this.sower.active=!1},e}(u)).prototype,"sower",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=C))||b)),r._RF.pop()}}})),System.register("chunks:///_virtual/ECS.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.createClass,n=t.construct,i=t.createForOfIteratorHelperLoose,o=t.inheritsLoose},function(t){r=t.cclegacy}],execute:function(){var s;t("ecs",void 0),r._RF.push({},"355acI3VsBDvIKS/sRtsNqv","ECS",void 0),function(t){var r=function(){this.canRecycle=!0};r.tid=-1,r.compName=void 0,t.Comp=r;var s=new Map,a=0,l=[],c=new Map,u=new Map;t.register=function(t,e){return void 0===e&&(e=!0),function(n){if(-1!==n.tid)throw new Error("重复注册组件： "+t+".");n.tid=a++,n.compName=t,e?(l.push(n),s.set(n.tid,[])):l.push(null),c.set(n.tid,[])}},t.registerTag=function(){return function(t){var e=a;for(var n in t)e=a++,t[n]=e,l.push(e),s.set(e,[]),c.set(e,[]),u.set(e,n)}};var h=[],p=new Map,d=new Map,f=1;function g(){var t=h.pop();return t||((t=new _).eid=f++),p.set(t.eid,t),t}function m(t){return g().add(t)}function v(t){var e=d.get(t.mid);if(!e){e=new E(t),d.set(t.mid,e);for(var n=t.indices,i=0;i<n.length;i++)c.get(n[i]).push(e.onComponentAddOrRemove.bind(e))}return e}function y(t,e){for(var n=c.get(e),i=n.length-1;i>=0;i--)n[i](t);b.has(e)&&b.delete(e)}t.createEntity=g,t.createEntityWithComp=m,t.createEntityWithComps=function(){var t=g();return t.addComponents.apply(t,arguments),t},t.createGroup=v,t.query=function(t){var e=d.get(t.mid);return e||(e=v(t),p.forEach(e.onComponentAddOrRemove,e)),e.matchEntities},t.clear=function(){p.forEach((function(t){t.destroy()})),d.forEach((function(t){t.clear()})),c.forEach((function(t){t.length=0})),p.clear(),d.clear()},t.getEntityByEid=function(t){return p.get(t)},t.activeEntityCount=function(){return p.size},t.allOf=function(){var t;return(t=new k).allOf.apply(t,arguments)},t.anyOf=function(){var t;return(t=new k).anyOf.apply(t,arguments)},t.onlyOf=function(){var t;return(t=new k).onlyOf.apply(t,arguments)},t.excludeOf=function(){var t;return(t=new k).excludeOf.apply(t,arguments)};var b=new Map;t.getSingleton=function(t){if(!b.has(t.tid)){var e=m(t);b.set(t.tid,e)}return b.get(t.tid)},t.addSingleton=function(t){var e=t.constructor.tid;b.has(e)||b.set(e,t)};var C=function(){function t(){this.mask=void 0,this.size=0;var t=Math.ceil(a/31);this.mask=new Uint32Array(t),this.size=t}var e=t.prototype;return e.set=function(t){this.mask[t/31>>>0]|=1<<t%31},e.delete=function(t){this.mask[t/31>>>0]&=~(1<<t%31)},e.has=function(t){return!!(this.mask[t/31>>>0]&1<<t%31)},e.or=function(t){for(var e=0;e<this.size;e++)if(this.mask[e]&t.mask[e])return!0;return!1},e.and=function(t){for(var e=0;e<this.size;e++)if((this.mask[e]&t.mask[e])!=this.mask[e])return!1;return!0},e.clear=function(){for(var t=0;t<this.size;t++)this.mask[t]=0},t}(),_=function(){function t(){this.eid=-1,this.mask=new C,this.compTid2Ctor=new Map,this.compTid2Obj=new Map}var e=t.prototype;return e.add=function(t,e){if(void 0===e&&(e=!1),"function"==typeof t){var n,i=t.tid;if(-1===t.tid)throw Error("组件未注册！");if(this.compTid2Ctor.has(i)){if(!e)return console.log("已经存在组件："+t.compName),this[t.compName];this.remove(t)}return this.mask.set(i),this.compTid2Obj.has(i)?(n=this.compTid2Obj.get(i),this.compTid2Obj.delete(i)):n=function(t){if(!l[t.tid])throw Error("没有找到该组件的构造函数，检查"+t.compName+"是否为不可构造的组件");return s.get(t.tid).pop()||new l[t.tid]}(t),this[t.compName]=n,this.compTid2Ctor.set(i,t),n.ent=this,y(this,i),n}if("number"==typeof t){if(!u.has(t))throw Error("不存在的tag！");return this.mask.set(t),this.compTid2Ctor.set(t,t),this[u.get(t)]=t,y(this,t),this}var o=t.constructor,r=o.tid;if(-1===r||null==r)throw Error("组件未注册！");if(this.compTid2Ctor.has(r))throw Error("已经存在该组件！");return this.mask.set(r),this[o.compName]=t,this.compTid2Ctor.set(r,o),t.ent=this,t.canRecycle=!1,y(this,r),this},e.addComponents=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i=0,o=e;i<o.length;i++){var r=o[i];this.add(r)}return this},e.get=function(t){return this["number"==typeof t?u.get(t):t.compName]},e.has=function(t){return"number"==typeof t?this.mask.has(t):this.compTid2Ctor.has(t.tid)},e.remove=function(t,e){void 0===e&&(e=!0);var n=-1,i="",o=!1;if("number"==typeof t)n=t,this.mask.has(t)&&(o=!0,i=u.get(t));else if(n=t.tid,i=t.compName,this.mask.has(n)){o=!0;var r=this[t.compName];r.ent=null,e?(r.reset(),r.canRecycle&&s.get(n).push(r)):this.compTid2Obj.set(n,r)}o&&(this[i]=null,this.mask.delete(n),this.compTid2Ctor.delete(n),y(this,n))},e._remove=function(t){this.remove(t,!1)},e._remove2=function(t){this.remove(t,!0)},e.removeAll=function(){this.compTid2Ctor.forEach(this._remove2,this)},e.destroy=function(t){var e;void 0===t&&(t=!1),t?this.removeAll():this.compTid2Ctor.forEach(this._remove,this),e=this,p.has(e.eid)?(h.push(e),p.delete(e.eid)):console.warn("试图销毁不存在的实体！"),this.compTid2Obj.clear()},t}();t.Entity=_;var E=function(){function t(t){this.matcher=void 0,this._matchEntities=new Map,this._entitiesCache=null,this.count=0,this._enteredEntities=null,this._removedEntities=null,this.matcher=t}var n=t.prototype;return n.onComponentAddOrRemove=function(t){this.matcher.isMatch(t)?(this._matchEntities.set(t.eid,t),this._entitiesCache=null,this.count++,this._enteredEntities&&(this._enteredEntities.set(t.eid,t),this._removedEntities.delete(t.eid))):this._matchEntities.has(t.eid)&&(this._matchEntities.delete(t.eid),this._entitiesCache=null,this.count--,this._enteredEntities&&(this._enteredEntities.delete(t.eid),this._removedEntities.set(t.eid,t)))},n.watchEntityEnterAndRemove=function(t,e){this._enteredEntities=t,this._removedEntities=e},n.clear=function(){var t,e;this._matchEntities.clear(),this._entitiesCache=null,this.count=0,null==(t=this._enteredEntities)||t.clear(),null==(e=this._removedEntities)||e.clear()},e(t,[{key:"matchEntities",get:function(){return null===this._entitiesCache&&(this._entitiesCache=Array.from(this._matchEntities.values())),this._entitiesCache}},{key:"entity",get:function(){return this.matchEntities[0]}}]),t}();t.Group=E;var w=function(){function t(){this.mask=new C,this.indices=[];for(var t=-1,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(var o=n.length,r=0;r<o;r++){if(-1==(t="number"==typeof n[r]?n[r]:n[r].tid))throw Error("存在没有注册的组件！");this.mask.set(t),this.indices.indexOf(t)<0&&this.indices.push(t)}o>1&&this.indices.sort((function(t,e){return t-e}))}return t.prototype.toString=function(){return this.indices.join("-")},t}(),S=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.isMatch=function(t){return this.mask.or(t.mask)},n.getKey=function(){return"anyOf:"+this.toString()},e}(w),P=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.isMatch=function(t){return this.mask.and(t.mask)},n.getKey=function(){return"allOf:"+this.toString()},e}(w),M=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var n=e.prototype;return n.getKey=function(){return"excludeOf:"+this.toString()},n.isMatch=function(t){return!this.mask.or(t.mask)},e}(w),T=1,k=function(){function t(){this.rules=[],this._indices=null,this.mid=-1,this._key=null,this.mid=T++}var o=t.prototype;return o.anyOf=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.rules.push(n(S,e)),this.bindMatchMethod(),this},o.allOf=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.rules.push(n(P,e)),this.bindMatchMethod(),this},o.onlyOf=function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.rules.push(n(P,e));for(var r,s=[],a=i(l);!(r=a()).done;){var c=r.value;e.indexOf(c)<0&&s.push(c)}return this.rules.push(n(M,s)),this.bindMatchMethod(),this},o.excludeOf=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.rules.push(n(M,e)),this.bindMatchMethod(),this},o.bindMatchMethod=function(){1===this.rules.length?this.isMatch=this.isMatch1:2===this.rules.length?this.isMatch=this.isMatch2:this.isMatch=this.isMatchMore},o.isMatch1=function(t){return this.rules[0].isMatch(t)},o.isMatch2=function(t){return this.rules[0].isMatch(t)&&this.rules[1].isMatch(t)},o.isMatchMore=function(t){for(var e,n=i(this.rules);!(e=n()).done;)if(!e.value.isMatch(t))return!1;return!0},o.clone=function(){var e=new t;return e.mid=T++,this.rules.forEach((function(t){return e.rules.push(t)})),e},e(t,[{key:"key",get:function(){if(!this._key){for(var t="",e=0;e<this.rules.length;e++)t+=this.rules[e].getKey(),e<this.rules.length-1&&(t+=" && ");this._key=t}return this._key}},{key:"indices",get:function(){var t=this;return null===this._indices&&(this._indices=[],this.rules.forEach((function(e){Array.prototype.push.apply(t._indices,e.indices)}))),this._indices}}]),t}(),N=function(){function t(){this.group=void 0,this.dt=0,this.enteredEntities=null,this.removedEntities=null,this.hasEntityEnter=!1,this.hasEntityRemove=!1,this.tmpExecute=null;var t=Object.hasOwnProperty,e=Object.getPrototypeOf(this),n=t.call(e,"entityEnter"),i=t.call(e,"entityRemove"),o=t.call(e,"firstUpdate");this.hasEntityEnter=n,this.hasEntityRemove=i,n||i?(this.enteredEntities=new Map,this.removedEntities=new Map,this.execute=this.execute1,this.group=v(this.filter()),this.group.watchEntityEnterAndRemove(this.enteredEntities,this.removedEntities)):(this.execute=this.execute0,this.group=v(this.filter())),o&&(this.tmpExecute=this.execute,this.execute=this.updateOnce)}var e=t.prototype;return e.init=function(){},e.onDestroy=function(){},e.hasEntity=function(){return this.group.count>0},e.updateOnce=function(t){0!==this.group.count&&(this.dt=t,this.enteredEntities.size>0&&(this.entityEnter(Array.from(this.enteredEntities.values())),this.enteredEntities.clear()),this.firstUpdate(this.group.matchEntities),this.execute=this.tmpExecute,this.execute(t),this.tmpExecute=null)},e.execute0=function(t){0!==this.group.count&&(this.dt=t,this.update(this.group.matchEntities))},e.execute1=function(t){this.removedEntities.size>0&&(this.hasEntityRemove&&this.entityRemove(Array.from(this.removedEntities.values())),this.removedEntities.clear()),0!==this.group.count&&(this.dt=t,this.enteredEntities.size>0&&(this.hasEntityEnter&&this.entityEnter(Array.from(this.enteredEntities.values())),this.enteredEntities.clear()),this.update(this.group.matchEntities))},t}();t.ComblockSystem=N;var R=function(){function t(){this.executeSystemFlows=[],this.systemCnt=0}var e=t.prototype;return e.add=function(t){return t instanceof B?Array.prototype.push.apply(this.executeSystemFlows,t.comblockSystems):this.executeSystemFlows.push(t),this.systemCnt=this.executeSystemFlows.length,this},e.init=function(){this.executeSystemFlows.forEach((function(t){return t.init()}))},e.execute=function(t){for(var e=0;e<this.systemCnt;e++)this.executeSystemFlows[e].execute(t)},e.clear=function(){this.executeSystemFlows.forEach((function(t){return t.onDestroy()}))},t}();t.RootSystem=R;var B=function(){function t(){this._comblockSystems=[]}return t.prototype.add=function(e){return e instanceof t?(Array.prototype.push.apply(this._comblockSystems,e._comblockSystems),e._comblockSystems.length=0):this._comblockSystems.push(e),this},e(t,[{key:"comblockSystems",get:function(){return this._comblockSystems}}]),t}();t.System=B}(s||(s=t("ecs",{}))),r._RF.pop()}}})),System.register("chunks:///_virtual/editor.ts",["cc","./env","./npm.ts"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.EDITOR},null],execute:function(){e._RF.push({},"ecf777/C31MVJNamTmKSC+3","editor",void 0),t("Editor",n),t("projectPath",n),t("projectAssetPath",n),e._RF.pop()}}})),System.register("chunks:///_virtual/EnemyComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.RigidBodyGroup},function(t){r=t.RoleEntity},function(t){s=t.ecs}],execute:function(){var a;n._RF.push({},"7eeedkVxBFPH46GpDS9Yd9S","EnemyComp",void 0);var l=i.ccclass;i.property,t("EnemyComp",l("EnemyComp")(a=s.register("EnemyComp")(a=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.reset=function(){},i.init=function(){var t=this.ent.get(r);t.rigidbody.setGroup(1<<o.Enemy),t.rigidbody.setMask(1<<o.Player|1<<o.Building|1<<o.Soldier|1<<o.Enemy|1<<o.BulletSoldier)},n}(s.Comp))||a)||a),n._RF.pop()}}})),System.register("chunks:///_virtual/EnemyLevelCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./PoolManager.ts","./Constant.ts","./GameUtil.ts","./GlobalSingle.ts","./RoleCtrl.ts","./EnemyLevelExport.ts","./StorageData.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component},function(t){r=t.EventManager},function(t){s=t.default},function(t){a=t.GameEvent,l=t.ResEnum},function(t){c=t.GameUtil},function(t){u=t.GlobalSingle},function(t){h=t.RoleCtrl},function(t){p=t.EnemyLevelExport},function(t){d=t.StorageData}],execute:function(){var f;n._RF.push({},"48e63Cyi9NFv6ESCs9RH2ht","EnemyLevelCtrl",void 0);var g=i.ccclass;i.property,t("EnemyLevelCtrl",g("EnemyLevelCtrl")(f=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){var t=this;r.instance.on(a.PackageEvent,this.packageEventFun,this),c.instance.getBundle("res").then((function(e){t.init()}))},i.onDisable=function(){r.instance.off(a.PackageEvent,this.packageEventFun,this)},i.init=function(){var t=this,e=u.instance.tables.EnemyLevel[d.instance.level];s.instance.getItemSync(l.level+e.ResId).then((function(e){e.getComponent(p).enabled=!1,e.active=!0,e.parent=t.node,u.instance.enemyTotalCount=e.getComponentsInChildren(h).length}))},i.packageEventFun=function(t,e){this.node.destroyAllChildren(),this.node.active=!1},n}(o))||f),n._RF.pop()}}})),System.register("chunks:///_virtual/EnemyLevelExport.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseCtrl.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Component},function(t){s=t.BaseCtrl}],execute:function(){var a;i._RF.push({},"63933+4mgdFqoW28iQn5eXI","EnemyLevelExport",void 0);var l=o.ccclass,c=(o.property,o.executeInEditMode);t("EnemyLevelExport",l("EnemyLevelExport")(a=c(a=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var o=i.prototype;return o.onEnable=function(){for(var t,e=this.node.getComponentsInChildren(s),i=n(e);!(t=i()).done;)t.value.debug=!0},o.onDisable=function(){for(var t,e=this.node.getComponentsInChildren(s),i=n(e);!(t=i()).done;)t.value.debug=!1},i}(r))||a)||a),i._RF.pop()}}})),System.register("chunks:///_virtual/event.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"491abee/xBL+a9q9tGmsGRU","event",void 0),t("default",function(){function t(){this._listeners=[]}var e=t.prototype;return e.addListener=function(t,e){for(var n=this._listeners,i=0;i<n.length;i++)if(n[i][0]===t&&n[i][1]===e)return;this._listeners.push([t,e])},e.removeListener=function(t,e){for(var n=this._listeners,i=0;i<n.length;i++)if(n[i][0]===t)return void n.splice(i,1)},e.invoke=function(t,e,n,i,o,r){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];for(var l=this._listeners,c=0;c<l.length;c++){var u=l[c];u[0].apply(u[1],s)}},t}()),e._RF.pop()}}})),System.register("chunks:///_virtual/EventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.createForOfIteratorHelperLoose,n=t.createClass},function(t){i=t.cclegacy,o=t.warn,r=t.log}],execute:function(){i._RF.push({},"fb380+PaKlOkJ9Br8HiSUo9","EventManager",void 0),t("EventManager",function(){function t(){this._eventListeners={}}t.destroy=function(){this.instance&&(this.instance=null)};var i=t.prototype;return i.getEventListenersIndex=function(t,e,n){for(var i=-1,o=0;o<this._eventListeners[t].length;o++){var r=this._eventListeners[t][o];if(r.callBack==e&&(!n||r.target==n)){i=o;break}}return i},i.on=function(t,e,n){if(!t)return o("eventName is empty"+t),!1;if(null==e)return r("on callBack is nil"),!1;var i={callBack:e,target:n};return null==this._eventListeners[t]?this._eventListeners[t]=[i]:-1==this.getEventListenersIndex(t,e,n)&&this._eventListeners[t].push(i),!0},i.setEvent=function(t,e,n){if(!t)return o("eventName is empty"+t),!1;if(null==e)return r("setEvent callBack is nil"),!1;var i={callBack:e,target:n};return this._eventListeners[t]=[i],!0},i.off=function(t,e,n){if(null!=this._eventListeners[t]){var i=this.getEventListenersIndex(t,e,n);-1!=i&&this._eventListeners[t].splice(i,1)}},i.emit=function(t,n){if(null!=this._eventListeners[t]){for(var i,o=[],r=e(this._eventListeners[t]);!(i=r()).done;){var s=i.value;o.push({callBack:s.callBack,target:s.target})}for(var a=0,l=o;a<l.length;a++){var c=l[a];c.callBack.call(c.target,t,n)}}},n(t,null,[{key:"instance",get:function(){return null===t._instance&&(t._instance=new t),t._instance},set:function(e){t._instance=e}}]),t}())._instance=null,i._RF.pop()}}})),System.register("chunks:///_virtual/FadeComp.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component}],execute:function(){var r;n._RF.push({},"64a3eZVJ0lLProuX7MGrAGH","FadeComp",void 0);var s=i.ccclass;i.property,t("FadeComp",s("FadeComp")(r=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){},i.onDisable=function(){},n}(o))||r),n._RF.pop()}}})),System.register("chunks:///_virtual/FinishUi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DuilianGridAdMgr.ts","./UMTrack.ts","./GameUtil.ts","./GlobalSingle.ts","./UMEvent.ts","./AdManager.ts","./UIManager.ts","./UIView.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Label},function(t){l=t.default},function(t){c=t.UMTrack},function(t){u=t.GameUtil},function(t){h=t.GlobalSingle},function(t){p=t.UMEvent},function(t){d=t.default},function(t){f=t.UIManager},function(t){g=t.UIView}],execute:function(){var m,v,y,b,C;r._RF.push({},"57966GoPrhCp4nlru8PcZcm","FinishUi",void 0);var _=s.ccclass,E=s.property;t("FinishUi",(m=_("FinishUi"),v=E(a),m((C=e((b=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"awardLabel",C,o(e)),e.awardNum=10,e.args=void 0,e}n(e,t);var r=e.prototype;return r.onOpen=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.args=n,l.instance.showGrid(),d.instance.showBanner()},r.update=function(t){},r.onClose=function(){l.instance.hideGrid(),d.instance.hideBanner()},r.nextBtn=function(){this.args&&this.args[0].closeUi(),f.instance.close()},r.videoBtnFun=function(){var t=this;d.instance.createRewardedVideoAd({onClose:function(e){e.isEnded&&(u.instance.showToast("恭喜获得"+2*t.awardNum+"个金色铭牌"),c.instance.trackEvent(p.chufa_vi_jsy),h.instance.levelAwardYellowNum=2*t.awardNum,t.args&&t.args[0].closeUi(),f.instance.close())}})},e}(g)).prototype,"awardLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=b))||y)),r._RF.pop()}}})),System.register("chunks:///_virtual/fixed-buffer.ts",["cc"],(function(t){var e,n,i;return{setters:[function(t){e=t.cclegacy,n=t.gfx,i=t.utils}],execute:function(){e._RF.push({},"c525aXqpN1H1aoGvmJh1LMN","fixed-buffer",void 0);var o=t("builtinAttributes",{position:{name:n.AttributeName.ATTR_POSITION,format:n.Format.RGB32F},normal:{name:n.AttributeName.ATTR_NORMAL,format:n.Format.RGB32F},uv:{name:n.AttributeName.ATTR_TEX_COORD,format:n.Format.RG32F},uv1:{name:n.AttributeName.ATTR_TEX_COORD1,format:n.Format.RG32F},color:{name:n.AttributeName.ATTR_COLOR,format:n.Format.RGBA32F},tangent:{name:n.AttributeName.ATTR_TANGENT,format:n.Format.RGBA32F}});t("default",function(){function t(){this._buffer=null,this._ibuffer=null,this._vbuffer=null,this._dataView=null,this._iView=null,this._attrs={},this.verticesCount=0,this.indicesCount=0,this.verticesBytes=0,this.indicesBytes=0,this.verticesOffset=0,this.indicesOffset=0,this.stride=0}t.create=function(e,i,r,s){void 0===r&&(r=["position","normal","tangent","uv","uv1"]);for(var a=s.arrayBuffer,l=void 0===a?null:a,c=s.arrayBufferVerticesOffset,u=void 0===c?0:c,h=s.arrayBufferIndicesOffset,p=void 0===h?0:h,d={},f=0,g=0;g<r.length;g++){var m=o[r[g]].format,v=n.FormatInfos[m];d[r[g]]={gfxIndex:g,offset:f,format:m},f+=v.size}var y=new t;return y.verticesCount=e,y.indicesCount=i,y.verticesBytes=e*f,y.indicesBytes=2*i,l?(y.verticesOffset=u,y.indicesOffset=p,y._buffer=l):(y.verticesOffset=0,y.indicesOffset=y.verticesBytes,y._buffer=new ArrayBuffer(e*f+2*i)),y._dataView=new DataView(y._buffer,y.verticesOffset,y.verticesBytes),y._iView=new Uint16Array(y._buffer,y.indicesOffset,i),y._vbuffer=new Uint8Array(y._buffer,y.verticesOffset,y.verticesBytes),y._ibuffer=new Uint8Array(y._buffer,y.indicesOffset,y.indicesBytes),y.stride=f,y._attrs=d,y};var e=t.prototype;return e.writeVertex=function(t,e,n){var o=this._attrs[e],r=this.verticesOffset+t*this.stride+o.offset;i.writeBuffer(this._dataView,n,o.format,r,this.stride)},e.writeIndex=function(t,e){var n=this.indicesOffset+t;this._iView[n]=e},t}()),e._RF.pop()}}})),System.register("chunks:///_virtual/fixed-model-mesh.ts",["cc","./fixed-buffer.ts"],(function(t){var e,n,i,o,r,s,a;return{setters:[function(t){e=t.cclegacy,n=t.utils,i=t.gfx,o=t.Vec3,r=t.Mesh},function(t){s=t.builtinAttributes,a=t.default}],execute:function(){e._RF.push({},"45f87tuFodG1Zv7KceLZJhn","fixed-model-mesh",void 0),t("default",function(){function t(){this.mesh=null,this.modelComp=null,this.maxBatchVerticesCount=0,this._buffers=[],this._dataView=null,this._iView=null,this._attrs={},this._stride=0}t.create=function(e,n,l,c,u){void 0===u&&(u=["position","normal","tangent","uv","uv1"]);for(var h=new t,p=[],d={},f=0,g=0;g<u.length;g++){var m=s[u[g]],v=m.format;p.push(new i.Attribute(m.name,v)),d[u[g]]={gfxIndex:g,offset:f,format:v},f+=i.FormatInfos[v].size}h._attrs=d,h._stride=f;var y=h._buffers,b=c*e*f,C=new ArrayBuffer(b+c*n*2);h._dataView=new DataView(C,0,b),h._iView=new Uint16Array(C,b,c*n);for(var _=Math.floor(65535/e),E=0,w=b;c>0;){var S=Math.min(_,c),P=a.create(S*e,S*n,u,{arrayBuffer:C,arrayBufferVerticesOffset:E,arrayBufferIndicesOffset:w});y.push(P),c-=_,E+=P.verticesBytes,w+=P.indicesBytes}h.maxBatchVerticesCount=_*e;for(var M={vertexBundles:[],primitives:[],minPosition:new o,maxPosition:new o},T=0;T<y.length;T++){var k={attributes:p,view:{offset:y[T].verticesOffset,length:y[T].verticesBytes,count:y[T].verticesCount,stride:f}};M.vertexBundles.push(k);var N={primitiveMode:i.PrimitiveMode.TRIANGLE_LIST,vertexBundelIndices:[T],indexView:{offset:y[T].indicesOffset,length:y[T].indicesBytes,count:y[T].indicesCount,stride:2}};M.primitives.push(N)}var R=new r;return R.reset({struct:M,data:new Uint8Array(C)}),h.mesh=R,h.modelComp=l,h};var e=t.prototype;return e.writeVertex=function(t,e,i){var o=this._attrs[e],r=t*this._stride+o.offset;n.writeBuffer(this._dataView,i,o.format,r,this._stride)},e.writeIndex=function(t,e){e%=this.maxBatchVerticesCount,this._iView[t]=e},e.update=function(){for(var t=this.modelComp,e=this.mesh.renderingSubMeshes,n=0;n<e.length;n++){var i=e[n],o=this._buffers[n];i.vertexBuffers[0].update(o._vbuffer),i.indexBuffer.update(o._ibuffer);var r=t.model&&t.model.subModels[n];if(r){var s=r.inputAssembler;if(!s)return;s.vertexCount=o.verticesCount,s.indexCount=o.indicesCount,r.update()}}},t}()),e._RF.pop()}}})),System.register("chunks:///_virtual/FlagItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,s,a,l,c,u,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.SpriteFrame,c=t.Node,u=t.Sprite,h=t.Component}],execute:function(){var p,d,f,g,m,v,y,b,C,_,E;s._RF.push({},"2261bIW8Q9I57ueZuaX2qXm","FlagItem",void 0);var w=a.ccclass,S=a.property;t("FlagItem",(p=w("FlagItem"),d=S([l]),f=S([l]),g=S(c),m=S(c),p((b=e((y=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"flagLevel",b,o(e)),i(e,"letterLevel",C,o(e)),i(e,"flagNode",_,o(e)),i(e,"letterNode",E,o(e)),e.startProgress=0,e.endProgress=0,e._index=0,e._isPass=!1,e.levelID=0,e}n(e,t);var s=e.prototype;return s.start=function(){},s.update=function(t){},r(e,[{key:"index",get:function(){return this._index},set:function(t){this._index=t,this.index>0?this.letterNode.getComponent(u).spriteFrame=this.letterLevel[1]:this.letterNode.getComponent(u).spriteFrame=this.letterLevel[0]}},{key:"isPass",get:function(){return this._isPass},set:function(t){this._isPass=t,this._isPass?this.flagNode.getComponent(u).spriteFrame=this.flagLevel[1]:this.flagNode.getComponent(u).spriteFrame=this.flagLevel[0]}}]),e}(h)).prototype,"flagLevel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),C=e(y.prototype,"letterLevel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=e(y.prototype,"flagNode",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(y.prototype,"letterNode",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=y))||v)),s._RF.pop()}}})),System.register("chunks:///_virtual/FlyComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Vec3},function(t){r=t.default},function(t){s=t.ecs}],execute:function(){var a;n._RF.push({},"3a4adjBihBJB7WCAnI8iMCb","FlyComp",void 0);var l=i.ccclass;i.property,t("FlyComp",l("FlyComp")(a=s.register("FlyComp")(a=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this).flyNode=null,e.resPath=void 0,e.startWorldPos=null,e.destWorldPos=null,e.Speed=.1,e.flyDistance=0,e.moveDir=new o,e}return e(n,t),n.prototype.reset=function(){r.instance.putItem(this.resPath,this.flyNode)},n}(s.Comp))||a)||a),n._RF.pop()}}})),System.register("chunks:///_virtual/FlySys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FlyComp.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Vec3,s=t.Quat},function(t){a=t.FlyComp},function(t){l=t.ecs}],execute:function(){var c;i._RF.push({},"2138dgjMGNFgrFgZz+42I5T","FlySys",void 0);var u=o.ccclass;t("FlySys",u("FlySys")(c=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._dirQuat=new s,e._desPos=new r,e._flyComp=void 0,e}e(i,t);var o=i.prototype;return o.filter=function(){return l.allOf(a)},o.init=function(){},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value.get(a);o.flyNode.setWorldPosition(o.startWorldPos),r.subtract(o.moveDir,o.destWorldPos,o.startWorldPos),o.moveDir=o.moveDir.normalize(),o.moveDir=o.moveDir.multiplyScalar(o.Speed),s.fromViewUp(this._dirQuat,o.moveDir,r.UP),o.flyNode.setRotation(this._dirQuat),o.flyDistance=r.distance(o.startWorldPos,o.destWorldPos)}},o.firstUpdate=function(t){},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value;this._flyComp=o.get(a),r.add(this._desPos,this._flyComp.flyNode.position,this._flyComp.moveDir),this._flyComp.flyNode.setPosition(this._desPos),r.distance(this._flyComp.startWorldPos,this._flyComp.flyNode.worldPosition)>5*this._flyComp.flyDistance&&o.destroy(!0)}},i}(l.ComblockSystem))||c),i._RF.pop()}}})),System.register("chunks:///_virtual/FullGunPopComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./PoolManager.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.default},function(t){s=t.ecs}],execute:function(){var a;n._RF.push({},"e84a1nMoAZEqr7VLUZecuzQ","FullGunPopComp",void 0);var l=i.ccclass;i.property,t("FullGunPopComp",l("FullGunPopComp")(a=s.register("FullGunPopComp")(a=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).fullPopNode=null,e.attachNode=null,e}return e(n,t),n.prototype.reset=function(){r.instance.putItem(o.FullGunPop,this.fullPopNode),this.fullPopNode=null},n}(s.Comp))||a)||a),n._RF.pop()}}})),System.register("chunks:///_virtual/FullGunPopEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./GlobalSingle.ts","./RoleEntity.ts","./FullGunPopComp.ts","./EventManager.ts","./Constant.ts","./AdManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs},function(t){r=t.CCComp},function(t){s=t.GlobalSingle},function(t){a=t.RoleEntity},function(t){l=t.FullGunPopComp},function(t){c=t.EventManager},function(t){u=t.GameEvent},function(t){h=t.default}],execute:function(){var p;n._RF.push({},"ea375JqMchAx5ubMn444Jrv","FullGunPopEntity",void 0);var d=i.ccclass;i.property,t("FullGunPopEntity",d("FullGunPopEntity")(p=o.register("FullGunPopEntity",!1)(p=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this)},i.reset=function(){},i.onEnable=function(){},i.onDisable=function(){this.ent.destroy(!0)},i.confirm=function(){h.instance.createRewardedVideoAd({onClose:function(t){t.isEnded&&(c.instance.emit(u.FullGun,{gunBoxNum:20}),s.instance.player.getComponent(a).ent.remove(l,!0))}})},n}(r))||p)||p),n._RF.pop()}}})),System.register("chunks:///_virtual/FullGunPopSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./PoolManager.ts","./FullGunPopComp.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Camera,s=t.Vec3},function(t){a=t.ResEnum},function(t){l=t.GlobalSingle},function(t){c=t.default},function(t){u=t.FullGunPopComp},function(t){h=t.ecs}],execute:function(){var p;i._RF.push({},"2cc4cxDyj1I7INCV8wiSYaS","FullGunPopSys",void 0);var d=o.ccclass;t("FullGunPopSys",d("FullGunPopSys")(p=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._pos=new s,e}e(i,t);var o=i.prototype;return o.filter=function(){return h.allOf(u)},o.init=function(){},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value;this.spawnPop(o.get(u))}},o.firstUpdate=function(t){},o.entityRemove=function(t){},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value;o.get(u).fullPopNode&&(l.instance.camera3d.getComponent(r).convertToUINode(o.get(u).attachNode.worldPosition,o.get(u).fullPopNode.parent,this._pos),this._pos.y+=270,o.get(u).fullPopNode.setPosition(this._pos))}},o.spawnPop=function(t){c.instance.getItemSync(a.FullGunPop).then((function(e){t.fullPopNode=e,l.instance.canvas.node.addChild(e)}))},i}(h.ComblockSystem))||p),i._RF.pop()}}})),System.register("chunks:///_virtual/Game3dUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIView.ts","./Constant.ts","./GlobalSingle.ts","./EventManager.ts","./StorageData.ts","./Joystick.ts","./AudioManager.ts","./UMTrack.ts","./UMEvent.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Label,l=t.Node},function(t){c=t.UIView},function(t){u=t.GameEvent,h=t.GameState,p=t.Sounds},function(t){d=t.GlobalSingle},function(t){f=t.EventManager},function(t){g=t.StorageData},function(t){m=t.JoystickEvent,v=t.JoystickEventType},function(t){y=t.default},function(t){b=t.UMTrack},function(t){C=t.UMEvent}],execute:function(){var _,E,w,S,P,M,T,k,N,R,B,F,L,A,D,x,I,U,z,G,H,O,V;r._RF.push({},"2254brOC51PO4yvXBfTcuDt","Game3dUI",void 0);var j=s.ccclass,W=s.property;t("Game3dUI",(_=j("Game3dUI"),E=W(a),w=W(a),S=W(l),P=W(a),M=W(l),T=W(a),k=W(l),N=W(l),R=W(l),B=W(l),_((A=e((L=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"grayLabel",A,o(e)),i(e,"yellowLabel",D,o(e)),i(e,"PlaneBulletCountNode",x,o(e)),i(e,"planeBulletCountLabel",I,o(e)),i(e,"startBattle",U,o(e)),i(e,"levelLabel",z,o(e)),i(e,"NextLevelMask",G,o(e)),i(e,"GuideFinger",H,o(e)),i(e,"StartBtn",O,o(e)),i(e,"btnMoreGame",V,o(e)),e.isStaring=!1,e}n(e,t);var r=e.prototype;return r.onLoad=function(){},r.onEnable=function(){f.instance.on(u.TouchStartBtnEvent,this.touchStartBtnFun,this),f.instance.on(u.LevelEvent,this.levelEventFun,this),f.instance.on(u.BagChangeEvent,this.BagChangeEventFun,this),f.instance.on(u.PlaneDropBombEvent,this.PlaneDropBombEventFun,this),f.instance.on(u.GuideStep,this.GuideStepFun,this),m.on(v.TOUCH_END,this.onTouchEnd,this)},r.start=function(){this.init(),b.instance.onInitLevel(g.instance.teamLevel.toString(),"队伍等级"+g.instance.teamLevel),this.grayLabel.string=g.instance.grayNum.toString(),this.yellowLabel.string=g.instance.yellowNum.toString()},r.closeFinishUi=function(){},r.onDisable=function(){f.instance.off(u.TouchStartBtnEvent,this.touchStartBtnFun,this),f.instance.off(u.LevelEvent,this.levelEventFun,this),f.instance.off(u.BagChangeEvent,this.BagChangeEventFun,this),f.instance.off(u.PlaneDropBombEvent,this.PlaneDropBombEventFun,this),f.instance.off(u.GuideStep,this.GuideStepFun,this),m.off(v.TOUCH_END,this.onTouchEnd,this)},r.BagChangeEventFun=function(t,e){this.grayLabel.string=g.instance.grayNum.toString(),this.yellowLabel.string=g.instance.yellowNum.toString()},r.init=function(){this.levelLabel.string="关卡："+g.instance.level,this.GuideFingerFun()},r.onTouchEnd=function(){this.GuideFinger.active=!1},r.PlaneDropBombEventFun=function(t,e){e&&e>0?(this.PlaneBulletCountNode.active=!0,this.planeBulletCountLabel.node.active=!0,this.planeBulletCountLabel.string=e):(this.PlaneBulletCountNode.active=!1,this.planeBulletCountLabel.node.active=!1)},r.levelEventFun=function(){this.init()},r.touchStartBtnFun=function(t,e){g.instance.status==h.ready&&(this.startBattle.active=!!e)},r.startBattleFun=function(){y.instance.playSoundEffect(p.Charge),g.instance.status=h.battle,this.startBattle.active=!1,1==g.instance.level&&b.instance.trackEvent(C.Level_1_Charge),d.instance.battleCount++,b.instance.trackEvent(C.Game_Charge)},r.GuideFingerFun=function(){1==d.instance.tables.EnemyLevel[g.instance.level].Level2?this.StartBtn.active=!0:this.StartBtn.active=!1,this.GuideFinger.active=!1},r.GuideStepFun=function(){},r.StartBtnFun=function(){this.isStaring||(this.isStaring=!0,this.isStaring=!1,this.GuideFinger.active=!0,this.StartBtn.active=!1,d.instance.guideStep<0&&(d.instance.guideStep=0),b.instance.trackEvent(C.Level_1_Charge),b.instance.onStart(g.instance.level.toString(),"第"+g.instance.level+"关"))},e}(c)).prototype,"grayLabel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(L.prototype,"yellowLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(L.prototype,"PlaneBulletCountNode",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(L.prototype,"planeBulletCountLabel",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(L.prototype,"startBattle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(L.prototype,"levelLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(L.prototype,"NextLevelMask",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(L.prototype,"GuideFinger",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(L.prototype,"StartBtn",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(L.prototype,"btnMoreGame",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=L))||F)),r._RF.pop()}}})),System.register("chunks:///_virtual/GameAd.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FinishCustomAdMgr.ts","./JJMgr.ts","./Constant.ts","./GameUtil.ts","./GlobalSingle.ts","./StorageData.ts","./AdManager.ts","./EventManager.ts","./UIManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component},function(t){r=t.default},function(t){s=t.default},function(t){a=t.GameEvent,l=t.GameState,c=t.UIID,u=t.BadgeType},function(t){h=t.GameUtil},function(t){p=t.GlobalSingle},function(t){d=t.StorageData},function(t){f=t.default},function(t){g=t.EventManager},function(t){m=t.UIManager}],execute:function(){var v;n._RF.push({},"67b73unFg5K/KoZ+TpeeZfr","GameAd",void 0);var y=i.ccclass;i.property,t("GameAd",y("GameAd")(v=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).front_video_time=0,e.front_auto_jzge_time=0,e}e(n,t);var i=n.prototype;return i.onLoad=function(){f.instance.showHomeGridAd()},i.onEnable=function(){g.instance.on(a.GetBadge,this.GetBadgeFun,this),g.instance.on(a.StatusEvent,this.StatusEventFun,this),g.instance.on(a.UpgradeTeamLevelUIClose,this.UpgradeTeamLevelUICloseFun,this),g.instance.on(a.UpgradeComp_BadgeLack,this.UpgradeComp_BadgeLackFun,this),g.instance.on(a.AirDropEnable,this.AirDropEnableFun,this)},i.update=function(t){this.front_video_time+=1/60,this.front_auto_jzge_time+=1/60,this.front_auto_jzge_time>s.instance.dataConfig.front_auto_jzge_time&&(this.front_auto_jzge_time=0,r.instance.showGrid())},i.onDisable=function(){g.instance.off(a.GetBadge,this.GetBadgeFun,this),g.instance.off(a.StatusEvent,this.StatusEventFun,this),g.instance.off(a.UpgradeTeamLevelUIClose,this.UpgradeTeamLevelUICloseFun,this),g.instance.off(a.UpgradeComp_BadgeLack,this.UpgradeComp_BadgeLackFun,this),g.instance.off(a.AirDropEnable,this.AirDropEnableFun,this)},i.GetBadgeFun=function(){this.loopTime()},i.StatusEventFun=function(){d.instance.status==l.battle&&this.loopTime(),d.instance.status==l.ready&&d.instance.level>1&&p.instance.battleCount>=s.instance.dataConfig.front_attack_fail_count&&100*Math.random()<s.instance.dataConfig.front_attack_fail_chance&&(m.instance.open(c.NbombUi),p.instance.battleCount=0),d.instance.status==l.win&&(p.instance.battleCount=0)},i.loopTime=function(){this.front_video_time>s.instance.dataConfig.front_video_time&&(this.front_video_time=0,f.instance.createRewardedVideoAd())},i.UpgradeTeamLevelUICloseFun=function(){100*Math.random()<s.instance.dataConfig.front_upgrade_more_glod_chance&&m.instance.open(c.AwardUi)},i.UpgradeComp_BadgeLackFun=function(t,e){"TeamLevelUnloadNode"==e.unloadPosName&&100*Math.random()<s.instance.dataConfig.front_gold_lack_chance&&m.instance.open(c.BadgesUi,{badgeType:u.yellow,badgeNum:h.instance.getRandomFromServer()}),e.badgeType==u.gray&&100*Math.random()<s.instance.dataConfig.front_silver_lack_chance&&m.instance.open(c.BadgesUi,{badgeType:u.gray,badgeNum:20})},i.AirDropEnableFun=function(){m.instance.open(c.AirDropUi)},n}(o))||v),n._RF.pop()}}})),System.register("chunks:///_virtual/GameUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./JJMgr.ts","./GunComp.ts","./BadgeEntity.ts","./BadgeStackEntity.ts","./RoleEntity.ts","./PoolManager.ts","./Constant.ts","./GlobalSingle.ts","./Toast.ts","./StorageData.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator,r=t.assetManager,s=t.Component},function(t){a=t.default},function(t){l=t.GunComp},function(t){c=t.BadgeEntity},function(t){u=t.BadgeStackEntity},function(t){h=t.RoleEntity},function(t){p=t.default},function(t){d=t.ResEnum},function(t){f=t.GlobalSingle},function(t){g=t.Toast},function(t){m=t.StorageData}],execute:function(){var v,y;i._RF.push({},"fa008z9WFRO3ZEYigI1MvmJ","GameUtil",void 0);var b=o.ccclass;o.property,t("GameUtil",b("GameUtil")(((y=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).badgeAwardNum=[10,15,20],e}e(i,t);var o=i.prototype;return o.awardBadgeStack=function(t,e){p.instance.getItemSync(d.BadgeStack).then((function(n){n.getComponent(u).initStack(t,e),n.parent=f.instance.map,n.setWorldPosition(f.instance.player.worldPosition)}))},o.spawnOneBadge=function(t){return new Promise((function(e,n){p.instance.getItemSync(d.Badge).then((function(n){var i=n.getComponent(c);i.badgeType=t,n.parent=f.instance.map,i.initBadge(n),n.setWorldPosition(f.instance.player.getWorldPosition()),e(n)}))}))},o.storeSoldiers=function(){for(var t=[],e=0;e<f.instance.soldierEntities.length;e++)f.instance.soldierEntities[e].get(h).isPlayer||t.push({roleId:f.instance.soldierEntities[e].get(h).roleId,weaponID:f.instance.soldierEntities[e].get(l).weaponID});m.instance.soldiers=t},o.getRandomFromServer=function(t){return void 0===t&&(t=""),this.badgeAwardNum="AwardUi"==t?a.instance.dataConfig.front_more_reward_gold_list:a.instance.dataConfig.front_reward_mp_list,this.badgeAwardNum[Math.floor(Math.random()*this.badgeAwardNum.length)]},o.showToast=function(t){p.instance.getItemSync(d.Toast).then((function(e){e.parent=f.instance.canvas.node,e.getComponent(g).setData(t)}))},o.getBundle=function(t){return new Promise((function(e,n){r.getBundle(t)?e(r.getBundle(t)):r.loadBundle(t,(function(n){e(r.getBundle(t))}))}))},n(i,null,[{key:"instance",get:function(){return null===i._instance&&(i._instance=new i),i._instance},set:function(t){i._instance=t}}]),i}(s))._instance=null,v=y))||v),i._RF.pop()}}})),System.register("chunks:///_virtual/gizmo.ts",["./rollupPluginModLoBabelHelpers.js","cc","./utils.ts"],(function(t){var e,n;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy},null],execute:function(){n._RF.push({},"ec920DofWZHA6zPB49x/+7d","gizmo",void 0),t("default",function(){n.register=function(t,e){};var t=n.prototype;function n(t){this._showTransformGizmo=!0,cc.js.addon(this,new window.cce.gizmos.Gizmo(t))}return t.getGizmoRoot=function(){return window.cce.gizmos.Gizmo.prototype.getGizmoRoot.call(this)},t.recordChanges=function(){return window.cce.gizmos.Gizmo.prototype.recordChanges.call(this)},t.commitChanges=function(){return window.cce.gizmos.Gizmo.prototype.commitChanges.call(this)},t.onComponentChanged=function(t){return window.cce.gizmos.Gizmo.prototype.onComponentChanged.call(this,t)},t.registerCameraMovedEvent=function(){return window.cce.gizmos.Gizmo.prototype.registerCameraMovedEvent.call(this)},t.unregisterCameraMoveEvent=function(){return window.cce.gizmos.Gizmo.prototype.unregisterCameraMoveEvent.call(this)},t.layer=function(){return"foreground"},t.updateController=function(){this.updateControllerData(),this.updateControllerTransform()},t.updateControllerData=function(){},t.updateControllerTransform=function(){},t.onTargetUpdate=function(){this.updateController()},t.onNodeChanged=function(){this.updateController()},t.showTransformGizmo=function(t){this._showTransformGizmo=t},t.getTransformGizmoNode=function(){var t=window.cce.gizmos.transformTool;return t&&t.node},t.show=function(){window.cce.gizmos.Gizmo.prototype.show.call(this)},t.onUpdate=function(){this._showTransformGizmo?window.cce.gizmos.transformTool.show():window.cce.gizmos.transformTool.hide()},t.commitNodeChanged=function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(e=cce.gizmos.Utils).onNodeChanged.apply(e,[t].concat(i))},e(n,[{key:"target",get:function(){return this._target},set:function(t){var e=this.nodes;e&&e.length,this._target=t,(e=this.nodes)&&e.length>0?this.onTargetUpdate&&this.onTargetUpdate():this.hide()}}]),n}()),CC_EDITOR,n._RF.pop()}}})),System.register("chunks:///_virtual/GlobalSingle.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./Constant.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.EventManager},function(t){r=t.GameEvent}],execute:function(){var s,a;n._RF.push({},"9e968CFAc1EdoJuRtFXujPK","GlobalSingle",void 0);var l=i.ccclass;i.property,t("GlobalSingle",l("GlobalSingle")(((a=function(){function t(){this.canvas=void 0,this.camera2d=void 0,this.game3d=void 0,this.camera3d=void 0,this.navMeshMgr=null,this.navMeshCrowd=null,this.mapNode=void 0,this.map=void 0,this.player=void 0,this.playerMoveSpeed=7,this.playerBorthWorldPos=void 0,this.clips=null,this._tables={},this.enemyEntities=[],this.enemyTotalCount=0,this.soldierEntities=[],this._guideStep=-1,this._houseMaxLevel=0,this._vehicleType=null,this.joystickMoving=!1,this.battleCount=0,this.levelAwardYellowNum=0}return e(t,[{key:"tables",get:function(){return this._tables,this._tables},set:function(t){this._tables=t}},{key:"guideStep",get:function(){return this._guideStep},set:function(t){this._guideStep=t,o.instance.emit(r.GuideStep,this._guideStep)}},{key:"houseMaxLevel",get:function(){return this._houseMaxLevel},set:function(t){this._houseMaxLevel=t,o.instance.emit(r.HouseMaxLevel,t)}},{key:"vehicleType",get:function(){return this._vehicleType},set:function(t){this._vehicleType=t,null==this._vehicleType&&o.instance.emit(r.VehicleDestroy)}}],[{key:"instance",get:function(){return null===t._instance&&(t._instance=new t),t._instance},set:function(e){t._instance=e}}]),t}())._instance=null,s=a))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/GroundCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component}],execute:function(){var r;n._RF.push({},"6a2c1OhnHdE4ovJRlSug7Ag","GroundCtrl",void 0);var s=i.ccclass;i.property,t("GroundCtrl",s("GroundCtrl")(r=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.start=function(){},i.update=function(t){},n}(o))||r),n._RF.pop()}}})),System.register("chunks:///_virtual/GroundEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./GlobalSingle.ts","./StorageData.ts","./EventManager.ts","./Constant.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.Texture2D,c=t.MeshRenderer,u=t.Color},function(t){h=t.ecs},function(t){p=t.CCComp},function(t){d=t.GlobalSingle},function(t){f=t.StorageData},function(t){g=t.EventManager},function(t){m=t.GameEvent}],execute:function(){var v,y,b,C,_,E,w,S,P,M,T,k;r._RF.push({},"f543clqV4NEdIR93CucebHz","GroundEntity",void 0);var N=s.ccclass,R=s.property;t("GroundEntity",(v=N("GroundEntity"),y=h.register("GroundEntity",!1),b=R(a),C=R(a),_=R(l),E=R(a),v(w=y((P=e((S=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"groundNode",P,o(e)),i(e,"Water",M,o(e)),i(e,"groundTextures",T,o(e)),i(e,"water_surface",k,o(e)),e.groundColors=["88db8d","e6e190","9da5e3","d2d7d1","7ed5cd","88db8d","e6e190","9da5e3"],e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){},r.onEnable=function(){g.instance.on(m.LevelEvent,this.levelEventFun,this),g.instance.on(m.NbombBmob,this.NbombBmobFun,this),this.setGround()},r.onDisable=function(){g.instance.off(m.LevelEvent,this.levelEventFun,this),g.instance.off(m.NbombBmob,this.NbombBmobFun,this)},r.levelEventFun=function(){this.setGround()},r.setGround=function(){var t=d.instance.tables.EnemyLevel[f.instance.level];this.groundNode.getComponent(c).material.setProperty("mainTexture",this.groundTextures[t.Level1-1]);var e=new u,n=t.Level1-1;n>this.groundColors.length-1&&(n=this.groundColors.length-1),e.fromHEX(this.groundColors[n]),this.water_surface.getComponent(c).material.setProperty("mainColor",e)},r.NbombBmobFun=function(){var t=this;this.Water.active=!1,this.scheduleOnce((function(){t.Water.active=!0}),3)},e}(p)).prototype,"groundNode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(S.prototype,"Water",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(S.prototype,"groundTextures",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=e(S.prototype,"water_surface",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=S))||w)||w)),r._RF.pop()}}})),System.register("chunks:///_virtual/GuideSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./EventManager.ts","./ArrowComp.ts","./ArrowEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Camera,s=t.Vec3,a=t.v3,l=t.Quat,c=t.MeshRenderer,u=t.Vec4},function(t){h=t.GameEvent},function(t){p=t.GlobalSingle},function(t){d=t.EventManager},function(t){f=t.ArrowComp},function(t){g=t.ArrowEntity},function(t){m=t.ecs}],execute:function(){var v;i._RF.push({},"633aafxUSxB1oRKuuqvO/Bu","GuideSys",void 0);var y=o.ccclass;t("GuideSys",y("GuideSys")(v=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._uiDesPos=new s,e._uiPlayerPos=new s,e._distance=0,e._dir=new s,e._quat=new l,e._centerPos=new s,e.progressArrow=0,e}e(i,t);var o=i.prototype;return o.filter=function(){return m.allOf(f)},o.init=function(){d.instance.on(h.LevelEvent,this.levelEventFun,this)},o.entityEnter=function(t){},o.firstUpdate=function(t){},o.entityRemove=function(t){},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value,h=o.get(f);if(h.target&&p.instance.player){if(h.ArrowNode){o.get(f);var d=o.get(f).ArrowNode.getComponent(g);p.instance.camera3d.getComponent(r).convertToUINode(p.instance.player.worldPosition,d.node,this._uiPlayerPos),this._uiPlayerPos.y+=230,d.ArrowIcon.setPosition(this._uiPlayerPos)}h.Arrow3dNode&&(this._distance=s.distance(h.target.worldPosition,p.instance.player.worldPosition),this._centerPos=a((h.target.worldPosition.x+p.instance.player.worldPosition.x)/2,.1,(h.target.worldPosition.z+p.instance.player.worldPosition.z)/2),s.subtract(this._dir,h.target.worldPosition,p.instance.player.worldPosition),this._dir.normalize(),l.fromViewUp(this._quat,this._dir,s.UP),h.Arrow3dNode.setRotation(this._quat),h.Arrow3dNode.setWorldPosition(this._centerPos),h.Arrow3dNode.setWorldScale(a(1,.01,this._distance)),h.Arrow3dIcon&&(this.progressArrow+=1/30,this.progressArrow>1&&(this.progressArrow=0),h.Arrow3dIcon.getComponent(c).material.setProperty("tilingOffset",new u(1,this._distance,0,this.progressArrow))))}}},o.levelEventFun=function(){for(var t=m.query(m.allOf(f)),e=0;e<t.length;e++)t[e].destroy(!0);p.instance.guideStep=0},i}(m.ComblockSystem))||v),i._RF.pop()}}})),System.register("chunks:///_virtual/GunComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./PoolManager.ts","./RoleEntity.ts","./ECS.ts","./RoleAnimComp.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator},function(t){r=t.ResEnum},function(t){s=t.GlobalSingle},function(t){a=t.default},function(t){l=t.RoleEntity},function(t){c=t.ecs},function(t){u=t.RoleAnimComp}],execute:function(){var h;i._RF.push({},"13202begCtJTZLSljE75LKZ","GunComp",void 0);var p=o.ccclass;o.property,t("GunComp",p("GunComp")(h=c.register("GunComp")(h=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).gunNode=null,e.gunPoint=null,e.shootRadius=10,e.CD=3.2,e.HitRate=1,e.Rate=1,e.BulletID=void 0,e._attachNode=null,e._gunSkin=null,e.weaponID=void 0,e}e(i,t);var o=i.prototype;return o.reset=function(){a.instance.putItem(r.gunPath+"/"+this.gunSkin,this.gunNode),this.gunNode=null,this.gunPoint=null,this.attachNode=null,this.gunSkin=null},o.setGunTableData=function(t){this.weaponID=t;var e=s.instance.tables.Weapon[t];e?(this.ent.get(u).skeletalAnimation?this.gunPoint=this.ent.get(l).node:this.gunPoint=this.ent.get(l).animNode.getChildByName("gunPoint"),e.Prefab&&(this.gunSkin=e.Prefab),this.shootRadius=e.Range,this.CD=e.CD,this.HitRate=e.HitRate,this.Rate=e.Rate,this.BulletID=e.BulletID):console.warn("枪支配表数据不存在："+t)},o.switchGunSkin=function(){var t=this;this.ent.get(l).gunSocket&&this.gunSkin&&a.instance.getItemSync(r.gunPath+"/"+this.gunSkin).then((function(e){t.gunNode=e,t.gunPoint=e.getChildByName("gunPoint"),t.attachNode=t.ent.get(l).gunSocket}))},n(i,[{key:"attachNode",get:function(){return this._attachNode},set:function(t){this._attachNode=t,this.attachNode&&(this.gunNode.parent=this.attachNode)}},{key:"gunSkin",get:function(){return this._gunSkin},set:function(t){this._gunSkin=t,this._gunSkin&&this.switchGunSkin()}}]),i}(c.Comp))||h)||h),i._RF.pop()}}})),System.register("chunks:///_virtual/GunFactoryComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"46e235aXW9NCqMwaVUWbI86","GunFactoryComp",void 0);var s=i.ccclass;i.property,t("GunFactoryComp",s("GunFactoryComp")(r=o.register("GunFactoryComp")(r=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).delTime=3,e.spawnFunInt=void 0,e}return e(n,t),n.prototype.reset=function(){console.log("组件被回收时会调用这个接口。可以在这里重置数据，或者解除引用。")},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/GunFactoryCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.BaseCtrl}],execute:function(){var s;n._RF.push({},"1172bUAc0JMoKuVEPs2BWzt","GunFactoryCtrl",void 0);var a=i.ccclass;i.property,t("GunFactoryCtrl",a("GunFactoryCtrl")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.GunFactory,this.init("GunFactory")},i.onDisable=function(){t.prototype.onDisable.call(this)},i.update=function(t){},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/GunFactoryEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./GunFactoryComp.ts","./UpgradeComp.ts","./Constant.ts","./GunFactoryUpgradeEntity.ts","./GlobalSingle.ts","./StorageData.ts","./EventManager.ts","./PoolManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M,T;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Label,l=t.Node,c=t.Quat,u=t.NodePool,h=t.BoxCollider,p=t.Tween,d=t.instantiate,f=t.MeshRenderer,g=t.v3},function(t){m=t.ecs},function(t){v=t.CCComp},function(t){y=t.GunFactoryComp},function(t){b=t.UpgradeComp},function(t){C=t.ResEnum,_=t.BadgeType,E=t.GameEvent},function(t){w=t.GunFactoryUpgradeEntity},function(t){S=t.GlobalSingle},function(t){P=t.StorageData},function(t){M=t.EventManager},function(t){T=t.default}],execute:function(){var k,N,R,B,F,L,A,D,x,I,U,z,G,H,O,V,j,W,Q,J,X,q,Y,Z;r._RF.push({},"76f6dHWCW9OPIDqcrQN5s+x","GunFactoryEntity",void 0);var K=s.ccclass,$=s.property;t("GunFactoryEntity",(k=K("GunFactoryEntity"),N=m.register("GunFactoryEntity",!1),R=$(a),B=$(l),F=$(l),L=$(l),A=$(l),D=$(l),x=$(l),I=$(l),U=$(l),z=$(l),k(G=N((O=e((H=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"labelNum",O,o(e)),i(e,"labelNumQuad",V,o(e)),i(e,"badges",j,o(e)),i(e,"factory",W,o(e)),i(e,"Press_Head_1",Q,o(e)),i(e,"gunPlace",J,o(e)),i(e,"GunBox",X,o(e)),i(e,"startPos",q,o(e)),i(e,"getGunPoint",Y,o(e)),i(e,"gunFactoryUpgrade",Z,o(e)),e.rigidbody=void 0,e.collider=void 0,e.spawnFun=void 0,e.quat=new c,e.gunBoxPool=new u,e.buildingData=void 0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){this.unschedule(this.spawnFun),T.instance.putItem(C.GunFactory,this.node,!0)},r.init=function(){this.buildingData=S.instance.tables.Building.GunFactory,this.ent.get(b).setData(this.labelNum,this.labelNumQuad,null,this.badges,this.getComponent(h),"asc",_.gray,!1,0,this.buildingData.UpperLimit),this.ent.get(b).unloading=!0,this.refreshGunFactoryUpgrade()},r.onEnable=function(){this.ent.add(b),this.ent.add(y),M.instance.on(E.LevelEvent,this.LevelEventFun,this),M.instance.on(E.FullGun,this.FullGunFun,this),this.init()},r.onDisable=function(){M.instance.off(E.LevelEvent,this.LevelEventFun,this),M.instance.off(E.FullGun,this.FullGunFun,this),p.stopAllByTarget(this.Press_Head_1),this.ent&&this.ent.destroy(!0)},r.LevelEventFun=function(){this.refreshGunFactoryUpgrade()},r.refreshGunFactoryUpgrade=function(){P.instance.level>=S.instance.tables.Building[this.buildingData.UpgradeID].Level&&(this.gunFactoryUpgrade.active=!0)},r.getFromPool=function(){var t=null;t=this.gunBoxPool.size()>0?this.gunBoxPool.get():d(this.GunBox);var e=this.gunFactoryUpgrade.getComponent(w).getGunBoxTexture();return t.name=e.gunID,t.getComponent(f).material.setProperty("mainTexture",e.texture),t},r.putPool=function(t){t&&t.isValid&&(t.removeFromParent(),t.parent=null,this.gunBoxPool.put(t))},r.getGunByGunBox=function(){if(this.gunPlace.children.length>0){var t=this.gunPlace.children[this.gunPlace.children.length-1];return this.putPool(t),t.name}return null},r.FullGunFun=function(t,e){for(var n=0;n<e.gunBoxNum;n++)this.spawnOneGunBox()},r.spawnOneGunBox=function(){var t=this.getFromPool();t.parent=this.gunPlace,t.active=!0;var e=Math.floor(this.gunPlace.children.length/16),n=Math.floor(this.gunPlace.children.length%16/4),i=g(this.gunPlace.children.length%4*1,.45*e,.65*n);t.setPosition(i),c.fromEuler(this.quat,0,180,0),t.setRotation(this.quat)},e}(v)).prototype,"labelNum",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(H.prototype,"labelNumQuad",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(H.prototype,"badges",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(H.prototype,"factory",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(H.prototype,"Press_Head_1",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(H.prototype,"gunPlace",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(H.prototype,"GunBox",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(H.prototype,"startPos",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(H.prototype,"getGunPoint",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(H.prototype,"gunFactoryUpgrade",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=H))||G)||G)),r._RF.pop()}}})),System.register("chunks:///_virtual/GunFactorySys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./AudioManager.ts","./GunFactoryComp.ts","./UpgradeComp.ts","./BadgeEntity.ts","./GunFactoryEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.tween,s=t.v3,a=t.Vec3,l=t.Quat},function(t){c=t.Sounds},function(t){u=t.default},function(t){h=t.GunFactoryComp},function(t){p=t.UpgradeComp},function(t){d=t.BadgeEntity},function(t){f=t.GunFactoryEntity},function(t){g=t.ecs}],execute:function(){var m;i._RF.push({},"7481a3gBTRDBJzTo048xwDw","GunFactorySys",void 0);var v=o.ccclass;t("GunFactorySys",v("GunFactorySys")(m=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).quat=new l,e}e(i,t);var o=i.prototype;return o.filter=function(){return g.allOf(h)},o.init=function(){},o.entityEnter=function(t){for(var e,i=this,o=function(){var t=e.value,n=t.get(f),o=t.get(h);n.spawnFun=function(){i.spawnOneGunBox(n,o,t.get(p))},n.schedule(n.spawnFun,o.delTime)},r=n(t);!(e=r()).done;)o()},o.firstUpdate=function(t){},o.entityRemove=function(t){},o.update=function(t){},o.spawnOneGunBox=function(t,e,n){var i=this;if(n.currentBadge>0){var o=t.Press_Head_1.getPosition();o.y=5.3,r(t.Press_Head_1).to(.5,{position:o}).call((function(){var e=t.badges.children[t.badges.children.length-1];if(e){var h=e.getWorldPosition();n.currentBadge--,e.parent=t.node,e.setWorldPosition(h),r(e).to(.3,{worldPosition:t.startPos.worldPosition}).call((function(){var n=t.Press_Head_1.getPosition();n.y=3.8,r(t.Press_Head_1).to(.3,{position:n}).call((function(){if(e.getComponent(d).ent){e.getComponent(d).ent.destroy(!0),u.instance.playSoundEffect(c.FactoryIdle);var n=t.getFromPool();n.active=!0,n.parent=t.factory,n.setWorldPosition(t.startPos.worldPosition);var o=s(1,1.27,0),h=a.distance(n.position,o),p=s(1,0,-2.1),f=a.distance(p,o);r(n).to(h,{position:o}).to(f,{position:p}).call((function(){var e=Math.floor(t.gunPlace.children.length/16),o=Math.floor(t.gunPlace.children.length%16/4),a=s(t.gunPlace.children.length%4*1,.45*e,.65*o),c=n.worldPosition;n.parent=t.gunPlace,n.setWorldPosition(c),l.fromEuler(i.quat,0,180,0),n.setRotation(i.quat),r(n).to(1,{position:a}).start()})).start()}})).to(.8,{position:o}).start()})).start()}})).start()}},i}(g.ComblockSystem))||m),i._RF.pop()}}})),System.register("chunks:///_virtual/GunFactoryUpgradeEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./UpgradeComp.ts","./Constant.ts","./GlobalSingle.ts","./GunFactoryEntity.ts","./Util.ts","./EventManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.Label,c=t.Texture2D,u=t.BoxCollider,h=t.MeshRenderer},function(t){p=t.ecs},function(t){d=t.CCComp},function(t){f=t.UpgradeComp},function(t){g=t.GameEvent,m=t.BadgeType},function(t){v=t.GlobalSingle},function(t){y=t.GunFactoryEntity},function(t){b=t.Util},function(t){C=t.EventManager}],execute:function(){var _,E,w,S,P,M,T,k,N,R,B,F,L,A,D,x,I,U,z,G,H,O,V,j,W,Q,J,X,q,Y;t("GunID",void 0),r._RF.push({},"a338fG0m3FKmpAHzVbIdioj","GunFactoryUpgradeEntity",void 0);var Z,K=s.ccclass,$=s.property;!function(t){t.Ak_47="Ak_47_GunFactory",t.S686="S686_GunFactory"}(Z||(Z=t("GunID",{}))),t("GunFactoryUpgradeEntity",(_=K("GunFactoryUpgradeEntity"),E=p.register("GunFactoryUpgradeEntity",!1),w=$(a),S=$(l),P=$(a),M=$(a),T=$(a),k=$(a),N=$({type:a,tooltip:"解锁条件节点"}),R=$({type:a,tooltip:"解锁条件icon"}),B=$(a),F=$(a),L=$(c),A=$(c),D=$(c),_(x=E((U=e((I=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"GunFactory",U,o(e)),i(e,"labelNum",z,o(e)),i(e,"labelNumQuad",G,o(e)),i(e,"progressNode",H,o(e)),i(e,"unloadPos",O,o(e)),i(e,"RootNode",V,o(e)),i(e,"MaskNode",j,o(e)),i(e,"MaskIcon",W,o(e)),e.buildingData=void 0,i(e,"gunIcon",Q,o(e)),i(e,"gunName",J,o(e)),i(e,"gunIconTextures",X,o(e)),i(e,"gunNameTextures",q,o(e)),i(e,"gunBoxTextures",Y,o(e)),e.gunID=Z.Ak_47,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){},r.onEnable=function(){var t=this;this.ent.has(f)||this.ent.add(f),C.instance.on(g.TeamLevelEvent,this.teamLevelChange,this),this.buildingData=v.instance.tables.Building.GunFactory,b.instance.isEmptyStr(this.buildingData.UpgradeID)||(this.buildingData=v.instance.tables.Building[this.buildingData.UpgradeID]),this.setData(Z.Ak_47),this.ent.get(f).setData(this.labelNum,this.labelNumQuad,this.progressNode,this.unloadPos,this.getComponent(u),"desc",m.gray,!0,this.buildingData.Silver,this.buildingData.Silver),this.ent.get(f).complete=function(){t.ent.get(f).unloading=!1,t.setData(Z.S686),t.GunFactory.getComponent(y).ent.get(f).maxBadge=t.buildingData.UpperLimit,t.node.active=!1},this.ent.get(f).setLimitMask(this.buildingData.Requirement,this.RootNode,this.MaskNode,this.MaskIcon)},r.onDisable=function(){C.instance.off(g.TeamLevelEvent,this.teamLevelChange,this)},r.setData=function(t){this.gunID=t,this.gunID==Z.Ak_47?(this.gunIcon.getComponent(h).material.setProperty("mainTexture",this.gunIconTextures[0]),this.gunName.getComponent(h).material.setProperty("mainTexture",this.gunNameTextures[0])):(this.gunIcon.getComponent(h).material.setProperty("mainTexture",this.gunIconTextures[1]),this.gunName.getComponent(h).material.setProperty("mainTexture",this.gunNameTextures[1]))},r.teamLevelChange=function(){this.ent.get(f).setLimitMask(this.buildingData.Requirement,this.RootNode,this.MaskNode,this.MaskIcon)},r.getGunBoxTexture=function(){return this.gunID==Z.Ak_47?{gunID:Z.Ak_47,texture:this.gunBoxTextures[0]}:{gunID:Z.S686,texture:this.gunBoxTextures[1]}},e}(d)).prototype,"GunFactory",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(I.prototype,"labelNum",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(I.prototype,"labelNumQuad",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(I.prototype,"progressNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(I.prototype,"unloadPos",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(I.prototype,"RootNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(I.prototype,"MaskNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(I.prototype,"MaskIcon",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(I.prototype,"gunIcon",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(I.prototype,"gunName",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(I.prototype,"gunIconTextures",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),q=e(I.prototype,"gunNameTextures",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Y=e(I.prototype,"gunBoxTextures",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=I))||x)||x)),r._RF.pop()}}})),System.register("chunks:///_virtual/GunPlacePart.ts",["./rollupPluginModLoBabelHelpers.js","cc","./JJMgr.ts","./FullGunPopComp.ts","./RoleEntity.ts","./GlobalSingle.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Collider,l=t.Component},function(t){c=t.default},function(t){u=t.FullGunPopComp},function(t){h=t.RoleEntity},function(t){p=t.GlobalSingle}],execute:function(){var d,f,g,m,v;r._RF.push({},"6c6a1LSeUVLObz1m1yVSJYJ","GunPlacePart",void 0);var y=s.ccclass,b=s.property;t("GunPlacePart",(d=y("GunPlacePart"),f=b(a),d((v=e((m=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"collider",v,o(e)),e}n(e,t);var r=e.prototype;return r.onEnable=function(){this.collider.on("onTriggerEnter",this.onTriggerEnter,this),this.collider.on("onTriggerExit",this.onTriggerExit,this)},r.update=function(t){},r.onDisable=function(){this.collider.off("onTriggerStay",this.onTriggerEnter,this),this.collider.off("onTriggerExit",this.onTriggerExit,this)},r.onTriggerEnter=function(t){var e=t.otherCollider.node.getComponent(h);e&&e.isPlayer&&!p.instance.player.getComponent(h).ent.has(u)&&100*Math.random()<c.instance.dataConfig.front_vi_fc_chance&&(p.instance.player.getComponent(h).ent.add(u).attachNode=this.node)},r.onTriggerExit=function(t){p.instance.player.getComponent(h).ent.has(u)&&p.instance.player.getComponent(h).ent.remove(u,!0)},e}(l)).prototype,"collider",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=m))||g)),r._RF.pop()}}})),System.register("chunks:///_virtual/GunSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./StorageData.ts","./GunComp.ts","./NavToComp.ts","./RoleAnimComp.ts","./RoleComp.ts","./ShootComp.ts","./SoldierComp.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator},function(t){r=t.GameState},function(t){s=t.StorageData},function(t){a=t.GunComp},function(t){l=t.NavToComp},function(t){c=t.RoleAnimComp},function(t){u=t.RoleComp},function(t){h=t.ShootComp},function(t){p=t.SoldierComp},function(t){d=t.RoleEntity},function(t){f=t.ecs}],execute:function(){var g;i._RF.push({},"aee5bllXnZDMKORu889kMJh","GunSys",void 0);var m=o.ccclass;t("GunSys",m("GunSys")(g=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._desPos=void 0,e}e(i,t);var o=i.prototype;return o.filter=function(){return f.allOf(u,a)},o.entityEnter=function(t){},o.firstUpdate=function(t){},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value,f=o.get(d),g=o.get(u),m=o.get(c);if(g.currentHp>0&&g.opponentDistance){var v=o.get(a);if(g.opponentDistance<v.shootRadius-1)o.has(l)&&(o.remove(l),m.idle()),o.has(h)||o.add(h);else if(o.has(p)){if(g.lastNavTime+=1/60,g.lastNavTime>2&&(o.has(h)&&(o.remove(h),f.isPlayer||m.idle()),s.instance.status==r.battle&&!f.isPlayer&&o.has(p)&&!o.has(l))){var y=o.add(l);y.needNavNode=f.node,this._desPos=g.opponentEntity.get(d).node.getWorldPosition(),this._desPos.y=f.node.worldPosition.y,y.destPos={worldPos:this._desPos,target:g.opponentEntity.get(d).node},g.lastNavTime=0}}else o.has(h)&&(o.remove(h),m.idle())}else o.has(h)&&o.remove(h)}},i}(f.ComblockSystem))||g),i._RF.pop()}}})),System.register("chunks:///_virtual/HouseComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./EventManager.ts","./HouseEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator,r=t.v3},function(t){s=t.HouseType,a=t.GameEvent},function(t){l=t.GlobalSingle},function(t){c=t.StorageData},function(t){u=t.EventManager},function(t){h=t.HouseEntity},function(t){p=t.ecs}],execute:function(){var d;i._RF.push({},"2f463cJ8/ROsLFAsg5CX2E5","HouseComp",void 0);var f=o.ccclass;o.property,t("HouseComp",f("HouseComp")(d=p.register("HouseComp")(d=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).houseType=s.soldier,e._houseLevel=0,e.spawnDeltaTime=.1,e.lastBorthTime=(new Date).getTime(),e._houseName=void 0,e}e(i,t);var o=i.prototype;return o.reset=function(){this.houseLevel=0,this.lastBorthTime=0},o.setHouse=function(){var t=this.ent.get(h),e=t.upgradeArea.getPosition();if(0==this.houseLevel?e.z=0:e.z=4,t.upgradeArea.setPosition(e),this.houseType==s.soldier)for(var n=0;n<t.soldierNodeArry.length;n++)n==this.houseLevel-1?t.soldierNodeArry[n].active=!0:t.soldierNodeArry[n].active=!1;else this.houseLevel>0?t.tankerNodeArry[0].active=!0:t.tankerNodeArry[0].active=!1;this.houseLevel>0?(t.NameQuad.active=!1,t.NameQuad2.active=!1,t.MaskIcon.setPosition(r(0,0,.1))):(t.NameQuad.active=!0,t.NameQuad2.active=!0)},n(i,[{key:"houseLevel",get:function(){return this._houseLevel},set:function(t){this._houseLevel=t,this._houseLevel>l.instance.houseMaxLevel&&(l.instance.houseMaxLevel=this._houseLevel),c.instance.house[this.houseName]=this.houseLevel,c.instance.house[this.houseName+"_currentBadge"]=null,c.instance.house=c.instance.house,u.instance.emit(a.HouseLevelEvent,{houseType:this.houseType}),this.ent&&this.setHouse()}},{key:"houseName",get:function(){return this._houseName},set:function(t){this._houseName=t}}]),i}(p.Comp))||d)||d),i._RF.pop()}}})),System.register("chunks:///_virtual/HouseCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UMTrack.ts","./ArrowComp.ts","./HouseComp.ts","./HouseEntity.ts","./EventManager.ts","./PoolManager.ts","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./UMEvent.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator},function(t){a=t.UMTrack},function(t){l=t.ArrowComp},function(t){c=t.HouseComp},function(t){u=t.HouseEntity},function(t){h=t.EventManager},function(t){p=t.default},function(t){d=t.GameEvent,f=t.ResEnum},function(t){g=t.GlobalSingle},function(t){m=t.StorageData},function(t){v=t.UMEvent},function(t){y=t.BaseCtrl}],execute:function(){var b,C,_;r._RF.push({},"428bePYIShNYb+SRbFn/OLv","HouseCtrl",void 0);var E=s.ccclass,w=s.property;t("HouseCtrl",E("HouseCtrl")((_=e((C=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"houseName",_,o(e)),e.myNode=null,e}n(e,t);var r=e.prototype;return r.onEnable=function(){t.prototype.onEnable.call(this),h.instance.on(d.GrayNumEvent,this.GrayNumEventFun,this),this.buildingData=g.instance.tables.Building[this.houseName],this.setUnlock()},r.onDisable=function(){t.prototype.onDisable.call(this),h.instance.off(d.GrayNumEvent,this.GrayNumEventFun,this)},r.setUnlock=function(){!this.isUnlocked&&this.buildingData&&m.instance.level>=this.buildingData.Level&&this.showPrefab()},r.showPrefab=function(){var t=this;this.isUnlocked=!0,p.instance.getItemSync(f.House).then((function(e){e.parent=t.node,e.getComponent(u).initHouse(t.houseName,t.buildingData),e.getComponent(u).ent.get(c).houseLevel=m.instance.house[t.houseName],t.myNode=e,t.addGuide()}))},r.GrayNumEventFun=function(t,e){1==m.instance.level&&g.instance.guideStep<2&&g.instance.houseMaxLevel<=0&&e>=10&&"House1"==this.houseName&&this.myNode&&(a.instance.trackEvent(v.Level_1_BuildingHouse),g.instance.guideStep=2,this.myNode.getComponent(u).ent.has(l)||this.myNode.getComponent(u).ent.add(l).init(this.node)),this.addGuide()},r.addGuide=function(){m.instance.level>1&&m.instance.grayNum>0&&"House1"==this.houseName&&this.myNode&&this.myNode.getComponent(u).ent.get(c).houseLevel<=0&&!this.myNode.getComponent(u).ent.has(l)&&(g.instance.guideStep=2,this.myNode.getComponent(u).ent.has(l)||this.myNode.getComponent(u).ent.add(l).init(this.node))},e}(y)).prototype,"houseName",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),b=C))||b),r._RF.pop()}}})),System.register("chunks:///_virtual/HouseEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./HouseComp.ts","./UpgradeComp.ts","./Constant.ts","./StorageData.ts","./Util.ts","./EventManager.ts","./GlobalSingle.ts","./AudioManager.ts","./ArrowComp.ts","./PoolManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.Label,c=t.BoxCollider},function(t){u=t.ecs},function(t){h=t.CCComp},function(t){p=t.HouseComp},function(t){d=t.UpgradeComp},function(t){f=t.ResEnum,g=t.GameEvent,m=t.Sounds,v=t.HouseType,y=t.BadgeType},function(t){b=t.StorageData},function(t){C=t.Util},function(t){_=t.EventManager},function(t){E=t.GlobalSingle},function(t){w=t.default},function(t){S=t.ArrowComp},function(t){P=t.default}],execute:function(){var M,T,k,N,R,B,F,L,A,D,x,I,U,z,G,H,O,V,j,W,Q,J,X,q,Y,Z,K,$,tt,et,nt,it;r._RF.push({},"54408Cc/npA0bazZBp57Wve","HouseEntity",void 0);var ot=s.ccclass,rt=s.property;t("HouseEntity",(M=ot("HouseEntity"),T=u.register("HouseEntity",!1),k=rt([a]),N=rt([a]),R=rt({type:a,tooltip:"房子"}),B=rt({type:a,tooltip:"生产位置"}),F=rt({type:a,tooltip:"投币区域"}),L=rt({type:a}),A=rt({type:a,tooltip:"解锁条件节点"}),D=rt({type:a,tooltip:"解锁条件icon"}),x=rt(l),I=rt(a),U=rt(a),z=rt(a),G=rt(a),H=rt(a),M(O=T((j=e((V=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"soldierNodeArry",j,o(e)),i(e,"tankerNodeArry",W,o(e)),i(e,"houseNode",Q,o(e)),i(e,"borthPos",J,o(e)),i(e,"upgradeArea",X,o(e)),i(e,"RootNode",q,o(e)),i(e,"MaskNode",Y,o(e)),i(e,"MaskIcon",Z,o(e)),i(e,"labelNum",K,o(e)),i(e,"labelNumQuad",$,o(e)),i(e,"progressNode",tt,o(e)),i(e,"unloadPos",et,o(e)),i(e,"NameQuad",nt,o(e)),i(e,"NameQuad2",it,o(e)),e.collider=null,e._buildingData=void 0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){for(var t=0;t<this.soldierNodeArry.length;t++)this.soldierNodeArry[t].active=!1;for(var e=0;e<this.tankerNodeArry.length;e++)this.tankerNodeArry[e].active=!1;P.instance.putItem(f.House,this.node)},r.onEnable=function(){var t=this;_.instance.on(g.TeamLevelEvent,this.teamLevelChange,this),_.instance.on(g.HouseLevelEvent,this.HouseLevelEventFun,this),this.ent.has(p)||this.ent.add(p),this.ent.has(d)||this.ent.add(d),this.collider=this.upgradeArea.getComponent(c),this.ent.get(d).complete=function(){1==b.instance.level&&2==E.instance.guideStep&&t.ent.has(S)&&t.ent.remove(S),t.ent.get(p).houseLevel++,t.ent.get(d).unloading=!1,C.instance.isEmptyStr(t._buildingData.UpgradeID)?t.upgradeArea.active=!1:(w.instance.playSoundEffect(m.Build),t._buildingData=E.instance.tables.Building[t._buildingData.UpgradeID],b.instance.house[t.ent.get(p).houseName+"_currentBadge"]=t._buildingData.Silver,b.instance.house=b.instance.house,t.initHouse(t.ent.get(p).houseName,t._buildingData))},this.ent.get(d).progress=function(){b.instance.house[t.ent.get(p).houseName+"_currentBadge"]=t.ent.get(d).currentBadge,b.instance.house=b.instance.house}},r.HouseLevelEventFun=function(){this.ent.has(S)&&E.instance.houseMaxLevel>0&&this.ent.remove(S)},r.onDisable=function(){_.instance.off(g.TeamLevelEvent,this.teamLevelChange,this),_.instance.off(g.HouseLevelEvent,this.HouseLevelEventFun,this),this.ent&&this.ent.destroy(!0)},r.initHouse=function(t,e){var n=this.ent.add(p);n.houseName=t,this._buildingData=e,"Tanker"==this._buildingData.Prefab?n.houseType=v.tanker:n.houseType=v.soldier,n.spawnDeltaTime=this._buildingData.SpawnDeltaTime;var i=b.instance.house[n.houseName+"_currentBadge"];i||(i=this._buildingData.Silver),this.ent.get(d).setData(this.labelNum,this.labelNumQuad,this.progressNode,this.unloadPos,this.collider,"desc",y.gray,!0,i,this._buildingData.Silver),this.ent.get(d).setLimitMask(this._buildingData.Requirement,this.RootNode,this.MaskNode,this.MaskIcon),this.ent.get(d).setNameQuad(this.NameQuad,this.NameQuad2,this._buildingData.ID),Number(b.instance.house[n.houseName])>0&&this._buildingData.UpgradeID&&(this._buildingData=E.instance.tables.Building[this._buildingData.UpgradeID],this.ent.get(d).setLimitMask(this._buildingData.Requirement,this.RootNode,this.MaskNode,this.MaskIcon),Number(b.instance.house[n.houseName])>1&&(this.upgradeArea.active=!1))},r.teamLevelChange=function(){this.ent.get(d).setLimitMask(this._buildingData.Requirement,this.RootNode,this.MaskNode,this.MaskIcon),this.ent.get(d).setNameQuad(this.NameQuad,this.NameQuad2,this._buildingData.ID)},e}(h)).prototype,"soldierNodeArry",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),W=e(V.prototype,"tankerNodeArry",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Q=e(V.prototype,"houseNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(V.prototype,"borthPos",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(V.prototype,"upgradeArea",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(V.prototype,"RootNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(V.prototype,"MaskNode",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(V.prototype,"MaskIcon",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(V.prototype,"labelNum",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=e(V.prototype,"labelNumQuad",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=e(V.prototype,"progressNode",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=e(V.prototype,"unloadPos",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nt=e(V.prototype,"NameQuad",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=e(V.prototype,"NameQuad2",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=V))||O)||O)),r._RF.pop()}}})),System.register("chunks:///_virtual/HowitzerCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator},function(t){a=t.ResEnum},function(t){l=t.BaseCtrl}],execute:function(){var c,u,h;r._RF.push({},"4fe62+c0XhE67jEgSgg6Be3","HowitzerCtrl",void 0);var p=s.ccclass,d=s.property;t("HowitzerCtrl",p("HowitzerCtrl")((h=e((u=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"hIndex",h,o(e)),e}n(e,t);var r=e.prototype;return r.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=a.Howitzer,this.init("Howitzer"+this.hIndex)},r.onDisable=function(){t.prototype.onDisable.call(this)},e}(l)).prototype,"hIndex",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),c=u))||c),r._RF.pop()}}})),System.register("chunks:///_virtual/HowitzerEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./GlobalSingle.ts","./PoolManager.ts","./Constant.ts","./RoleEntity.ts","./BulletHowitzerEntity.ts","./StorageData.ts","./AudioManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose},function(t){s=t.cclegacy,a=t._decorator,l=t.Node,c=t.Vec3},function(t){u=t.ecs},function(t){h=t.CCComp},function(t){p=t.GlobalSingle},function(t){d=t.default},function(t){f=t.ResEnum,g=t.GameState,m=t.Sounds},function(t){v=t.RoleEntity},function(t){y=t.BulletHowitzerEntity},function(t){b=t.StorageData},function(t){C=t.default}],execute:function(){var _,E,w,S,P,M;s._RF.push({},"20430FghXpDiZIBgjZoHFNK","HowitzerEntity",void 0);var T=a.ccclass,k=a.property;t("HowitzerEntity",(_=T("HowitzerEntity"),E=u.register("HowitzerEntity",!1),w=k(l),_(S=E((M=e((P=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"FirePos",M,o(e)),e.weaponData=void 0,e.bulletData=void 0,e}n(e,t);var s=e.prototype;return s.onLoad=function(){t.prototype.onLoad.call(this)},s.reset=function(){d.instance.putItem(f.Howitzer,this.node,!0)},s.onEnable=function(){this.weaponData=p.instance.tables.Weapon.Howitzer,this.bulletData=p.instance.tables.Bullet[this.weaponData.BulletID],this.schedule(this.fireOnce,this.weaponData.CD)},s.start=function(){},s.onDisable=function(){this.unschedule(this.fireOnce),this.ent&&this.ent.destroy(!0)},s.fireOnce=function(){var t=this;if(b.instance.status==g.battle&&p.instance.enemyEntities.length>0){for(var e,n,i,o,s=r(p.instance.enemyEntities);!(o=s()).done;){var a=o.value,l=a.get(v).node.worldPosition;n=Number(c.distance(this.FirePos.getWorldPosition(),l).toFixed(3)),e?e>n&&(e=n,i=a):(e=n,i=a)}C.instance.playSoundEffect(m.HowitzerLaunch),console.log("发射一颗火炮");var u=f.bulletPath+"/"+this.weaponData.BulletID;d.instance.getItemSync(u).then((function(e){e.parent=p.instance.map,e.getComponent(y).setData(u,t.FirePos.getWorldPosition(),i.get(v).node.getWorldPosition(),t.weaponData.Range,t.bulletData.Atk)}))}},e}(h)).prototype,"FirePos",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=P))||S)||S)),s._RF.pop()}}})),System.register("chunks:///_virtual/HowitzerSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BulletHowitzerComp.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.v3,s=t.Quat,a=t.Vec3},function(t){l=t.BulletHowitzerComp},function(t){c=t.ecs}],execute:function(){var u;i._RF.push({},"97bab27h/5JLpCw+Tc39CYf","HowitzerSys",void 0);var h=o.ccclass;t("HowitzerSys",h("HowitzerSys")(u=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).gravity=9.8,e.accelerate=.5,e.quat=new s,e.curPos=void 0,e.oldPos=void 0,e}e(i,t);var o=i.prototype;return o.filter=function(){return c.allOf(l)},o.init=function(){},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value.get(l),s=o.desWorldPos.x-o.startWorldPos.x,a=o.desWorldPos.z-o.startWorldPos.z,c=s/o._flyTime,u=(0-.5*-this.gravity*Math.pow(o._flyTime,2))/o._flyTime,h=a/o._flyTime;o._Vxyz=r(c,u,h)}},o.firstUpdate=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},o.entityRemove=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value,c=o.get(l);this.oldPos=c.flyTarget.getWorldPosition(),c._nowTime+=1/60;var u=c._Vxyz.x*c._nowTime,h=c._Vxyz.y*c._nowTime+.5*-this.gravity*Math.pow(c._nowTime,2),p=c._Vxyz.z*c._nowTime;this.curPos=r(c.startWorldPos.x+u,c.startWorldPos.y+h,c.startWorldPos.z+p),c.flyTarget.setWorldPosition(this.curPos),this.quat=new s;var d=this.curPos.subtract(this.oldPos).normalize();s.fromViewUp(this.quat,d,a.UP),c.flyTarget.setWorldRotation(this.quat),c._nowTime>c._flyTime&&o.remove(l)}},i}(c.ComblockSystem))||u),i._RF.pop()}}})),System.register("chunks:///_virtual/HpProgressBarComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./PoolManager.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.default},function(t){s=t.ecs}],execute:function(){var a;n._RF.push({},"f45f3vffoRKvLzilL1TmlP+","HpProgressBarComp",void 0);var l=i.ccclass;i.property,t("HpProgressBarComp",l("HpProgressBarComp")(a=s.register("HpProgressBarComp")(a=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).hpProgressBar=null,e.attachNode=null,e}return e(n,t),n.prototype.reset=function(){r.instance.putItem(o.HpProgressBar,this.hpProgressBar),this.attachNode=null,this.hpProgressBar=null},n}(s.Comp))||a)||a),n._RF.pop()}}})),System.register("chunks:///_virtual/HpProgressBarSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./PoolManager.ts","./GunComp.ts","./HpProgressBarComp.ts","./RoleComp.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Camera,s=t.Label,a=t.ProgressBar,l=t.Vec3},function(t){c=t.ResEnum},function(t){u=t.GlobalSingle},function(t){h=t.default},function(t){p=t.GunComp},function(t){d=t.HpProgressBarComp},function(t){f=t.RoleComp},function(t){g=t.RoleEntity},function(t){m=t.ecs}],execute:function(){var v;i._RF.push({},"92693JXOoFN+7Vm+U+CGUVr","HpProgressBarSys",void 0);var y=o.ccclass;t("HpProgressBarSys",y("HpProgressBarSys")(v=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._progressPos=new l,e}e(i,t);var o=i.prototype;return o.filter=function(){return m.allOf(f,d)},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value;this.initHpProgressBar(o)}},o.firstUpdate=function(t){},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value,l=o.get(d),c=o.get(f);if(l.attachNode&&l.hpProgressBar){u.instance.camera3d.getComponent(r).convertToUINode(l.attachNode.worldPosition,l.hpProgressBar.parent,this._progressPos),this._progressPos.y+=150,l.hpProgressBar.setPosition(this._progressPos);var h="";o.has(f)&&o.has(p)&&(h+="射程："+o.get(p).shootRadius+" "),o.has(f)&&(h+="血量："+c.currentHp.toFixed(2)+" "),o.has(p)&&o.get(f).opponentDistance&&(h+="距离："+o.get(f).opponentDistance.toFixed(3)),l.hpProgressBar.getChildByName("content").getComponent(s).string=h,l.hpProgressBar.getChildByName("ProgressBar").getComponent(a).progress=c.currentHp/c.hp}}},o.initHpProgressBar=function(t){var e=this;h.instance.getItemSync(c.HpProgressBar).then((function(n){var i=t.get(d);i.attachNode=t.get(g).node,i.hpProgressBar=n,u.instance.canvas.node.insertChild(n,1),u.instance.camera3d.getComponent(r).convertToUINode(i.attachNode.worldPosition,i.hpProgressBar.parent,e._progressPos),i.hpProgressBar.setPosition(e._progressPos)}))},i}(m.ComblockSystem))||v),i._RF.pop()}}})),System.register("chunks:///_virtual/HpWarnComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./UIManager.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component},function(t){r=t.UIID},function(t){s=t.UIManager}],execute:function(){var a;n._RF.push({},"6d30ekHEWVCsrEBDn9rnl4C","HpWarnComp",void 0);var l=i.ccclass;i.property,t("HpWarnComp",l("HpWarnComp")(a=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){s.instance.open(r.HpWarnUi)},i.onDisable=function(){s.instance.close(s.instance.getUI(r.HpWarnUi))},n}(o))||a),n._RF.pop()}}})),System.register("chunks:///_virtual/HpWarnUi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIView.ts"],(function(t){var e,n,i,o,r,s,a;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.tween,r=t.UIOpacity,s=t.Tween},function(t){a=t.UIView}],execute:function(){var l;n._RF.push({},"de4f1NRAZBEA5ms2fTU2NrL","HpWarnUi",void 0);var c=i.ccclass;i.property,t("HpWarnUi",c("HpWarnUi")(l=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){o(this.node.getComponent(r)).to(.5,{opacity:0}).to(.5,{opacity:255}).union().repeatForever().start()},i.onDisable=function(){s.stopAllByTarget(this.node)},n}(a))||l),n._RF.pop()}}})),System.register("chunks:///_virtual/HurtComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"0dc460FlVFFooz39HTnc0or","HurtComp",void 0);var s=i.ccclass;i.property,t("HurtComp",s("HurtComp")(r=o.register("HurtComp")(r=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.reset=function(){},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/index.ts",["cc","./editor.ts","./npm.ts"],(function(t){var e;return{setters:[function(t){e=t.cclegacy},function(e){var n={};n.Editor=e.Editor,n.projectAssetPath=e.projectAssetPath,n.projectPath=e.projectPath,t(n)},function(e){var n={};n.base642arraybuffer=e.base642arraybuffer,n.cce=e.cce,n.formatPath=e.formatPath,n.fse=e.fse,n.io=e.io,n.path=e.path,t(n)}],execute:function(){e._RF.push({},"b55291IcEJJrrvhmxlYUxZT","index",void 0),e._RF.pop()}}})),System.register("chunks:///_virtual/Joystick.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.EventTarget,l=t.Node,c=t.Enum,u=t.Vec3,h=t.Vec2,p=t.CCInteger,d=t.UITransform,f=t.Size,g=t.UIOpacity,m=t.Component}],execute:function(){var v,y,b,C,_,E,w,S,P,M,T,k,N,R,B,F,L;t({DirectionType:void 0,JoystickEventType:void 0,JoystickType:void 0,SpeedType:void 0}),r._RF.push({},"23959j7ywpGNrBN1BOxyKl7","Joystick",void 0);var A,D,x,I,U=s.ccclass,z=s.property,G=t("JoystickEvent",new a),H=t("SET_JOYSTICK_TYPE","SET_JOYSTICK_TYPE");!function(t){t.TOUCH_START="touch-start",t.TOUCH_MOVE="touch-move",t.TOUCH_END="touch-end",t.TOUCH_CANCEL="touch-cancel"}(A||(A=t("JoystickEventType",{}))),function(t){t[t.FOUR=0]="FOUR",t[t.EIGHT=1]="EIGHT",t[t.ALL=2]="ALL"}(D||(D=t("DirectionType",{}))),function(t){t[t.STOP=0]="STOP",t[t.NORMAL=1]="NORMAL",t[t.FAST=2]="FAST"}(x||(x=t("SpeedType",{}))),function(t){t[t.FIXED=0]="FIXED",t[t.FOLLOW=1]="FOLLOW"}(I||(I=t("JoystickType",{}))),t("Joystick",(v=U("Joystick"),y=z({type:l,displayName:"Dot",tooltip:"摇杆操纵点"}),b=z({type:l,displayName:"Ring",tooltip:"摇杆背景节点"}),C=z({type:c(I),displayName:"Touch Type",tooltip:"触摸类型"}),_=z({type:c(D),displayName:"Direction Type",tooltip:"方向类型"}),E=z({type:u,tooltip:"摇杆所在位置"}),w=z({type:h,tooltip:"触摸位置"}),S=z({type:p,displayName:"Ring Radius",tooltip:"半径"}),v((T=e((M=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"dot",T,o(e)),i(e,"ring",k,o(e)),i(e,"joystickType",N,o(e)),i(e,"directionType",R,o(e)),i(e,"_stickPos",B,o(e)),i(e,"_touchLocation",F,o(e)),i(e,"radius",L,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){var t;if(this.dot)if(this.ring){var e=this.ring.getComponent(d),n=2*this.radius,i=new f(n,n);null==e||e.setContentSize(i),null==(t=this.ring.getChildByName("bg").getComponent(d))||t.setContentSize(i),this._initTouchEvent();var o=this.node.getComponent(g);this.joystickType===I.FOLLOW&&o&&(o.opacity=0)}else console.warn("Joystick Ring is null!");else console.warn("Joystick Dot is null!")},r.onEnable=function(){G.on(H,this._onSetJoystickType,this)},r.onDisable=function(){G.off(H,this._onSetJoystickType,this)},r._onSetJoystickType=function(t){this.joystickType=t;var e=this.node.getComponent(g);e&&(e.opacity=t===I.FIXED?255:0)},r._initTouchEvent=function(){this.node.on(l.EventType.TOUCH_START,this._touchStartEvent,this),this.node.on(l.EventType.TOUCH_MOVE,this._touchMoveEvent,this),this.node.on(l.EventType.TOUCH_END,this._touchEndEvent,this),this.node.on(l.EventType.TOUCH_CANCEL,this._touchEndEvent,this)},r._touchStartEvent=function(t){if(this.ring&&this.dot){G.emit(l.EventType.TOUCH_START,t);var e=t.getUILocation(),n=new u(e.x,e.y);if(this.joystickType===I.FIXED){this._stickPos=this.ring.getPosition();var i=n.subtract(this.ring.getPosition()),o=i.length();this.radius>o&&this.dot.setPosition(i)}else this.joystickType===I.FOLLOW&&(this._stickPos=n,this.node.getComponent(g).opacity=255,this._touchLocation=t.getUILocation(),this.ring.setPosition(n),this.dot.setPosition(new u))}},r._touchMoveEvent=function(t){if(this.dot&&this.ring){if(this.joystickType===I.FOLLOW&&this._touchLocation===t.getUILocation())return!1;var e=t.getUILocation(),n=new u(e.x,e.y).subtract(this.ring.getPosition()),i=n.length(),o=x.NORMAL;this.radius>i?(this.dot.setPosition(n),o=x.NORMAL):(this.dot.setPosition(n.normalize().multiplyScalar(this.radius)),o=x.FAST),G.emit(A.TOUCH_MOVE,t,{speedType:o,moveVec:n.normalize()})}},r._touchEndEvent=function(t){this.dot&&this.ring&&(this.dot.setPosition(new u),this.joystickType===I.FOLLOW&&(this.node.getComponent(g).opacity=0),G.emit(A.TOUCH_END,t,{speedType:x.STOP}))},e}(m)).prototype,"dot",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(M.prototype,"ring",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(M.prototype,"joystickType",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return I.FIXED}}),R=e(M.prototype,"directionType",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return D.ALL}}),B=e(M.prototype,"_stickPos",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u}}),F=e(M.prototype,"_touchLocation",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new h}}),L=e(M.prototype,"radius",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),P=M))||P)),r._RF.pop()}}})),System.register("chunks:///_virtual/JoystickMoveComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c;return{setters:[function(t){e=t.inheritsLoose,n=t.applyDecoratedDescriptor,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.CCInteger},function(t){c=t.ecs}],execute:function(){var u,h,p,d,f,g,m,v,y,b,C,_;r._RF.push({},"24d46wZlvVKK7F2sgabUkd4","JoystickMoveComp",void 0);var E=s.ccclass,w=s.property;t("JoystickMoveComp",(u=E("JoystickMoveComp"),h=c.register("JoystickMoveComp"),p=w({type:a,tooltip:"移动的节点"}),d=w({type:l,tooltip:"停止时速度"}),f=w({type:l,tooltip:"正常速度"}),g=w({type:l,tooltip:"最快速度"}),u(m=h((v=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"moveTarget",y,o(e)),i(e,"stopSpeed",b,o(e)),i(e,"normalSpeed",C,o(e)),i(e,"fastSpeed",_,o(e)),e}e(n,t);var r=n.prototype;return r.onLoad=function(){},r.reset=function(){},n}(c.Comp),y=n(v.prototype,"moveTarget",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=n(v.prototype,"stopSpeed",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),C=n(v.prototype,"normalSpeed",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),_=n(v.prototype,"fastSpeed",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),m=v))||m)||m)),r._RF.pop()}}})),System.register("chunks:///_virtual/JoystickMoveSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./Joystick.ts","./JoystickMoveComp.ts","./RoleAnimComp.ts","./VehicleComp.ts","./PlaneEntity.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t.Vec3,r=t.v3,s=t.Quat},function(t){a=t.RoleClips},function(t){l=t.GlobalSingle},function(t){c=t.SpeedType,u=t.JoystickEvent,h=t.JoystickEventType},function(t){p=t.JoystickMoveComp},function(t){d=t.RoleAnimComp},function(t){f=t.VehicleComp},function(t){g=t.PlaneEntity},function(t){m=t.RoleEntity},function(t){v=t.ecs}],execute:function(){i._RF.push({},"d5f1cI3SyRLDb8RZ4ghKkKS","JoystickMoveSys",void 0),new o;var y=0;t("JoystickMoveSys",function(t){function i(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this).roleEntities=void 0,e._speedType=c.STOP,e._desPos=new o,e._dirQuat=new s,e.joystickData=void 0,e._moveDir=new o,e.moveTarget=void 0,e.roleAnimComp=null,e.roleEntity=void 0,e}e(i,t);var b=i.prototype;return b.filter=function(){return v.allOf(p)},b.entityEnter=function(t){this.roleEntities=t;for(var e,i=n(t);!(e=i()).done;)e.value.get(d).idle()},b.firstUpdate=function(t){this.registerEvent()},b.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value;this._speedType!==c.STOP&&this.move(o)}this.moveTarget&&(this.roleEntity=this.moveTarget.getComponent(m),this.roleEntity&&!this.roleEntity.isTakePlane)&&(this.roleAnimComp=this.roleEntity.ent.get(d),null!=l.instance.vehicleType?(this.roleEntity.ent.has(f)||this.roleEntity.ent.add(f).init(l.instance.vehicleType),this.roleAnimComp.motorcycle()):this.roleEntity.ent.has(f)&&(this.roleEntity.ent.remove(f),l.instance.joystickMoving?this.roleAnimComp.run():this.roleAnimComp.idle()))},b.onDestroy=function(){this.unregisterEvent()},b.registerEvent=function(){u.on(h.TOUCH_START,this.onTouchStart,this),u.on(h.TOUCH_MOVE,this.onTouchMove,this),u.on(h.TOUCH_END,this.onTouchEnd,this),u.on(h.TOUCH_CANCEL,this.onTouchEnd,this)},b.unregisterEvent=function(){u.off(h.TOUCH_START,this.onTouchStart,this),u.off(h.TOUCH_MOVE,this.onTouchMove,this),u.off(h.TOUCH_END,this.onTouchEnd,this),u.off(h.TOUCH_CANCEL,this.onTouchEnd,this)},b.onTouchStart=function(){l.instance.joystickMoving=!0},b.onTouchMove=function(t,e){this.joystickData=e,this._speedType=e.speedType,l.instance.joystickMoving=!0;for(var i,o=n(this.roleEntities);!(i=o()).done;){var r=i.value;this.moveTarget=r.get(p).moveTarget,this.moveTarget&&this.moveTarget.getComponent(m)&&(this.roleEntity=this.moveTarget.getComponent(m),this.roleAnimComp=this.roleEntity.ent.get(d),this.roleEntity.ent.has(f)||this.roleAnimComp.skeletalAnimation&&!this.roleAnimComp.skeletalAnimation.getState(a.run).isPlaying&&this.roleAnimComp.run())}},b.onTouchEnd=function(t,e){this.joystickData=e,this._speedType=e.speedType,l.instance.joystickMoving=!1;for(var i,o=n(this.roleEntities);!(i=o()).done;){var r=i.value;this.moveTarget=r.get(p).moveTarget,this.moveTarget&&(this.moveTarget.getComponent(m)&&(this.roleEntity=this.moveTarget.getComponent(m),this.roleEntity&&(this.roleEntity.ent.has(f)&&this.moveTarget.worldPosition.z<5||r.get(d).idle())),this.moveTarget.getComponent(g)&&this.moveTarget.getComponent(g).joystickMove(!1))}},b.getMoveSpeed=function(t,e){switch(e){case c.STOP:return t.stopSpeed;case c.NORMAL:return t.normalSpeed;case c.FAST:return t.fastSpeed;default:return t.stopSpeed}},b.move=function(t){var e=t.get(p).moveTarget;e&&(y=this.getMoveSpeed(t.get(p),this.joystickData.speedType),this._moveDir=r(this.joystickData.moveVec.x,0,-this.joystickData.moveVec.y).multiplyScalar(y*this.dt),e.getComponent(g)?(e.getComponent(g).joystickMove(!0),o.add(this._desPos,e.worldPosition,this._moveDir)):o.add(this._desPos,e.worldPosition,this._moveDir),this._desPos.x>39&&(this._desPos.x=39),this._desPos.x<-39&&(this._desPos.x=-39),this._desPos.z>39&&(this._desPos.z=39),this._desPos.z<-31&&(this._desPos.z=-31),e.setWorldPosition(this._desPos),s.fromViewUp(this._dirQuat,this._moveDir,o.UP),e.setRotation(this._dirQuat))},i}(v.ComblockSystem)),i._RF.pop()}}})),System.register("chunks:///_virtual/LevelProgressComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./LevelUtil.ts","./StorageData.ts","./EventManager.ts","./FlagItem.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.ProgressBar,l=t.Node,c=t.Prefab,u=t.Widget,h=t.UITransform,p=t.instantiate,d=t.v3,f=t.Component},function(t){g=t.GameEvent},function(t){m=t.GlobalSingle},function(t){v=t.LevelUtil},function(t){y=t.StorageData},function(t){b=t.EventManager},function(t){C=t.FlagItem}],execute:function(){var _,E,w,S,P,M,T,k,N,R,B;r._RF.push({},"593116W909DC5NzZfC8Orrg","LevelProgressComp",void 0);var F=s.ccclass,L=s.property;t("LevelProgressComp",(_=F("LevelProgressComp"),E=L(a),w=L(l),S=L(l),P=L(c),_((k=e((T=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"progressBar",k,o(e)),i(e,"star",N,o(e)),i(e,"Flag",R,o(e)),i(e,"FlagItem",B,o(e)),e.levelArry=void 0,e.targetProgress=0,e}n(e,t);var r=e.prototype;return r.onEnable=function(){b.instance.on(g.LevelEvent,this.LevelEventFun,this),b.instance.on(g.RoleNumChangeEvent,this.RoleChangeEventFun,this),this.init()},r.update=function(t){this.progressBar.progress<=this.targetProgress?(this.progressBar.progress+=t/3,this.star.getComponent(u).right=-58.953,this.star.getComponent(u).updateAlignment()):this.progressBar.progress=this.targetProgress},r.onDisable=function(){b.instance.off(g.LevelEvent,this.LevelEventFun,this),b.instance.off(g.RoleNumChangeEvent,this.RoleChangeEventFun,this)},r.init=function(){if(this.Flag.destroyAllChildren(),this.levelArry=v.instance.getLevelByLevel1(),this.levelArry.length>1)for(var t=this.Flag.getComponent(h).contentSize.width,e=t/this.levelArry.length,n=1;n<this.levelArry.length;n++){var i=p(this.FlagItem);i.parent=this.Flag,i.setPosition(d(-t/2+e*n,0,0)),i.getComponent(C).index=n-1,i.getComponent(C).startProgress=1/this.levelArry.length*(n-1),i.getComponent(C).endProgress=1/this.levelArry.length*n,y.instance.level>=this.levelArry[n].ID?i.getComponent(C).isPass=!0:i.getComponent(C).isPass=!1,i.getComponent(C).levelID=this.levelArry[n-1].ID}this.setProgress(0)},r.LevelEventFun=function(){this.init()},r.RoleChangeEventFun=function(){this.setProgress((m.instance.enemyTotalCount-m.instance.enemyEntities.length)/m.instance.enemyTotalCount)},r.setProgress=function(t){for(var e=null,n=0;n<this.Flag.children.length;n++)if(this.Flag.children[n].getComponent(C).levelID==y.instance.level){e=this.Flag.children[n].getComponent(C);break}this.levelArry.length<=1?this.targetProgress=t:this.targetProgress=this.Flag.children[this.Flag.children.length-1].getComponent(C).endProgress+t*(1/this.levelArry.length),e&&(this.targetProgress=e.startProgress+t*(1/this.levelArry.length),t>=1&&(e.isPass=!0)),0==t&&(this.progressBar.progress=this.targetProgress)},e}(f)).prototype,"progressBar",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(T.prototype,"star",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(T.prototype,"Flag",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(T.prototype,"FlagItem",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=T))||M)),r._RF.pop()}}})),System.register("chunks:///_virtual/LevelUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalSingle.ts","./StorageData.ts"],(function(t){var e,n,i,o,r,s,a;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator,r=t.Component},function(t){s=t.GlobalSingle},function(t){a=t.StorageData}],execute:function(){var l,c;i._RF.push({},"84a76eJL2dC2ptGR9tLVfR8","LevelUtil",void 0);var u=o.ccclass;o.property,t("LevelUtil",u("LevelUtil")(((c=function(t){function i(){return t.apply(this,arguments)||this}return e(i,t),i.prototype.getLevelByLevel1=function(){var t=s.instance.tables.EnemyLevel[a.instance.level],e=[];for(var n in s.instance.tables.EnemyLevel)if(Object.prototype.hasOwnProperty.call(s.instance.tables.EnemyLevel,n)){var i=s.instance.tables.EnemyLevel[n];t.Level1==i.Level1&&e.push(i)}return e},n(i,null,[{key:"instance",get:function(){return null===i._instance&&(i._instance=new i),i._instance},set:function(t){i._instance=t}}]),i}(r))._instance=null,l=c))||l),i._RF.pop()}}})),System.register("chunks:///_virtual/MapCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./Constant.ts","./GlobalSingle.ts","./BaseCtrl.ts","./StorageData.ts","./EnemyLevelCtrl.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.v3,r=t.tween,s=t.Component},function(t){a=t.EventManager},function(t){l=t.GameEvent,c=t.GameState},function(t){u=t.GlobalSingle},function(t){h=t.BaseCtrl},function(t){p=t.StorageData},function(t){d=t.EnemyLevelCtrl}],execute:function(){var f;n._RF.push({},"9068bakIaxLbKDbdnQRsBx2","MapCtrl",void 0);var g=i.ccclass;i.property,t("MapCtrl",g("MapCtrl")(f=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){a.instance.on(l.PackageEvent,this.packageEventFun,this),a.instance.on(l.LevelEvent,this.LevelEventFun,this)},i.onDisable=function(){a.instance.off(l.PackageEvent,this.packageEventFun,this),a.instance.off(l.LevelEvent,this.LevelEventFun,this)},i.packageEventFun=function(t,e){},i.LevelEventFun=function(){p.instance.status=c.ready;var t=this.node.getComponentsInChildren(h);if(1==u.instance.tables.EnemyLevel[p.instance.level].Level2)for(var e=0;e<t.length;e++)t[e].node.active=!0,t[e].node.setScale(o(1,1,1));else for(var n=0;n<t.length;n++)t[n].node.active=!0,r(t[n].node).to(.3,{scale:o(1,1,1)}).start();this.node.getComponentInChildren(d).node.active=!0},n}(s))||f),n._RF.pop()}}})),System.register("chunks:///_virtual/MapNavExport.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NavMesh.ts","./GlobalSingle.ts","./BaseCtrl.ts","./EnemyLevelExport.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose,s=t.createClass},function(t){a=t.cclegacy,l=t._decorator,c=t.CCBoolean,u=t.Node,h=t.MeshRenderer,p=t.utils,d=t.gfx,f=t.Component},function(t){g=t.NavMeshMgr,m=t.MeshDebugDataType},function(t){v=t.GlobalSingle},function(t){y=t.BaseCtrl},function(t){b=t.EnemyLevelExport}],execute:function(){var C,_,E,w,S,P,M,T,k;a._RF.push({},"4cde67iyy9HuLbuxNkcsigT","MapNavExport",void 0);var N=l.ccclass,R=l.property;t("MapNavExport",(C=N("MapNavExport"),_=R({type:c,tooltip:"调试总开关",displayName:"调试总开关"}),E=R(u),w=R([u]),S=R({type:c,tooltip:"保存navmesh 数据",displayName:"保存数据"}),C((e((M=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))||this)._debug=!1,i(e,"surfaceRender",T,o(e)),i(e,"staticModels",k,o(e)),e._saveData=null,e}n(e,t);var a=e.prototype;return a.initNav=function(t){console.log("NavMeshMgr开始初始化"),v.instance.navMeshMgr=new g,v.instance.navMeshMgr.init((function(){v.instance.navMeshMgr.setConfig({cs:.12,ch:.1,tileSize:50,borderSize:.1,walkableSlopeAngle:60,walkableHeight:2,walkableClimb:1,walkableRadius:1,maxEdgeLen:12,maxSimplificationError:1,minRegionArea:8,mergeRegionArea:30,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1}),t&&t()}))},a.saveNavMeshData=function(){var t=this;console.log("开始导出"),this.initNav((function(){for(var e=0;e<t.staticModels.length;e++)console.log(t.staticModels[e].name),v.instance.navMeshMgr.addStaticModle(t.staticModels[e]);v.instance.navMeshMgr.build();var n=v.instance.navMeshMgr.getNavMeshData();v.instance.navMeshCrowd=v.instance.navMeshMgr.initCrowd(10,1);var i=v.instance.navMeshMgr.getNavMeshDebugData(m.LINE);console.log(i),t.createDebugMesh(i.positions,i.normals),Editor.Message.send("asset-db","create-asset","db://assets/resources/nav-mesh.bin",n),console.log("导出成功")}))},a.createDebugMesh=function(t,e){var n=this.surfaceRender.getComponent(h);n||(n=this.surfaceRender.addComponent(h));var i=p.createMesh({positions:t,primitiveMode:d.PrimitiveMode.TRIANGLE_LIST,normals:e});n.mesh=i},a.drawDebugLine=function(){var t=v.instance.navMeshMgr.getNavMeshDebugData(m.LINE);this.createDebugMesh(t.positions,t.normals)},a.debugSwitch=function(){for(var t,e=this.node.getComponentsInChildren(y),n=r(e);!(t=n()).done;){var i=t.value;i.node.parent.getComponent(b)||(i.debug=this.debug)}},s(e,[{key:"debug",get:function(){return this._debug},set:function(t){this._debug=t,this.debugSwitch()}},{key:"saveData",get:function(){return this._saveData},set:function(t){!0===t&&this.saveNavMeshData(),this._saveData=!1}}]),e}(f)).prototype,"debug",[_],Object.getOwnPropertyDescriptor(M.prototype,"debug"),M.prototype),T=e(M.prototype,"surfaceRender",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(M.prototype,"staticModels",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),e(M.prototype,"saveData",[S],Object.getOwnPropertyDescriptor(M.prototype,"saveData"),M.prototype),P=M))||P)),a._RF.pop()}}})),System.register("chunks:///_virtual/MapNode.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NavMesh.ts","./PoolManager.ts","./UIManager.ts","./Constant.ts","./GameUtil.ts","./GlobalSingle.ts","./BaseCtrl.ts","./EnemyLevelExport.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose,s=t.createClass},function(t){a=t.cclegacy,l=t._decorator,c=t.CCBoolean,u=t.JsonAsset,h=t.MeshRenderer,p=t.utils,d=t.gfx,f=t.Component},function(t){g=t.NavMeshMgr},function(t){m=t.default},function(t){v=t.UIManager},function(t){y=t.UIID,b=t.ResEnum},function(t){C=t.GameUtil},function(t){_=t.GlobalSingle},function(t){E=t.BaseCtrl},function(t){w=t.EnemyLevelExport}],execute:function(){var S,P,M,T,k,N,R,B;a._RF.push({},"64472x6OEBEQoyzh6y1N68i","MapNode",void 0);var F=l.ccclass,L=l.property,A=l.executeInEditMode;t("MapNode",(S=F("MapNode"),P=L({type:c,tooltip:"调试总开关",displayName:"调试总开关"}),M=L(u),T=L(u),S(k=A((e((N=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))||this)._debug=!1,i(e,"RoleJson",R,o(e)),i(e,"TurretJson",B,o(e)),e}n(e,t);var a=e.prototype;return a.onLoad=function(){_.instance.mapNode=this.node,_.instance.map=this.node,this.initNav()},a.update=function(t){},a.start=function(){!_.instance.tables.Role&&this.RoleJson.json&&(_.instance.tables.Role=this.RoleJson.json,_.instance.tables.Turret=this.TurretJson.json),C.instance.getBundle("ui").then((function(t){v.instance.open(y.Game3dUi)})),C.instance.getBundle("res").then((function(t){m.instance.initPool([b.Bullet1,b.Badge,b.HitFX,b.FireFX],(function(){m.instance.initSize(b.Bullet1,30),m.instance.initSize(b.Badge,30),m.instance.initSize(b.FireFX,5),m.instance.initSize(b.HitFX,5),m.instance.setLimit(b.FireFX,5),m.instance.setLimit(b.HitFX,5)}))}))},a.debugSwitch=function(){for(var t,e=this.node.getComponentsInChildren(E),n=r(e);!(t=n()).done;){var i=t.value;i.node.parent.getComponent(w)||(i.debug=this.debug)}},a.initNav=function(){var t=(new Date).getTime();_.instance.navMeshMgr=new g,_.instance.navMeshMgr.init((function(){_.instance.navMeshMgr.setConfig({cs:.12,ch:.1,tileSize:50,borderSize:.1,walkableSlopeAngle:60,walkableHeight:2,walkableClimb:1,walkableRadius:1,maxEdgeLen:12,maxSimplificationError:1,minRegionArea:8,mergeRegionArea:30,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1}),_.instance.navMeshMgr.loadNavMeshData("nav-mesh",(function(e){_.instance.navMeshMgr.buildFromNavMeshData(e),_.instance.navMeshCrowd=_.instance.navMeshMgr.initCrowd(50,1);var n="初始化寻路耗时:"+((new Date).getTime()-t)/1e3+"s";console.log(n)}))}))},a.createDebugMesh=function(t,e){var n=this.node.getComponent(h);n||(n=this.node.addComponent(h));var i=p.createMesh({positions:t,primitiveMode:d.PrimitiveMode.TRIANGLE_LIST,normals:e});n.mesh=i},s(e,[{key:"debug",get:function(){return this._debug},set:function(t){this._debug=t,this.debugSwitch()}}]),e}(f)).prototype,"debug",[P],Object.getOwnPropertyDescriptor(N.prototype,"debug"),N.prototype),R=e(N.prototype,"RoleJson",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(N.prototype,"TurretJson",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=N))||k)||k)),a._RF.pop()}}})),System.register("chunks:///_virtual/mathf.ts",["cc"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy,n=t.Vec3}],execute:function(){t({pointDistanceXZ:function(t,e){var n=e.x-t.x,i=e.z-t.z;return Math.sqrt(n*n+i*i)},pointInBoundingXZ:function(t,e,n,i,o){return void 0===i&&(i=0),void 0===o&&(o=0),t.x>=e.x-i&&t.x<=n.x+i&&t.z>=e.z-o&&t.z<=n.z+o},pointInPolygonAreaXZ:function(t,e){for(var n=!1,i=t.x,o=t.z,r=e.length,s=0,a=r-1;s<r;a=s++){var l=e[s].x,c=e[s].z,u=e[a].x,h=e[a].z;c>o!=h>o&&i<(u-l)*(o-c)/(h-c)+l&&(n=!n)}return n},pointInPolygonLineXZ:function(t,e,n,i){void 0===i&&(i=!0);for(var o=1,s=e.length;o<s;o++){var a=r(t,e[o-1],e[o],!0);if(a.dist<n){if(i)return!0;if(a.t>=0&&a.t<=1)return!0}}return!1},pointLineDistanceXZ:r,pointPolygonMinDistXZ:function(t,e){s.dist=Number.MAX_SAFE_INTEGER;for(var n=1;n<e.length;n++){var i=r(t,e[n-1],e[n],!0);i.dist<s.dist&&(s.dist=i.dist,s.index=n,s.t=i.t)}return s}}),e._RF.push({},"c7eb5bTTC1Ic58WBxykaEs8","mathf",void 0),t("default",function(){function t(){}return t.lerp=function(t,e,n){return t+(e-t)*n},t}());var i=new n,o={dist:0,t:0};function r(t,e,n,r){void 0===r&&(r=!1);var s,a=n.x-e.x,l=n.z-e.z,c=a*a+l*l,u=((t.x-e.x)*a+(t.z-e.z)*l)/c;return s=r?c?u<0?e:u>1?n:i.set(e.x+u*a,0,e.z+u*l):e:i.set(e.x+u*a,0,e.z+u*l),a=t.x-s.x,l=t.z-s.z,o.dist=Math.sqrt(a*a+l*l),o.t=u,o}var s={dist:0,index:0,t:0};e._RF.pop()}}})),System.register("chunks:///_virtual/MedicComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"462a0GMlltALZv0B9eA30U4","MedicComp",void 0);var s=i.ccclass;i.property,t("MedicComp",s("MedicComp")(r=o.register("MedicComp")(r=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.reset=function(){},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/MedicCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.BaseCtrl}],execute:function(){var s;n._RF.push({},"f217dvgJwJDaoJ02sY4zXnc","MedicCtrl",void 0);var a=i.ccclass;i.property,t("MedicCtrl",a("MedicCtrl")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.Medic,this.init("Medic")},i.update=function(t){},i.onDisable=function(){t.prototype.onDisable.call(this)},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/MedicEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./RoleEntity.ts","./GunComp.ts","./RoleAnimComp.ts","./NavToComp.ts","./MedicStretcherEntity.ts","./MedicComp.ts","./Constant.ts","./PoolManager.ts","./HpProgressBarComp.ts","./HurtComp.ts","./StretcherEntity.ts","./EventManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.Prefab,c=t.v3},function(t){u=t.ecs},function(t){h=t.CCComp},function(t){p=t.RoleEntity},function(t){d=t.GunComp},function(t){f=t.RoleAnimComp},function(t){g=t.NavToComp,m=t.DestPosType},function(t){v=t.MedicStretcherEntity},function(t){y=t.MedicComp},function(t){b=t.ResEnum,C=t.GameEvent},function(t){_=t.default},function(t){E=t.HpProgressBarComp},function(t){w=t.HurtComp},function(t){S=t.StretcherEntity},function(t){P=t.EventManager}],execute:function(){var M,T,k,N,R,B,F,L,A,D,x,I,U,z;r._RF.push({},"31b04h2ldlJ4qfyk7pGpsFx","MedicEntity",void 0);var G=s.ccclass,H=s.property;t("MedicEntity",(M=G("MedicEntity"),T=u.register("MedicEntity",!1),k=H(a),N=H(a),R=H(l),B=H(a),F=H([a]),M(L=T((D=e((A=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"Beds",D,o(e)),i(e,"MedicStretcher",x,o(e)),i(e,"rolePrefab",I,o(e)),i(e,"UnloadPos",U,o(e)),i(e,"medics",z,o(e)),e.rescuing=!1,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){this.rescuing=!1,_.instance.putItem(b.Medic,this.node,!0)},r.onEnable=function(){P.instance.on(C.PackageEvent,this.PackageEventFun,this),P.instance.on(C.LevelEvent,this.LevelEventFun,this),P.instance.on(C.StatusEvent,this.statusChangeFun,this),this.ent.add(y),this.schedule(this.checkDeathSoldier,1),this.checkDeathSoldier(),this.spawnMedic()},r.onDisable=function(){P.instance.off(C.PackageEvent,this.PackageEventFun,this),P.instance.off(C.LevelEvent,this.LevelEventFun,this),P.instance.off(C.StatusEvent,this.statusChangeFun,this),this.unschedule(this.checkDeathSoldier),this.unschedule(this.check),this.unschedule(this.unloadWounded),this.ent&&this.ent.destroy(!0)},r.statusChangeFun=function(){},r.PackageEventFun=function(){this.rescuing=!1},r.LevelEventFun=function(){this.spawnMedic()},r.spawnMedic=function(){for(var t=0;t<this.medics.length;t++)this.spawnOneMedic(this.medics[t])},r.spawnOneMedic=function(t){t.children.length<=0&&_.instance.getItemSync(b.Role).then((function(e){var n=e.getComponent(p);n.isPlayer=!1,e.parent=t,e.name="MedicSoldier",n.rigidbody.useGravity=!1,n.ent.add(f),n.roleId=20,n.setRoleData(),n.ent.remove(d),n.ent.add(E),e.setPosition(c(0,0,0))}))},r.checkDeathSoldier=function(){var t=u.query(u.allOf(w));if(!this.rescuing)if(t.length>0)this.rescueSoldier(t[0].get(p));else{this.MedicStretcher.setPosition(c(0,0,5)),this.MedicStretcher.setRotationFromEuler(c(0,90,0));for(var e=0;e<this.medics.length;e++)this.medics[e].children.length>0&&this.medics[e].children[0].getComponent(p).ent.get(f).idle()}},r.rescueSoldier=function(t){this.rescuing=!0;for(var e=0;e<this.medics.length;e++)this.medics[e].children[0].getComponent(p).ent.get(f).carry(),this.medics[e].children[0].getComponent(p).collider.enabled=!1,this.medics[e].children[0].setRotationFromEuler(c(0,0,0));var n=this.MedicStretcher.getComponent(v).ent,i=n.get(g);i||((i=n.add(g)).needNavNode=this.MedicStretcher),i.destPos={type:m.Rescue,worldPos:t.node.worldPosition,target:t.node},i.destPosArry.push({type:m.RescueBack,worldPos:this.UnloadPos.worldPosition,target:this.node})},r.unloadWounded=function(){for(var t=null,e=0;e<this.Beds.children.length;e++)if(!this.Beds.children[e].getComponent(S).beUsedSoldier){t=this.Beds.children[e].getComponent(S);break}if(t&&this.MedicStretcher.getComponent(v).Wounded.children.length>0){var n=this.MedicStretcher.getComponent(v).Wounded.children[0];t.beUsedSoldier=n,n.parent=t.node,n.setPosition(c(-1,.8,0)),n.setRotationFromEuler(c(0,-90,0)),n.getComponent(p).ent.remove(w),t.reliveSoldier(this.UnloadPos.worldPosition),this.rescuing=!1}else this.scheduleOnce(this.check,1)},r.check=function(){console.log("没有床位，1s后再看看"),this.scheduleOnce(this.unloadWounded,1)},e}(h)).prototype,"Beds",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(A.prototype,"MedicStretcher",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(A.prototype,"rolePrefab",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(A.prototype,"UnloadPos",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(A.prototype,"medics",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=A))||L)||L)),r._RF.pop()}}})),System.register("chunks:///_virtual/MedicStretcherEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts"],(function(t){var e,n,i,o,r,s,a,l,c;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node},function(t){l=t.ecs},function(t){c=t.CCComp}],execute:function(){var u,h,p,d,f,g;r._RF.push({},"acf6dlYt6pLEpMXuEwSKLE2","MedicStretcherEntity",void 0);var m=s.ccclass,v=s.property;t("MedicStretcherEntity",(u=m("MedicStretcherEntity"),h=l.register("MedicStretcherEntity",!1),p=v(a),u(d=h((g=e((f=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"Wounded",g,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){},r.onEnable=function(){},r.start=function(){},r.onDisable=function(){},e}(c)).prototype,"Wounded",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d)||d)),r._RF.pop()}}})),System.register("chunks:///_virtual/mesh-bender.ts",["./rollupPluginModLoBabelHelpers.js","cc","./curve-sample.ts","./mesh-vertex.ts","./mesh-utility.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass,i=t.createForOfIteratorHelperLoose},function(t){o=t.cclegacy,r=t._decorator,s=t.Enum,a=t.Vec2,l=t.log,c=t.clamp,u=t.ModelComponent,h=t.Color,p=t.Component},function(t){d=t.default},function(t){f=t.default,g=t.MeshVertexFlags},function(t){m=t.default}],execute:function(){var v;t({AlignType:void 0,FillingMode:void 0,MirrorType:void 0,ValueType:void 0}),o._RF.push({},"e6d5cY/mT5Jf50xDNH6cOzK","mesh-bender",void 0);var y,b,C,_,E=r.ccclass,w=r.executeInEditMode;!function(t){t[t.Once=0]="Once",t[t.Repeat=1]="Repeat",t[t.StretchToInterval=2]="StretchToInterval"}(y||(y=t("FillingMode",{}))),s(y),function(t){t[t.None=0]="None",t[t.Top=1]="Top",t[t.Bottom=2]="Bottom",t[t.Right=3]="Right",t[t.Left=4]="Left"}(b||(b=t("AlignType",{}))),s(b),function(t){t[t.None=0]="None",t[t.Z=1]="Z",t[t.Y=2]="Y"}(C||(C=t("MirrorType",{}))),s(C),function(t){t[t.Absolute=0]="Absolute",t[t.Percent=1]="Percent"}(_||(_=t("ValueType",{}))),s(_);var S=new a,P=new a,M=0,T=0,k=0,N=0;function R(t){var e=t.source;switch(M=0,T=0,k=0,N=0,t.alignType){case b.None:break;case b.Top:N=t.alignOffset,T=-(e.minY+e.lengthY);break;case b.Bottom:N=t.alignOffset,T=-e.minY;break;case b.Right:k=t.alignOffset,M=-(e.minZ+e.lengthZ);break;case b.Left:k=t.alignOffset,M=-e.minZ}S.set(e.minZ+t.widthRange.x*e.lengthZ,e.minZ+t.widthRange.y*e.lengthZ),P.set(e.minY+t.heightRange.x*e.lengthY,e.minY+t.heightRange.y*e.lengthY)}function B(t,e,n,i){return(e=f.pool.get().set(e)).position.z=c(e.position.z,S.x,S.y),e.position.y=c(e.position.y,P.x,P.y),e.position.z+=M,e.position.y+=T,t.widthCurve&&(e.position.z*=t.widthCurve.evaluate(i,.5)),t.heightCurve&&(e.position.y*=t.heightCurve.evaluate(i,.5)),e.position.z+=k,e.position.y+=N,t.mirror===C.Y?e.position.y*=-1:t.mirror===C.Z&&(e.position.z*=-1),n.getBent(e,e)}function F(t,e,n,o){var r,s=e[0].flag;if(t.useCustomVertexColor){s|=g.Color,r=[];for(var a=0;a<e.length;a++)r.push(t.customVertexColor)}else r=s&g.Color&&e.map((function(t){return t.color}));t._vertexFlags=s,m.updateOrCreateModelMesh(t.getComponent(u),{positions:s&g.Position&&e.map((function(t){return t.position})),normals:s&g.Normal&&e.map((function(t){return t.normal})),tangents:s&g.Tangent&&e.map((function(t){return t.tangent})),uvs:s&g.UV&&e.map((function(t){return t.uv})),uv1s:s&g.UV1&&e.map((function(t){return t.uv1})),colors:r,indices:o||t.source.triangles});for(var l=0;l<e.length;l++)f.pool.put(e[l]);for(var c,h=i(n);!(c=h()).done;){var p=c.value;d.pool.put(p[1])}n.clear()}t("default",E(v=w(v=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).dirty=!1,e.result=null,e.useSpline=!1,e.spline=null,e.intervalStart=0,e.intervalEnd=0,e.curve=null,e._sampleCache=new Map,e._vertexFlags=0,e._source=null,e._mode=y.StretchToInterval,e._mirror=C.None,e._useCustomVertexColor=!1,e._customVertexColor=new h,e._offset=0,e._offsetValueType=_.Absolute,e._widthCurve=null,e._widthRange=new a(0,1),e._heightCurve=null,e._heightRange=new a(0,1),e._alignType=b.None,e._alignOffset=0,e}e(i,t);var o=i.prototype;return o.setInterval=function(t){if(this.curve!=t){if(null==t)throw new Error("curve");null!=this.curve&&this.curve.changed.removeListener(this.setDirty,this),this.curve=t,this.spline=null,t.changed.addListener(this.setDirty,this),this.useSpline=!1,this.dirty=!0}},o.setInterval1=function(t,e,n){if(void 0===n&&(n=0),this.spline!=t||this.intervalStart!=e||this.intervalEnd!=n){if(null==t)throw new Error("spline");if(e<0||e>=t.length)throw new Error("interval start must be 0 or greater and lesser than spline length (was "+e+")");if(0!=n&&n<=e||n>t.length)throw new Error("interval end must be 0 or greater than interval start, and lesser than spline length (was "+n+")");null!=this.spline&&this.spline.curveChanged.removeListener(this.setDirty,this),this.spline=t,t.curveChanged.addListener(this.setDirty,this),this.curve=null,this.intervalStart=e,this.intervalEnd=n,this.useSpline=!0,this.dirty=!0}},o.onEnable=function(){},o.update=function(){this.computeIfNeeded()},o.computeIfNeeded=function(){this.dirty&&this.compute()},o.setDirty=function(){this.dirty=!0},o.compute=function(){switch(this.dirty=!1,this.mode){case y.Once:this.fillOnce();break;case y.Repeat:this.fillRepeat();break;case y.StretchToInterval:this.fillStretch()}},o.onDestroy=function(){null!=this.curve&&this.curve.changed.removeListener(this.compute)},o.fillOnce=function(){var t=this._sampleCache,e=this.source,n=[];R(this);for(var i=this.calcOffset,o=0;o<e.vertices.length;o++){var r=e.vertices[o],s=r.position.x-e.minX+i,a=0==e.lengthX?0:Math.abs(r.position.x-e.minX)/e.lengthX,l=""+s,c=t.get(l);if(!c){if(this.useSpline){for(var u=this.intervalStart+s;u>this.spline.length;)u-=this.spline.length;c=this.spline.getSampleAtDistance(u)}else{if(s>this.curve.length)continue;c=this.curve.getSampleAtDistance(s,d.pool.get())}t.set(l,c)}r=B(this,r,c,a),n.push(r)}F(this,n,t)},o.fillRepeat=function(){for(var t=this.source,e=this.useSpline?(0==this.intervalEnd?this.spline.length:this.intervalEnd)-this.intervalStart:this.curve.length,n=Math.floor(e/t.lengthX),i=this._sampleCache,o=t.vertices,r=[],s=0;s<n+1;s++)for(var a=0;a<t.triangles.length;a++)r.push(t.triangles[a]+o.length*s);R(this);for(var l=[],c=this.calcOffset,u=0;u<n;u++){for(var h=0;h<o.length;h++){var p=o[h],f=p.position.x-t.minX+c,g=u+"_"+f,m=i.get(g);if(!m){if(this.useSpline){for(var v=this.intervalStart+f;v>this.spline.length;)v=this.spline.length;m=this.spline.getSampleAtDistance(v)}else{if(f>this.curve.length)continue;m=this.curve.getSampleAtDistance(f,d.pool.get())}i.set(g,m)}p=B(this,p,m,f/e),l.push(p)}c+=t.lengthX}for(var y=(this.useSpline?this.spline.length:this.curve.length)-c,b=0;b<o.length;b++){var C=o[b],_=0==t.lengthX?0:Math.abs(C.position.x-t.minX)/t.lengthX,E=c+_*y,w=""+E,S=i.get(w);if(!S){if(this.useSpline){for(var P=this.intervalStart+E;P>this.spline.length;)P=this.spline.length;S=this.spline.getSampleAtDistance(P)}else{if(E>this.curve.length)continue;S=this.curve.getSampleAtDistance(E,d.pool.get())}i.set(w,S)}C=B(this,C,S,_),l.push(C)}F(this,l,i,r)},o.fillStretch=function(){var t=[],e=this.source,n=this._sampleCache;R(this);for(var i=0;i<e.vertices.length;i++){var o=e.vertices[i],r=0==e.lengthX?0:Math.abs(o.position.x-e.minX)/e.lengthX,s=""+r,a=n.get(s);if(!a){if(this.useSpline){var c=0==this.intervalEnd?this.spline.length-this.intervalStart:this.intervalEnd-this.intervalStart,u=this.intervalStart+c*r;u>this.spline.length&&(u=this.spline.length,l("dist "+u+" spline length "+this.spline.length+" start "+this.intervalStart)),a=this.spline.getSampleAtDistance(u)}else a=this.curve.getSampleAtDistance(this.curve.length*r,d.pool.get());n.set(s,a)}o=B(this,o,a,r),t.push(o)}F(this,t,n)},n(i,[{key:"source",get:function(){return this._source},set:function(t){t!=this._source&&(this.dirty=!0,this._source=t)}},{key:"mode",get:function(){return this._mode},set:function(t){t!=this._mode&&(this.dirty=!0,this._mode=t)}},{key:"mirror",get:function(){return this._mirror},set:function(t){t!=this._mirror&&(this.dirty=!0,this._mirror=t)}},{key:"useCustomVertexColor",get:function(){return this._useCustomVertexColor},set:function(t){this._useCustomVertexColor=t,this.dirty=!0}},{key:"customVertexColor",get:function(){return this._customVertexColor},set:function(t){this._customVertexColor.set(t),this.dirty=!0}},{key:"offset",get:function(){return this._offset},set:function(t){this._offset=t,this.dirty=!0}},{key:"offsetValueType",get:function(){return this._offsetValueType},set:function(t){this._offsetValueType=t,this.dirty=!0}},{key:"length",get:function(){return this.useSpline?this.spline.length:this.curve.length}},{key:"calcOffset",get:function(){return this.offsetValueType===_.Absolute?this.offset:this.offset*this.length}},{key:"widthCurve",get:function(){return this._widthCurve},set:function(t){this._widthCurve=t,this.dirty=!0}},{key:"widthRange",get:function(){return this._widthRange},set:function(t){this._widthRange.set(t),this.dirty=!0}},{key:"heightCurve",get:function(){return this._heightCurve},set:function(t){this._heightCurve=t,this.dirty=!0}},{key:"heightRange",get:function(){return this._heightRange},set:function(t){this._heightRange.set(t),this.dirty=!0}},{key:"alignType",get:function(){return this._alignType},set:function(t){this._alignType=t,this.dirty=!0}},{key:"alignOffset",get:function(){return this._alignOffset},set:function(t){this._alignOffset=t,this.dirty=!0}}]),i}(p))||v)||v),o._RF.pop()}}})),System.register("chunks:///_virtual/mesh-tesselate.ts",["cc","./mesh-vertex.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.cclegacy,n=t.Vec3,i=t.Vec4,o=t.Vec2},function(t){r=t.default}],execute:function(){e._RF.push({},"bf32f8QiGBM0pOS/xpwz1v6","mesh-tesselate",void 0),t("default",{tessellate:function(t,e,s){void 0===s&&(s=0),s+=1;for(var a=[],l=function(e,s,a){return function(t,e){for(var n=0;n<e.length;n++)if(e[n].position.equals(t.position))return n;return e.push(t)-1}(function(t,e,s){void 0===s&&(s=.5);var a=r.pool.get();return n.lerp(a.position,t.position,e.position,s),n.lerp(a.normal,t.normal,e.normal,s),i.lerp(a.tangent,t.tangent,e.tangent,s),o.lerp(a.uv,t.uv,e.uv,s),a}(t[e],t[s],a),t)},c=0,u=e.length;c<u;c+=3){var h=e[c],p=e[c+1],d=e[c+2],f=l(h,p,1/s),g=l(h,d,1/s);a.push(h,f,g);for(var m=1;m<s;++m)for(var v=l(h,p,(m+1)/s),y=l(h,d,(m+1)/s),b=0;b<=m;++b)a.push(l(f,g,b/m),l(v,y,b/(m+1)),l(v,y,(b+1)/(m+1))),b<m&&a.push(l(f,g,b/m),l(v,y,(b+1)/(m+1)),l(f,g,(b+1)/m))}return a}}),e._RF.pop()}}})),System.register("chunks:///_virtual/mesh-tiling.ts",["./rollupPluginModLoBabelHelpers.js","cc","./spline-util-renderer.ts","./mesh-bender.ts","./source-mesh.ts","./spline.ts","./animation-curve.ts","./event.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.Vec3,c=t.Material,u=t.Mesh,h=t.CurveRange,p=t.Vec2,d=t.ModelComponent,f=t.Node,g=t.Quat,m=t.Color},function(t){v=t.default},function(t){y=t.FillingMode,b=t.ValueType,C=t.AlignType,_=t.MirrorType,E=t.default},function(t){w=t.default},function(t){S=t.default},function(t){P=t.default},function(t){M=t.default}],execute:function(){var T,k,N,R,B,F,L,A,D,x,I,U,z,G,H,O,V,j,W,Q,J,X,q,Y,Z,K,$,tt,et,nt,it,ot,rt,st,at,lt,ct,ut,ht,pt,dt,ft;s._RF.push({},"4a587hdoeRPaoMhtXF2Qk+F","mesh-tiling",void 0);var gt=a.ccclass,mt=a.executeInEditMode,vt=(a.float,a.type),yt=(a.boolean,a.property);new l,new l,t("default",(T=vt(c),k=vt(c),N=vt(u),R=vt(u),B=vt(l),F=vt(l),L=vt(l),A=yt({type:y}),D=vt(b),x=vt(b),I=vt(h),U=vt(h),z=vt(p),G=vt(p),H=vt(h),O=vt(h),V=vt(p),j=vt(p),W=vt(C),Q=vt(C),J=vt(_),X=vt(_),gt(q=mt((Z=e((Y=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"_material",Z,o(e)),i(e,"_mesh",K,o(e)),i(e,"_translation",$,o(e)),i(e,"_rotation",tt,o(e)),i(e,"_scale",et,o(e)),i(e,"_curveSpace",nt,o(e)),i(e,"_mode",it,o(e)),i(e,"_offset",ot,o(e)),i(e,"_offsetValueType",rt,o(e)),i(e,"_widthCurve",st,o(e)),i(e,"_widthRange",at,o(e)),i(e,"_heightCurve",lt,o(e)),i(e,"_heightRange",ct,o(e)),i(e,"_alignType",ut,o(e)),i(e,"_alignOffset",ht,o(e)),i(e,"_mirrorType",pt,o(e)),i(e,"_useCustomVertexColor",dt,o(e)),i(e,"_customVertexColor",ft,o(e)),e.onGenerateEvent=new M,e}n(e,t);var s=e.prototype;return s.compute=function(){if(this.mesh){var t=this.generated.children,e=0;if(this.splineCurve instanceof S)if(this.curveSpace)for(var n=this.spline.curves,i=0;i<n.length;i++)this._getOrcreate(e++,n[i]),this.mirror!==_.None&&this._getOrcreate(e++,n[i],this.mirror);else this._getOrcreate(e++,this.spline),this.mirror!==_.None&&this._getOrcreate(e++,this.spline,this.mirror);else this._getOrcreate(e++,this.splineCurve),this.mirror!==_.None&&this._getOrcreate(e++,this.splineCurve,this.mirror);if(t.length>e)for(var o=t.length-1;o>=e;o--)t[o].parent=null}},s._updateMaterials=function(){for(var t=this.generated.children,e=0;e<t.length;e++)t[e].getComponent(d).material=this.material},s._updateMode=function(){for(var t=this.generated.children,e=0;e<t.length;e++)t[e].getComponent(E).mode=this.mode},s._getOrcreate=function(t,e,n){void 0===n&&(n=_.None);var i=this.generated.children[t];i||((i=new f).parent=this.generated);var o=i.getComponent(E);o||(o=i.addComponent(E)),e instanceof S?o.setInterval1(e,0):o.setInterval(e);var r=this.translation,s=this.rotation,a=this.alignOffset;o.source=w.build(this.mesh).translate(r).rotate(g.fromEuler(new g,s.x,s.y,s.z)).scaleRes(this.scale),o.mode=this.mode,o.offset=this.offset,o.offsetValueType=this.offsetValueType,o.widthCurve=this.widthCurve,o.widthRange=this.widthRange,o.heightCurve=this.heightCurve,o.heightRange=this.heightRange,o.alignType=this.alignType,o.alignOffset=a,o.customVertexColor=this.customVertexColor,o.useCustomVertexColor=this.useCustomVertexColor,o.mirror=n,n===_.Z?(o.alignOffset*=-1,o.alignType===C.Left?o.alignType=C.Right:o.alignType===C.Right&&(o.alignType=C.Left)):n===_.Y&&(o.alignOffset*=-1,o.alignType===C.Top?o.alignType=C.Bottom:o.alignType===C.Bottom&&(o.alignType=C.Top));var l=i.getComponent(d);return l||((l=i.addComponent(d)).material=this.material),o.update(),this.onGenerateEvent.invoke(i),i},r(e,[{key:"material",get:function(){return this._material},set:function(t){this._material=t,this._updateMaterials()}},{key:"mesh",get:function(){return this._mesh},set:function(t){this._mesh=t,this.reset()}},{key:"translation",get:function(){return this._translation},set:function(t){this._translation=t,this.reset()}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.reset()}},{key:"scale",get:function(){return this._scale},set:function(t){this._scale=t,this.reset()}},{key:"curveSpace",get:function(){return this._curveSpace},set:function(t){this._curveSpace=t,this.onCurveChanged()}},{key:"mode",get:function(){return this._mode},set:function(t){t!=this._mode&&(this._mode=t,this._updateMode())}},{key:"offset",get:function(){return this._offset},set:function(t){this._offset=t,this.onCurveChanged()}},{key:"offsetValueType",get:function(){return this._offsetValueType},set:function(t){this._offsetValueType=t,this.onCurveChanged()}},{key:"widthCurve",get:function(){return this._widthCurve},set:function(t){this._widthCurve=t,this.dirty=!0}},{key:"widthRange",get:function(){return this._widthRange},set:function(t){this._widthRange=t,this.dirty=!0}},{key:"heightCurve",get:function(){return this._heightCurve},set:function(t){this._heightCurve=t,this.dirty=!0}},{key:"heightRange",get:function(){return this._heightRange},set:function(t){this._heightRange=t,this.dirty=!0}},{key:"alignType",get:function(){return this._alignType},set:function(t){this._alignType=t,this.dirty=!0}},{key:"alignOffset",get:function(){return this._alignOffset},set:function(t){this._alignOffset=t,this.dirty=!0}},{key:"mirror",get:function(){return this._mirrorType},set:function(t){this._mirrorType=t,this.dirty=!0}},{key:"useCustomVertexColor",get:function(){return this._useCustomVertexColor},set:function(t){this._useCustomVertexColor=t,this.dirty=!0}},{key:"customVertexColor",get:function(){return this._customVertexColor},set:function(t){this._customVertexColor.set(t),this._useCustomVertexColor&&(this.dirty=!0)}}]),e}(v)).prototype,"_material",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),e(Y.prototype,"material",[k],Object.getOwnPropertyDescriptor(Y.prototype,"material"),Y.prototype),K=e(Y.prototype,"_mesh",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),e(Y.prototype,"mesh",[R],Object.getOwnPropertyDescriptor(Y.prototype,"mesh"),Y.prototype),$=e(Y.prototype,"_translation",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l}}),e(Y.prototype,"translation",[B],Object.getOwnPropertyDescriptor(Y.prototype,"translation"),Y.prototype),tt=e(Y.prototype,"_rotation",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l}}),e(Y.prototype,"rotation",[F],Object.getOwnPropertyDescriptor(Y.prototype,"rotation"),Y.prototype),et=e(Y.prototype,"_scale",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return l.ONE.clone()}}),e(Y.prototype,"scale",[L],Object.getOwnPropertyDescriptor(Y.prototype,"scale"),Y.prototype),nt=e(Y.prototype,"_curveSpace",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(Y.prototype,"curveSpace",[yt],Object.getOwnPropertyDescriptor(Y.prototype,"curveSpace"),Y.prototype),it=e(Y.prototype,"_mode",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return y.Repeat}}),e(Y.prototype,"mode",[A],Object.getOwnPropertyDescriptor(Y.prototype,"mode"),Y.prototype),ot=e(Y.prototype,"_offset",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(Y.prototype,"offset",[yt],Object.getOwnPropertyDescriptor(Y.prototype,"offset"),Y.prototype),rt=e(Y.prototype,"_offsetValueType",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return b.Absolute}}),e(Y.prototype,"offsetValueType",[x],Object.getOwnPropertyDescriptor(Y.prototype,"offsetValueType"),Y.prototype),st=e(Y.prototype,"_widthCurve",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.one()}}),e(Y.prototype,"widthCurve",[U],Object.getOwnPropertyDescriptor(Y.prototype,"widthCurve"),Y.prototype),at=e(Y.prototype,"_widthRange",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new p(0,1)}}),e(Y.prototype,"widthRange",[G],Object.getOwnPropertyDescriptor(Y.prototype,"widthRange"),Y.prototype),lt=e(Y.prototype,"_heightCurve",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.one()}}),e(Y.prototype,"heightCurve",[O],Object.getOwnPropertyDescriptor(Y.prototype,"heightCurve"),Y.prototype),ct=e(Y.prototype,"_heightRange",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new p(0,1)}}),e(Y.prototype,"heightRange",[j],Object.getOwnPropertyDescriptor(Y.prototype,"heightRange"),Y.prototype),ut=e(Y.prototype,"_alignType",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return C.None}}),e(Y.prototype,"alignType",[Q],Object.getOwnPropertyDescriptor(Y.prototype,"alignType"),Y.prototype),ht=e(Y.prototype,"_alignOffset",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(Y.prototype,"alignOffset",[yt],Object.getOwnPropertyDescriptor(Y.prototype,"alignOffset"),Y.prototype),pt=e(Y.prototype,"_mirrorType",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return _.None}}),e(Y.prototype,"mirror",[X],Object.getOwnPropertyDescriptor(Y.prototype,"mirror"),Y.prototype),dt=e(Y.prototype,"_useCustomVertexColor",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(Y.prototype,"useCustomVertexColor",[yt],Object.getOwnPropertyDescriptor(Y.prototype,"useCustomVertexColor"),Y.prototype),ft=e(Y.prototype,"_customVertexColor",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new m}}),e(Y.prototype,"customVertexColor",[yt],Object.getOwnPropertyDescriptor(Y.prototype,"customVertexColor"),Y.prototype),q=Y))||q)||q)),s._RF.pop()}}})),System.register("chunks:///_virtual/mesh-utility.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.createForOfIteratorHelperLoose},function(t){n=t.utils,i=t.cclegacy,o=t.gfx,r=t.ValueType}],execute:function(){i._RF.push({},"77f161VtwtBR7xMTl4loQCo","mesh-utility",void 0);var s={positions:{size:3,gfxName:o.AttributeName.ATTR_POSITION},normals:{size:3,gfxName:o.AttributeName.ATTR_NORMAL},uvs:{size:2,gfxName:o.AttributeName.ATTR_TEX_COORD},tangents:{size:4,gfxName:o.AttributeName.ATTR_TANGENT}},a={tagent:{name:o.AttributeName.ATTR_TANGENT,format:o.Format.RGBA32F}};function l(t){if(t&&void 0!==t[0]&&t[0]instanceof r){for(var e=[],n=0,i=t.length;n<i;n++){var o=t[n];o.constructor.toArray(e,o,e.length)}return e}return t}function c(t,i,r,s,a){for(var l,c=t.struct.vertexBundles[0].attributes,u=0,h=o.Format.UNKNOWN,p=e(c);!(l=p()).done;){var d=l.value;if(d.name===i){h=d.format;break}u+=o.FormatInfos[d.format].size}n.writeBuffer(new DataView(s),r,h,u,a)}t("default",{getReversedTriangles:function(t,e){void 0===e&&(e=0);var n=[];t.copyIndices(e,n);for(var i=n.length/3,o=0;o<i;o++){var r=n[3*o];n[3*o]=n[3*o+1],n[3*o+1]=r}return n},createMesh:function(t){for(var e in(t=Object.assign({},t)).primitiveMode=t.primitiveType,s)t[e]&&(t[e]=l(t[e]));return t.tangents&&(t.customAttributes=[{attr:a.tagent,values:t.tangents}]),n.createMesh(t)},updateMesh:function(t,e){var n=t.mesh;for(var i in(e=Object.assign({},e)).primitiveMode=e.primitiveType,s)e[i]&&(e[i]=l(e[i]));var o=n.renderingSubMeshes[0],r=o.vertexBuffers[0],a=function(t){var e=Number.MAX_SAFE_INTEGER;for(var n in s)t[n]&&(e=Math.min(t[n].length/s[n].size,e));return e}(e),u=r.stride*a,h=r.vbuffer;if(h&&h.length===u)for(var p in s)e[p]&&c(n,s[p].gfxName,e[p],h.buffer,r.stride);else{for(var d in h=r.vbuffer=new Uint8Array(u),s)e[d]&&c(n,s[d].gfxName,e[d],h.buffer,r.stride);r.resize(u)}if(r.update(h.buffer),e.indices){var f=o.indexBuffer,g=function(t){return t.indices?t.indices.length:0}(e),m=f.ibuffer;if(!m||m.length!==g){var v=1===f.stride?Uint8Array:2===f.stride?Uint16Array:Uint32Array;m=f.ibuffer=new v(g),f.resize(g*f.stride)}m.set(e.indices),f.update(m.buffer);var y=t.model&&t.model.subModels[0];if(y){var b=y.inputAssembler;b&&(b.vertexCount=a,b.indexCount=g,y.update())}}},updateOrCreateModelMesh:function(t,e){t.mesh?this.updateMesh(t,e):t.mesh=this.createMesh(e)}}),i._RF.pop()}}})),System.register("chunks:///_virtual/mesh-vertex.ts",["./rollupPluginModLoBabelHelpers.js","cc","./pool.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.createClass,i=t.initializerDefineProperty},function(t){o=t.cclegacy,r=t._decorator,s=t.Vec3,a=t.Vec2,l=t.Vec4,c=t.Color},function(t){u=t.Pool}],execute:function(){var h,p,d,f,g,m,v,y,b;t("MeshVertexFlags",void 0),o._RF.push({},"a0f00WqATFBO554BJ62A8gf","mesh-vertex",void 0);var C,_=r.ccclass,E=r.property;!function(t){t[t.None=0]="None",t[t.Position=1]="Position",t[t.Normal=2]="Normal",t[t.Tangent=4]="Tangent",t[t.UV=8]="UV",t[t.UV1=16]="UV1",t[t.Color=32]="Color"}(C||(C=t("MeshVertexFlags",{}))),t("default",_("MeshVertex")(((b=function(){function t(){i(this,"position",d,this),i(this,"normal",f,this),i(this,"tangent",g,this),i(this,"uv",m,this),i(this,"uv1",v,this),i(this,"color",y,this),this.flag=0}t.create=function(e,n,i,o,r,s){var a=new t;return a.set(e,n,i,o,r,s),a};var e=t.prototype;return e.set=function(e,n,i,o,r,u){if(e instanceof t){var h=e;this.position.set(h.position),this.normal.set(h.normal),this.uv.set(h.uv),this.uv1.set(h.uv1),this.tangent.set(h.tangent),this.color.set(h.color),this.flag=h.flag}else{var p=0;e&&(p|=C.Position,this.position.set(s.ZERO)),n&&(p|=C.Normal,this.normal.set(s.ZERO)),i&&(p|=C.UV,this.uv.set(a.ZERO)),u&&(p|=C.UV1,this.uv1.set(a.ZERO)),o&&(p|=C.Tangent,this.tangent.set(l.ZERO)),r&&(p|=C.Color,this.color.set(c.WHITE)),this.flag=p}return this},e.reset=function(){this.position.set(s.ZERO),this.normal.set(s.ZERO),this.uv.set(a.ZERO),this.uv1.set(a.ZERO),this.tangent.set(l.ZERO),this.color.set(c.WHITE),this.flag=0},n(t,null,[{key:"pool",get:function(){return this._pool||(this._pool=new u(t)),this._pool}}]),t}())._pool=void 0,d=e((p=b).prototype,"position",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s}}),f=e(p.prototype,"normal",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new s}}),g=e(p.prototype,"tangent",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l}}),m=e(p.prototype,"uv",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new a}}),v=e(p.prototype,"uv1",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new a}}),y=e(p.prototype,"color",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c}}),h=p))||h),o._RF.pop()}}})),System.register("chunks:///_virtual/MotoEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./GlobalSingle.ts","./AudioManager.ts","./Constant.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.Quat},function(t){c=t.ecs},function(t){u=t.CCComp},function(t){h=t.GlobalSingle},function(t){p=t.default},function(t){d=t.Sounds}],execute:function(){var f,g,m,v,y,b,C,_;r._RF.push({},"bc2c2FxbW5JNrEVAZuLQHYk","MotoEntity",void 0);var E=s.ccclass,w=s.property;t("MotoEntity",(f=E("MotoEntity"),g=c.register("MotoEntity",!1),m=w(a),v=w(a),f(y=g((C=e((b=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"BackWheel_F",C,o(e)),i(e,"BackWheel_B",_,o(e)),e._aQuat=new l,e.audioPlaying=!1,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){p.instance.stopSoundEffect(d.MotorIdle),this.audioPlaying=!1},r.onEnable=function(){},r.update=function(){h.instance.joystickMoving&&this.BackWheel_F&&this.BackWheel_B&&(l.rotateX(this._aQuat,this.BackWheel_F.getRotation(),.2),this.BackWheel_F.setRotation(this._aQuat),l.rotateX(this._aQuat,this.BackWheel_B.getRotation(),.2),this.BackWheel_B.setRotation(this._aQuat)),this.audioPlaying?h.instance.joystickMoving||(p.instance.stopSoundEffect(d.MotorIdle),this.audioPlaying=!1):h.instance.joystickMoving&&(this.audioPlaying=!0,p.instance.playSoundEffect(d.MotorIdle,!0))},r.onDisable=function(){p.instance.stopSoundEffect(d.MotorIdle),this.audioPlaying=!1},e}(u)).prototype,"BackWheel_F",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(b.prototype,"BackWheel_B",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=b))||y)||y)),r._RF.pop()}}})),System.register("chunks:///_virtual/NavMesh.ts",["./rollupPluginModLoBabelHelpers.js","cc","./recast.mjs_cjs=&original=.js","./recast.js"],(function(t){var e,n,i,o,r,s,a,l,c,u;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,i=t._decorator,o=t.MeshRenderer,r=t.Vec3,s=t.gfx,a=t.math,l=t.geometry,c=t.resources},null,function(t){u=t.default}],execute:function(){var h;t("MeshDebugDataType",void 0),n._RF.push({},"bd5f4A/A2xDaLznJLaUgQdf","NavMesh",void 0);var p,d=i.ccclass,f=(i.property,t("NavMeshMgr",d("NavMeshMgr")(h=function(){function t(){this._recast=null,this._navMesh=null,this._config=null,this._positions=[],this._indices=[],this._timeStep=1/60,this._tempVec=void 0,this._tempVec1=void 0,this._tempVec2=void 0}var n=t.prototype;return n.init=function(t){void 0===t&&(t=null),this._recast=new u,this._navMesh=new this._recast.NavMesh,this._tempVec=new this._recast.Vec3,this._tempVec1=new this._recast.Vec3,this._tempVec2=new this._recast.Vec3,this.setDefaultConfig(),t&&t()},n.setConfig=function(t){this._config=t},n.setDefaultConfig=function(){this._config={tileSize:0,borderSize:1,cs:.2,ch:.2,walkableSlopeAngle:90,walkableHeight:1,walkableClimb:1,walkableRadius:1,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1}},n.addStaticModle=function(t){if(t&&t.getComponent(o)){var e=t.getComponent(o);if(e&&e.mesh){var n=t.getWorldMatrix();this.updateBaseDatas(e.mesh,n)}}},n.addTerrain=function(t){for(var e=[],n=t.node.getWorldMatrix(),i=t.getBlocks(),o=0;o<i.length;o++){var r=this.getTerrainMeshData(t,i[o],n);e=e.concat(r)}this.mergeVector(e)},n.getTerrainMeshData=function(t,e,n){for(var i=[],o=e.getIndex(),s=32,a=1;a<33;++a)for(var l=1;l<33;++l){var c=o[0]*s+(l-1),u=o[1]*s+(a-1),h=new r(1,1,1);r.transformMat4(h,t.getPosition(c,u),n),c=o[0]*s+(l-1),u=o[1]*s+a;var p=new r(1,1,1);r.transformMat4(p,t.getPosition(c,u),n),c=o[0]*s+l,u=o[1]*s+(a-1);var d=new r(1,1,1);r.transformMat4(d,t.getPosition(c,u),n),c=o[0]*s+l,u=o[1]*s+a;var f=new r(1,1,1);r.transformMat4(f,t.getPosition(c,u),n),i.push(h),i.push(p),i.push(f),i.push(h),i.push(f),i.push(d)}return i},n.updateBaseDatas=function(t,e){for(var n=t.readAttribute(0,s.AttributeName.ATTR_POSITION),i=[],o=0;o<n.length;o++)i.push(n[o]);var a=[];t.copyIndices(0,a);var l=[];if(a.length>0)for(var c=0;c<a.length;c++){var u=3*a[c];l.push(i[u]),l.push(i[u+1]),l.push(i[u+2])}else l=i;for(var h=[],p=new r(1,1,1),d=0;d<l.length;d+=3)p=new r(l[d],l[d+1],l[d+2]),r.transformMat4(p,p,e),h.push(p);this.mergeVector(h)},n.mergeVector=function(t){for(var e=this._positions.length/3,n=0;n<t.length;n+=3){for(var i,o=[t[n],t[n+1],t[n+2]],r=0;r<o.length;r++)this._positions.push(o[r].x),this._positions.push(o[r].y),this._positions.push(o[r].z);var s=[e,e+1,e+2];(i=this._indices).push.apply(i,s),e=this._positions.length/3}},n.clean=function(){this._positions=[],this._indices=[]},n.build=function(){var t=new this._recast.rcConfig;t.cs=this._config.cs,t.ch=this._config.ch,t.borderSize=this._config.borderSize,t.tileSize=this._config.tileSize,t.walkableSlopeAngle=this._config.walkableSlopeAngle,t.walkableHeight=this._config.walkableHeight,t.walkableClimb=this._config.walkableClimb,t.walkableRadius=this._config.walkableRadius,t.maxEdgeLen=this._config.maxEdgeLen,t.maxSimplificationError=this._config.maxSimplificationError,t.minRegionArea=this._config.minRegionArea,t.mergeRegionArea=this._config.mergeRegionArea,t.maxVertsPerPoly=this._config.maxVertsPerPoly,t.detailSampleDist=this._config.detailSampleDist,t.detailSampleMaxError=this._config.detailSampleMaxError;var e=(new Date).getTime();this._navMesh.build(this._positions,this._positions.length/3,this._indices,this._indices.length,t),console.log("_navMesh.build 耗时："+((new Date).getTime()-e)/1e3+"s")},n.getNavMeshDebugData=function(t){void 0===t&&(t=p.SURFACE);var e,n,i=this._navMesh.getDebugNavMesh(),o=i.getTriangleCount(),s=[],a=[];for(e=0;e<3*o;e++)s.push(e);for(e=0;e<o;e++)for(n=0;n<3;n++){var l=i.getTriangle(e).getPoint(n);a.push(l.x,l.y,l.z)}for(var c=[],u=0;u<s.length;u++){var h=3*s[u],d=new r(a[h],a[h+1],a[h+2]);c.push(d)}return t==p.SURFACE?this.getNavMeshDebugSurfaceData(c):this.getNavMeshDebugLineData(c)},n.getNavMeshDebugSurfaceData=function(t){for(var e=[],n=[],i=0;i<t.length;i+=3){var o=[t[i],t[i+1],t[i+2]];r.subtract(new r,o[0],o[1]).cross(r.subtract(new r,o[2],o[1])).y>0&&(o=o.reverse());for(var s=0;s<o.length;s++)e.push(o[s].x),e.push(o[s].y),e.push(o[s].z),n.push(0),n.push(1),n.push(0)}return{positions:e,normals:n}},n.getNavMeshDebugLineData=function(t,e){void 0===e&&(e=.02);for(var n=[],i=[],o=0;o<t.length;o+=3){var s=[t[o],t[o+1],t[o+2]];r.subtract(new r,s[0],s[1]).cross(r.subtract(new r,s[2],s[1])).y>0&&(s=s.reverse());for(var c=e/2,u=a.toRadian(90),h=0;h<s.length;h++){var p=s[h].clone(),d=s[h+1>=s.length?0:h+1].clone(),f=new l.Ray;l.Ray.fromPoints(f,p,d);var g=new r;f.computeHit(g,c);var m=r.rotateY(new r,g,p,-u),v=r.rotateY(new r,g,p,u);l.Ray.fromPoints(f,d,p),f.computeHit(g,c);var y=r.rotateY(new r,g,d,u),b=r.rotateY(new r,g,d,-u),C=[m,y,v],_=r.subtract(new r,C[0],C[1]).cross(r.subtract(new r,C[2],C[1]));_.y>0&&(C=C.reverse());for(var E=0;E<C.length;E++)n.push(C[E].x),n.push(C[E].y),n.push(C[E].z),i.push(0),i.push(1),i.push(0);C=[],C=[y,b,v],(_=r.subtract(new r,C[0],C[1]).cross(r.subtract(new r,C[2],C[1]))).y>0&&(C=C.reverse());for(var w=0;w<C.length;w++)n.push(C[w].x),n.push(C[w].y),n.push(C[w].z),i.push(0),i.push(1),i.push(0)}}return{positions:n,normals:i}},n.getNavMeshData=function(){var t=this._navMesh.getNavmeshData(),e=new Uint8Array(this._recast.HEAPU8.buffer,t.dataPointer,t.size),n=new Uint8Array(t.size);return n.set(e),this.navMesh.freeNavmeshData(t),n},n.loadNavMeshData=function(t,e){c.load(t,(function(t,n){if(t)return console.log("err :",t),void(e&&e(null));var i=n.buffer(),o=new Uint8Array(i);e&&e(o)}))},n.buildFromNavMeshData=function(t){var e=t.length*t.BYTES_PER_ELEMENT,n=this._recast._malloc(e),i=new Uint8Array(this._recast.HEAPU8.buffer,n,e);i.set(t);var o=new this._recast.NavmeshData;o.dataPointer=i.byteOffset,o.size=t.length,this.navMesh.buildFromNavmeshData(o),this._recast._free(i.byteOffset)},n.findPath=function(t,e){var n=this.getClosestPoint(t);this._tempVec1.x=n.x,this._tempVec1.y=n.y,this._tempVec1.z=n.z;var i=this.getClosestPoint(e);this._tempVec2.x=i.x,this._tempVec2.y=i.y,this._tempVec2.z=i.z;for(var o=this._navMesh.computePath(this._tempVec1,this._tempVec2),s=o.getPointCount(),a=[],l=0;l<s;l++){var c=o.getPoint(l);a.push(new r(c.x,c.y,c.z))}return a},n.getClosestPoint=function(t){this._tempVec.x=t.x,this._tempVec.y=t.y,this._tempVec.z=t.z;var e=this._navMesh.getClosestPoint(this._tempVec);return new r(e.x,e.y,e.z)},n.initCrowd=function(t,e){return new f(this,t,e)},n.setTimeStep=function(t){void 0===t&&(t=1/60),this._timeStep=t},n.getTimeStep=function(){return this._timeStep},n.addCylinderObstacle=function(t,e,n){return this._tempVec1.x=t.x,this._tempVec1.y=t.y,this._tempVec1.z=t.z,this.navMesh.addCylinderObstacle(this._tempVec1,e,n)},n.addBoxObstacle=function(t,e,n){return this._tempVec1.x=t.x,this._tempVec1.y=t.y,this._tempVec1.z=t.z,this._tempVec2.x=e.x,this._tempVec2.y=e.y,this._tempVec2.z=e.z,this.navMesh.addBoxObstacle(this._tempVec1,this._tempVec2,n)},n.removeObstacle=function(t){this.navMesh.removeObstacle(t)},n.update=function(t){this._navMesh&&this._navMesh.update(t)},e(t,[{key:"recast",get:function(){return this._recast}},{key:"navMesh",get:function(){return this._navMesh}}]),t}())||h),t("NavMeshCorwd",function(){function t(t,e,n){this._navMeshMgr=null,this._recastCrowd={},this._agents=[],this._tempVec=void 0,this._navMeshMgr=t,this._tempVec=new t.recast.Vec3,this._recastCrowd=new this._navMeshMgr.recast.Crowd(e,n,this._navMeshMgr.navMesh.getNavMesh())}var e=t.prototype;return e.addAgent=function(t,e){var n=new this._navMeshMgr.recast.dtCrowdAgentParams;n.radius=e.radius,n.height=e.height,n.maxAcceleration=e.maxAcceleration,n.maxSpeed=e.maxSpeed,n.collisionQueryRange=e.collisionQueryRange,n.pathOptimizationRange=e.pathOptimizationRange,n.separationWeight=e.separationWeight,n.updateFlags=0,n.obstacleAvoidanceType=3,n.queryFilterType=0,n.userData=0;var i=this._recastCrowd.addAgent(new this._navMeshMgr.recast.Vec3(t.x,t.y,t.z),n);return this._agents.push(i),i},e.getAgentPosition=function(t){var e=this._recastCrowd.getAgentPosition(t);return new r(e.x,e.y,e.z)},e.getAgentNextTargetPath=function(t){var e=this._recastCrowd.getAgentNextTargetPath(t);return new r(e.x,e.y,e.z)},e.getAgentVelocity=function(t){var e=this._recastCrowd.getAgentVelocity(t);return new r(e.x,e.y,e.z)},e.agentMoveTarget=function(t,e){this._tempVec.x=e.x,this._tempVec.y=e.y,this._tempVec.z=e.z,this._recastCrowd.agentGoto(t,this._tempVec)},e.agentTeleport=function(t,e){this._recastCrowd.agentTeleport(t,new this._navMeshMgr.recast.Vec3(e.x,e.y,e.z))},e.removeAgent=function(t){this._recastCrowd.removeAgent(t)},e.getAgents=function(){return this._agents},e.update=function(t){this._recastCrowd.update(t)},e.destroy=function(){this._recastCrowd.destroy()},t}()));!function(t){t[t.SURFACE=0]="SURFACE",t[t.LINE=1]="LINE"}(p||(p=t("MeshDebugDataType",{}))),n._RF.pop()}}})),System.register("chunks:///_virtual/NavMeshEditor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NavMesh.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.CCString,c=t.CCBoolean,u=t.MeshRenderer,h=t.utils,p=t.gfx,d=t.Component},function(t){f=t.NavMeshMgr,g=t.MeshDebugDataType}],execute:function(){var m,v,y,b,C,_,E;s._RF.push({},"dbc88Gt5n9EYbM5uYJmpvcG","NavMeshEditor",void 0);var w=a.ccclass,S=a.property,P=a.executeInEditMode;t("NavMeshEditor",(m=w("NavMeshEditor"),v=S({type:l,tooltip:"保存路径",displayName:"保存数据:  db//assest//"}),y=S({type:c,tooltip:"保存navmesh 数据",displayName:"保存数据"}),m(b=P((_=e((C=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"_path",_,o(e)),i(e,"_saveData",E,o(e)),e._navMeshMgr=null,e._navMeshData=null,e}n(e,t);var s=e.prototype;return s.onLoad=function(){this._saveData=!1},s.start=function(){this._navMeshMgr=new f,this._navMeshMgr.init(),this.setNavMeshConfig(),this.startNavMesh()},s.startNavMesh=function(){for(var t=this.node.children,e=0;e<t.length;e++)this._navMeshMgr.addStaticModle(t[e]),t[e].active=!1;this._navMeshMgr.build();var n=this._navMeshMgr.getNavMeshDebugData(g.LINE);this.createDebugMesh(n.positions,n.normals),this._navMeshData=this._navMeshMgr.getNavMeshData()},s.setNavMeshConfig=function(){this._navMeshMgr.setConfig({cs:.1,ch:.047,tileSize:.1,borderSize:0,walkableSlopeAngle:60,walkableHeight:100,walkableClimb:5,walkableRadius:.5,maxEdgeLen:10,maxSimplificationError:1,minRegionArea:3,mergeRegionArea:8,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:.1})},s.createDebugMesh=function(t,e){var n=this.node.getComponent(u);n||(n=this.node.addComponent(u));var i=h.createMesh({positions:t,primitiveMode:p.PrimitiveMode.TRIANGLE_LIST,normals:e});n.mesh=i},s.saveNavMeshData=function(){var t=this.path.lastIndexOf(".");if(-1===t)this.path+=".bin";else if("bin"!==this.path.substring(t+1))return void console.warn("save data fail，  .bin file");Editor.Message.send("asset-db","create-asset","db://assets/"+this._path,this._navMeshData)},r(e,[{key:"path",get:function(){return this._path},set:function(t){this._path=t}},{key:"saveData",get:function(){return this._saveData},set:function(t){!0===t&&this.saveNavMeshData(),this._saveData=!1}}]),e}(d)).prototype,"_path",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"resources/scene/"}}),e(C.prototype,"path",[v],Object.getOwnPropertyDescriptor(C.prototype,"path"),C.prototype),E=e(C.prototype,"_saveData",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),e(C.prototype,"saveData",[y],Object.getOwnPropertyDescriptor(C.prototype,"saveData"),C.prototype),b=C))||b)||b)),s._RF.pop()}}})),System.register("chunks:///_virtual/NavToComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalSingle.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator},function(t){r=t.GlobalSingle},function(t){s=t.ecs}],execute:function(){var a;t("DestPosType",void 0),i._RF.push({},"73884dR/JJGmqYP68BY2lEg","NavToComp",void 0);var l,c=o.ccclass;o.property,function(t){t.GunBox="GunBox",t.Rescue="Medic",t.RescueBack="MedicBack"}(l||(l=t("DestPosType",{}))),t("NavToComp",c("NavToComp")(a=s.register("NavToComp")(a=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).needNavNode=null,e.agentIndex=null,e._destPos=null,e.destPosArry=[],e.navTime=0,e}e(i,t);var o=i.prototype;return o.reset=function(){this.needNavNode=null,null!=this.agentIndex&&(r.instance.navMeshCrowd.removeAgent(this.agentIndex),this.agentIndex=null),this.destPos=null,this.destPosArry=[]},o.startNavToDest=function(){var t=this;this.destPos&&(this.navTime=(new Date).getTime(),null!=this.agentIndex&&(r.instance.navMeshCrowd.removeAgent(this.agentIndex),this.agentIndex=null),null==this.agentIndex&&(this.agentIndex=this.addPlayerAgent(this.needNavNode.worldPosition)),null!=this.agentIndex?r.instance.navMeshCrowd.agentMoveTarget(this.agentIndex,this.destPos.worldPos):setTimeout((function(){t.startNavToDest()}),500))},o.addPlayerAgent=function(t){if(r.instance.navMeshCrowd){var e=r.instance.navMeshMgr.getClosestPoint(t);return r.instance.navMeshCrowd.addAgent(e,{radius:.6,height:.1,maxAcceleration:10,maxSpeed:5,collisionQueryRange:.6*3,pathOptimizationRange:.1,separationWeight:0})}return null},o.findPath=function(t,e){return r.instance.navMeshMgr.findPath(t,e)},n(i,[{key:"destPos",get:function(){return this._destPos},set:function(t){this._destPos=t,this.startNavToDest()}}]),i}(s.Comp))||a)||a),i._RF.pop()}}})),System.register("chunks:///_virtual/NavToSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./EventManager.ts","./MedicComp.ts","./NavToComp.ts","./RoleAnimComp.ts","./RoleComp.ts","./SoldierComp.ts","./GunFactoryEntity.ts","./MedicEntity.ts","./MedicStretcherEntity.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Vec3,s=t.Quat,a=t.v3},function(t){l=t.GameState,c=t.GameEvent},function(t){u=t.GlobalSingle},function(t){h=t.StorageData},function(t){p=t.EventManager},function(t){d=t.MedicComp},function(t){f=t.NavToComp,g=t.DestPosType},function(t){m=t.RoleAnimComp},function(t){v=t.RoleComp},function(t){y=t.SoldierComp},function(t){b=t.GunFactoryEntity},function(t){C=t.MedicEntity},function(t){_=t.MedicStretcherEntity},function(t){E=t.RoleEntity},function(t){w=t.ecs}],execute:function(){var S;i._RF.push({},"ba70aoay35A6avKsaSZKiM9","NavToSys",void 0);var P=o.ccclass;t("NavToSys",P("NavToSys")(S=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).entities=[],e._moveDir=new r,e._dirQuat=new s,e._agentPosition=new r,e}e(i,t);var o=i.prototype;return o.init=function(){this.registerEvent()},o.filter=function(){return w.allOf(f)},o.entityEnter=function(t){this.entities=w.query(w.allOf(f));for(var e,i=n(t);!(e=i()).done;){var o=e.value.get(m);o&&o.run()}},o.firstUpdate=function(t){},o.entityRemove=function(t){this.entities=w.query(w.allOf(f))},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value,c=o.get(m),p=o.get(f);if(u.instance.navMeshCrowd){if(this._agentPosition=u.instance.navMeshCrowd.getAgentPosition(p.agentIndex),this._agentPosition.y=p.needNavNode.worldPosition.y,r.subtract(this._moveDir,this._agentPosition,p.needNavNode.worldPosition),p.needNavNode.setWorldPosition(this._agentPosition),s.fromViewUp(this._dirQuat,this._moveDir,r.UP),p.needNavNode.setRotation(this._dirQuat),r.distance(p.needNavNode.worldPosition,p.destPos.worldPos)<.6){if(p.destPos.type==g.GunBox&&p.destPos.target){var d=p.destPos.target.getComponent(b).getGunByGunBox();d&&p.needNavNode.getComponent(E).switchGun(d)}p.destPos.type==g.Rescue&&p.destPos.target&&(p.destPos.target.parent=p.needNavNode.getComponent(_).Wounded,p.destPos.target.setPosition(a(0,0,0)),p.destPos.target.setRotationFromEuler(a(0,0,0))),p.destPos.type==g.RescueBack&&p.destPos.target&&p.destPos.target.getComponent(C).unloadWounded(),p.destPosArry.length>0?p.destPos=p.destPosArry.shift():(h.instance.status==l.ready&&p.needNavNode.setRotationFromEuler(a(0,180,0)),c&&c.idle(),o.remove(f))}o.has(y)&&((new Date).getTime()-p.navTime)/1e3>10&&o.remove(f)}}},o.registerEvent=function(){p.instance.on(c.StatusEvent,this.statusChangeFun,this)},o.statusChangeFun=function(t){if(h.instance.status==l.win||h.instance.status==l.battle)for(var e,i=n(this.entities);!(e=i()).done;){var o=e.value;if(!o.has(d)){o.remove(f);var r=o.get(v),s=o.get(m);r&&r.currentHp>0&&s&&(r.lastNavTime=60,s.idle())}}},i}(w.ComblockSystem))||S),i._RF.pop()}}})),System.register("chunks:///_virtual/NBombComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"c6e5aiTCANCBZRcW+ap+44/","NBombComp",void 0);var s=i.ccclass;i.property,t("NBombComp",s("NBombComp")(r=o.register("NBombComp")(r=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).flyNode=null,e.desWorldPos=null,e.startWorldPos=void 0,e.yHeight=0,e.nowTime=0,e}return e(n,t),n.prototype.reset=function(){},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/NBombCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.BaseCtrl}],execute:function(){var s;n._RF.push({},"51afegfvSNH+L87DusNQID+","NBombCtrl",void 0);var a=i.ccclass;i.property,t("NBombCtrl",a("NBombCtrl")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.NBomb,this.init("NBomb")},i.onDisable=function(){t.prototype.onDisable.call(this)},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/NBombEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./RoleEntity.ts","./NBombComp.ts","./GlobalSingle.ts","./Util.ts","./Constant.ts","./EventManager.ts","./StorageData.ts","./AudioManager.ts","./ArrowComp.ts","./PoolManager.ts","./JJMgr.ts","./AdManager.ts","./UMTrack.ts","./UMEvent.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M,T,k,N,R,B,F,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.Node,c=t.BoxCollider,u=t.Label,h=t.MeshRenderer,p=t.Quat,d=t.tween,f=t.Vec3},function(t){g=t.ecs},function(t){m=t.CCComp},function(t){v=t.RoleEntity},function(t){y=t.NBombComp},function(t){b=t.GlobalSingle},function(t){C=t.Util},function(t){_=t.ResEnum,E=t.GameEvent,w=t.GameState,S=t.Sounds},function(t){P=t.EventManager},function(t){M=t.StorageData},function(t){T=t.default},function(t){k=t.ArrowComp},function(t){N=t.default},function(t){R=t.default},function(t){B=t.default},function(t){F=t.UMTrack},function(t){L=t.UMEvent}],execute:function(){var A,D,x,I,U,z,G,H,O,V,j,W,Q,J,X,q,Y,Z,K,$,tt,et,nt,it;s._RF.push({},"afa9dw9fPtL5YJv/vQM29yX","NBombEntity",void 0);var ot=a.ccclass,rt=a.property;t("NBombEntity",(A=ot("NBombEntity"),D=g.register("NBombEntity",!1),x=rt(l),I=rt(l),U=rt(l),z=rt(c),G=rt(c),H=rt(l),O=rt(l),V=rt(u),j=rt(l),W=rt(l),A(Q=D((X=e((J=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"bomb",X,o(e)),i(e,"flyNode",q,o(e)),i(e,"FireFX",Y,o(e)),i(e,"openBtnCollider",Z,o(e)),i(e,"shootBtnCollider",K,o(e)),i(e,"cap",$,o(e)),i(e,"TimeQuad",tt,o(e)),i(e,"TimeLabel",et,o(e)),i(e,"VideoBtn",nt,o(e)),i(e,"NormalBtn",it,o(e)),e.weaponData=void 0,e._currentTime=0,e.buildingData=void 0,e.playAd=!1,e._isFirst=!1,e.fireNum=0,e}n(e,t);var s=e.prototype;return s.onLoad=function(){t.prototype.onLoad.call(this),this.buildingData=b.instance.tables.Building.NBomb},s.reset=function(){N.instance.putItem(_.NBomb,this.node,!0)},s.onEnable=function(){this.openBtnCollider.on("onTriggerEnter",this.onTriggerEnterOpen,this),this.openBtnCollider.on("onTriggerExit",this.onTriggerExitOpen,this),this.shootBtnCollider.on("onTriggerEnter",this.onTriggerEnterShoot,this),P.instance.on(E.LevelEvent,this.LevelEventFun,this),P.instance.on(E.UpgradeTeamLevelUIClose,this.UpgradeTeamLevelUICloseFun,this),P.instance.on(E.UseNbomb,this.UseNbombFun,this),P.instance.on(E.NbombBmob,this.NbombBmobFun,this),P.instance.on(E.StatusEvent,this.StatusEventFun,this),P.instance.on(E.HouseMaxLevel,this.HouseMaxLevelFun,this),P.instance.on(E.FireNbomb,this.FireNbombFun,this),P.instance.on(E.NBombFinish,this.NBombFinishFun,this),this.weaponData=b.instance.tables.Weapon.NBomb,this.currentTime=this.weaponData.CD,this.schedule(this.timeFun,1),this.firstUnlock()},s.onDisable=function(){this.openBtnCollider.off("onTriggerEnter",this.onTriggerEnterOpen,this),this.openBtnCollider.off("onTriggerExit",this.onTriggerExitOpen,this),this.shootBtnCollider.off("onTriggerEnter",this.onTriggerEnterShoot,this),P.instance.off(E.LevelEvent,this.LevelEventFun,this),P.instance.off(E.UpgradeTeamLevelUIClose,this.UpgradeTeamLevelUICloseFun,this),P.instance.off(E.UseNbomb,this.UseNbombFun,this),P.instance.off(E.NbombBmob,this.NbombBmobFun,this),P.instance.off(E.StatusEvent,this.StatusEventFun,this),P.instance.off(E.HouseMaxLevel,this.HouseMaxLevelFun,this),P.instance.off(E.FireNbomb,this.FireNbombFun,this),P.instance.off(E.NBombFinish,this.NBombFinishFun,this),this.ent&&this.ent.destroy(!0)},s.UseNbombFun=function(){this.playAd=!0,this.currentTime=0},s.LevelEventFun=function(){this.firstUnlock()},s.StatusEventFun=function(){this.ent.has(k)&&M.instance.status==w.win&&this.ent.remove(k)},s.FireNbombFun=function(t,e){this.fireNum=e.fireNum,this.startFire()},s.UpgradeTeamLevelUICloseFun=function(){this.currentTime=this.weaponData.CD},s.HouseMaxLevelFun=function(){this.firstUnlock()},s.NBombFinishFun=function(){this.fireNum--,this.fireNum>0&&this.startFire()},s.firstUnlock=function(){M.instance.level==this.buildingData.Level&&b.instance.houseMaxLevel>0&&M.instance.status!=w.win&&(this.currentTime=0,!this.ent.has(k)&&b.instance.enemyEntities.length>0&&this.ent.add(k).init(this.node,!0),R.instance.dataConfig.front_fyzd_vi_switch?this.isFirst=!1:this.isFirst=!0)},s.timeFun=function(){this.currentTime>0&&this.currentTime--},s.setTime=function(){this.TimeLabel.string=C.instance.formatSecondsMS(this.currentTime),this.TimeLabel.node.active=!0,this.TimeLabel.updateRenderData(!0),this.TimeLabel.node.active=!1,this.TimeQuad.getComponent(h).material.setProperty("mainTexture",this.TimeLabel.spriteFrame.texture),this.currentTime<=0?P.instance.emit(E.NbombUnlock,!0):P.instance.emit(E.NbombUnlock,!1)},s.onTriggerEnterOpen=function(t){var e=t.otherCollider.node.getComponent(v);if(e&&e.isPlayer){console.log("打开发射器"),this.ent.has(k)&&this.ent.remove(k);var n=new p;p.fromEuler(n,90,0,0),d(this.cap).to(.5,{rotation:n},{easing:"bounceOut"}).call((function(){})).start()}},s.onTriggerEnterShoot=function(t){var e=this,n=t.otherCollider.node.getComponent(v);n&&n.isPlayer&&(F.instance.trackEvent(L.chufa_yuanzidan),this.isFirst?this.startFire():this.playAd?(this.startFire(),this.playAd=!1):B.instance.createRewardedVideoAd({onClose:function(t){t.isEnded&&(F.instance.trackEvent(L.chufa_vi_yuanzidan),e.startFire(),e.playAd=!1)}}))},s.startFire=function(){if(!this.ent.has(y))if(console.log("发射核弹"),b.instance.enemyEntities.length>0){T.instance.playSoundEffect(S.NuBombLaunch,!0);var t=new y;t.flyNode=this.flyNode;for(var e=null,n=null,i=0;i<b.instance.enemyEntities.length;i++)if(null==e)n=b.instance.enemyEntities[i].get(v).node.worldPosition,e=f.distance(b.instance.player.worldPosition,n);else{var o=f.distance(b.instance.player.worldPosition,b.instance.enemyEntities[i].get(v).node.worldPosition);o<e&&(e=o,n=b.instance.enemyEntities[i].get(v).node.worldPosition)}t.desWorldPos=n,this.ent.add(t),this.currentTime=this.weaponData.CD}else this.fireNum=0,console.log("敌人死光了，不再发射核弹")},s.onTriggerExitOpen=function(t){var e=t.otherCollider.node.getComponent(v);if(e&&e.isPlayer){var n=new p;p.fromEuler(n,0,0,0),d(this.cap).to(.5,{rotation:n},{easing:"bounceOut"}).start()}},s.NbombBmobFun=function(){this.isFirst&&(this.isFirst=!1,P.instance.emit(E.ShowPlaneAndNbomb))},r(e,[{key:"currentTime",get:function(){return this._currentTime},set:function(t){this._currentTime=t,this.setTime()}},{key:"isFirst",get:function(){return this._isFirst},set:function(t){this._isFirst=t,this.isFirst?(this.NormalBtn.active=!0,this.VideoBtn.active=!1):(this.NormalBtn.active=!1,this.VideoBtn.active=!0)}}]),e}(m)).prototype,"bomb",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(J.prototype,"flyNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(J.prototype,"FireFX",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(J.prototype,"openBtnCollider",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(J.prototype,"shootBtnCollider",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=e(J.prototype,"cap",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=e(J.prototype,"TimeQuad",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=e(J.prototype,"TimeLabel",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nt=e(J.prototype,"VideoBtn",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=e(J.prototype,"NormalBtn",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=J))||Q)||Q)),s._RF.pop()}}})),System.register("chunks:///_virtual/NBombSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./Util.ts","./AudioManager.ts","./ThirdFreeLookCamera.ts","./EventManager.ts","./NBombComp.ts","./TowerComp.ts","./NBombEntity.ts","./RoleEntity.ts","./TowerEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Quat,s=t.Vec3,a=t.v3},function(t){l=t.Sounds,c=t.GameEvent,u=t.ResEnum},function(t){h=t.GlobalSingle},function(t){p=t.Util},function(t){d=t.default},function(t){f=t.ThirdFreeLookCamera},function(t){g=t.EventManager},function(t){m=t.NBombComp},function(t){v=t.TowerComp},function(t){y=t.NBombEntity},function(t){b=t.RoleEntity},function(t){C=t.TowerEntity},function(t){_=t.ecs}],execute:function(){var E;i._RF.push({},"27dee1YIfZLcpue8HUUVyI1","NBombSys",void 0);var w=o.ccclass;t("NBombSys",w("NBombSys")(E=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).curPos=void 0,e.oldPos=void 0,e.quat=void 0,e}e(i,t);var o=i.prototype;return o.filter=function(){return _.allOf(m)},o.init=function(){},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value,a=o.get(y),l=o.get(m);a.bomb.parent=a.flyNode,a.bomb.setPosition(0,0,0);var c=new r;r.fromEuler(c,90,0,0),a.bomb.setRotation(c),l.startWorldPos=l.flyNode.getWorldPosition(),l.yHeight=s.distance(l.desWorldPos,l.startWorldPos),l.nowTime=0,a.FireFX.active=!0,h.instance.camera3d.getComponent(f).setFollowTarget(l.flyNode)}},o.firstUpdate=function(t){},o.entityRemove=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value,a=o.get(y),l=o.get(m);this.curPos=l.flyNode.getWorldPosition(),this.oldPos=l.flyNode.getWorldPosition(),l.nowTime+=1/60;var c=l.nowTime,u=Math.sqrt(l.yHeight/2/4.9),h=9.8*u,p=-h/-9.8,d=Math.sqrt(l.yHeight/4.9);if(c<u){var f=4.9*c*c;this.curPos.y=f}else if(this.curPos.y>0){var g=c-u,v=4.9*u*u+(h*g+-4.9*Math.pow(g,2));this.curPos.y=v}else this.boom(a,l),o.remove(m);var b=u+p+d,C=(l.desWorldPos.x-l.startWorldPos.x)/(.5*Math.pow(b,2));this.curPos.x=l.startWorldPos.x+.5*C*Math.pow(c,2);var _=(l.desWorldPos.z-l.startWorldPos.z)/(.5*Math.pow(b,2));this.curPos.z=l.startWorldPos.z+.5*_*Math.pow(c,2),l.flyNode.setWorldPosition(this.curPos),this.quat=new r;var E=this.curPos.subtract(this.oldPos).normalize();r.fromViewUp(this.quat,E,s.UP),l.flyNode.setWorldRotation(this.quat)}},o.boom=function(t,e){if(d.instance.stopSoundEffect(l.NuBombLaunch),d.instance.playSoundEffect(l.NuBomb),t.FireFX.active=!1,t.flyNode.active=!1,this.showHit(e.desWorldPos),h.instance.enemyEntities.length>0)for(var i,o=n(h.instance.enemyEntities);!(i=o()).done;){var u=i.value;if(s.distance(e.desWorldPos,u.get(b).node.getWorldPosition())<t.weaponData.Range){var p=h.instance.tables.Bullet[t.weaponData.BulletID];u.get(b).beHitDelay(p.Atk,.1)}}for(var m=_.query(_.allOf(v)),y=0;y<m.length;y++)if(m[y].get(C)&&m[y].get(C).node&&s.distance(e.desWorldPos,m[y].get(C).node.getWorldPosition())<t.weaponData.Range){var E=h.instance.tables.Bullet[t.weaponData.BulletID];m[y].get(C).beHitDelay(E.Atk,.1)}t.scheduleOnce((function(){t.flyNode.active=!0,t.flyNode.setPosition(a(0,0,-3));var e=new r;r.fromEuler(e,0,0,0),t.bomb.setRotation(e),t.flyNode.setRotation(e),h.instance.camera3d.getComponent(f).setFollowTarget(h.instance.player),g.instance.emit(c.NBombFinish)}),3)},o.showHit=function(t){g.instance.emit(c.NbombBmob),p.instance.playFX(u.ExplosionFX,h.instance.map,t,0)},i}(_.ComblockSystem))||E),i._RF.pop()}}})),System.register("chunks:///_virtual/NbombUi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UMTrack.ts","./Constant.ts","./UMEvent.ts","./AdManager.ts","./EventManager.ts","./UIManager.ts","./UIView.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.UMTrack},function(t){r=t.GameEvent},function(t){s=t.UMEvent},function(t){a=t.default},function(t){l=t.EventManager},function(t){c=t.UIManager},function(t){u=t.UIView}],execute:function(){var h;n._RF.push({},"b73a7xq0CtO35PGoNqQBSHe","NbombUi",void 0);var p=i.ccclass;i.property,t("NbombUi",p("NbombUi")(h=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onOpen=function(t){a.instance.showBanner()},i.onClose=function(){a.instance.hideBanner()},i.confirm=function(){var t=this;a.instance.createRewardedVideoAd({onClose:function(e){e.isEnded&&(o.instance.trackEvent(s.chufa_vi_cjwq),l.instance.emit(r.FireNbomb,{fireNum:2}),c.instance.close(t))}})},i.closeUi=function(){c.instance.close(this)},n}(u))||h),n._RF.pop()}}})),System.register("chunks:///_virtual/npm.ts",["cc","./env"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy},function(t){n=t.EDITOR}],execute:function(){t("formatPath",(function(t){return t.replace(/\\/g,"/")})),e._RF.push({},"b24bcl2VmRBGodK/hExc8EZ","npm",void 0),t("cce",n),t("io",n),t("path",n),t("fse",n),t("base642arraybuffer",n),e._RF.pop()}}})),System.register("chunks:///_virtual/PlaneComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalSingle.ts","./PlaneEntity.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.v3,r=t.Vec3,s=t.Quat},function(t){a=t.GlobalSingle},function(t){l=t.PlaneEntity},function(t){c=t.RoleEntity},function(t){u=t.ecs}],execute:function(){var h;n._RF.push({},"a078fuk/JdL0LObR55mP9Gs","PlaneComp",void 0);var p=i.ccclass;i.property,t("PlaneComp",p("PlaneComp")(h=u.register("PlaneComp")(h=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).nowTime=0,e.idlePos=void 0,e.centerWorldPos=null,e.targetWorldPos=null,e.targetQuat=new s,e.dir=new r,e.distance=0,e}e(n,t);var i=n.prototype;return i.reset=function(){},i.getOneTarget=function(){if(a.instance.enemyEntities.length>0){var t=this.ent.get(l).node.getWorldPosition(),e=Math.floor(Math.random()*a.instance.enemyEntities.length);this.targetWorldPos=a.instance.enemyEntities[e].get(c).node.getWorldPosition(),this.targetWorldPos.y=10,this.centerWorldPos=o((this.targetWorldPos.x+t.x)/2,this.targetWorldPos.y,(this.targetWorldPos.z+t.z)/2),this.distance=r.distance(this.targetWorldPos,t),r.subtract(this.dir,t,this.targetWorldPos),s.fromViewUp(this.targetQuat,this.dir.normalize(),r.UNIT_Y)}},n}(u.Comp))||h)||h),n._RF.pop()}}})),System.register("chunks:///_virtual/PlaneEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./PlaneComp.ts","./AircraftEntity.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.v3},function(t){c=t.ecs},function(t){u=t.CCComp},function(t){h=t.PlaneComp},function(t){p=t.AircraftEntity,d=t.AircraftStatus}],execute:function(){var f,g,m,v,y,b;r._RF.push({},"91d0epYEEpBPKRhpIeRCuBG","PlaneEntity",void 0);var C=s.ccclass,_=s.property;t("PlaneEntity",(f=C("PlaneEntity"),g=c.register("PlaneEntity",!1),m=_(a),f(v=g((b=e((y=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"Aircraft",b,o(e)),e.backWorPos1=null,e.backWorPos2=null,e.aircraftEntity=void 0,e.borthWorPos=void 0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){},r.onEnable=function(){},r.joystickMove=function(t){this.Aircraft.getComponent(p).status==d.battle&&null==this.backWorPos1&&null==this.backWorPos2&&(t?this.ent.has(h)&&this.ent.remove(h):this.ent.has(h)||this.ent.add(h))},r.onDisable=function(){this.backWorPos1=null,this.backWorPos2=null,this.ent&&this.ent.destroy(!0)},r.init=function(t){this.borthWorPos=this.node.getWorldPosition(),this.aircraftEntity=t;var e=new h;e.targetWorldPos=l(this.borthWorPos.x,10,this.borthWorPos.z-20),this.ent.add(e)},r.backAirport1=function(){this.ent.has(h)||this.ent.add(h),this.backWorPos1=l(this.borthWorPos.x,10,this.borthWorPos.z-20),this.ent.get(h).targetWorldPos=this.backWorPos1},r.backAirport2=function(){this.ent.has(h)||this.ent.add(h),this.backWorPos2=this.borthWorPos,this.ent.get(h).targetWorldPos=this.borthWorPos},r.resetPlane=function(){this.ent.remove(h),this.backWorPos1=null,this.backWorPos2=null},e}(u)).prototype,"Aircraft",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=y))||v)||v)),r._RF.pop()}}})),System.register("chunks:///_virtual/PlaneSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PlaneComp.ts","./PlaneEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Vec3,s=t.Quat},function(t){a=t.PlaneComp},function(t){l=t.PlaneEntity},function(t){c=t.ecs}],execute:function(){var u;i._RF.push({},"cdd5798aZZBVIPU1XhGdrr3","PlaneSys",void 0);var h=o.ccclass;t("PlaneSys",h("PlaneSys")(u=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._planeEntity=void 0,e._pos=void 0,e._pos0=void 0,e._planeComp=void 0,e._gavity=9.8,e._quat=new s,e._dir=new r,e._radius=3,e._quat0=void 0,e._quat2=new s,e.accelerate=new r(0,0,0),e}e(i,t);var o=i.prototype;return o.filter=function(){return c.allOf(a)},o.init=function(){},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value;this._planeEntity=o.get(l);var r=o.get(a);r.idlePos=this._planeEntity.node.getPosition(),r.nowTime=0}},o.firstUpdate=function(t){},o.entityRemove=function(t){},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value;this._planeEntity=o.get(l),this._planeComp=o.get(a),this._planeComp.nowTime+=1/60,this._planeEntity.node&&this._planeEntity.node.isValid&&(this._pos=this._planeEntity.node.getWorldPosition(),this._pos0=this._planeEntity.node.getWorldPosition(),this._quat0=this._planeEntity.node.getRotation(),this._planeComp.targetWorldPos?r.distance(this._pos,this._planeComp.targetWorldPos)<1?this._planeComp.targetWorldPos=null:(Math.abs(this._pos.x-this._planeComp.targetWorldPos.x)<.1?this.accelerate.x=0:this._pos.x<this._planeComp.targetWorldPos.x?(this.accelerate.x+=.1,this.accelerate.x>1&&(this.accelerate.x=1)):(this.accelerate.x-=.1,this.accelerate.x<-1&&(this.accelerate.x=-1)),Math.abs(this._pos.z-this._planeComp.targetWorldPos.z)<.1?this.accelerate.z=0:this._pos.z<this._planeComp.targetWorldPos.z?(this.accelerate.z+=.1,this.accelerate.z>1&&(this.accelerate.z=1)):(this.accelerate.z-=.1,this.accelerate.z<-1&&(this.accelerate.z=-1)),Math.abs(this._pos.y-this._planeComp.targetWorldPos.y)<.1?this.accelerate.y=0:this._pos.y<this._planeComp.targetWorldPos.y?(this.accelerate.y+=.1,this.accelerate.y>1&&(this.accelerate.y=1)):(this.accelerate.y-=.1,this.accelerate.y<-1&&(this.accelerate.y=-1))):this._planeEntity.backWorPos2?this._planeEntity.aircraftEntity.backAirport():this._planeEntity.backWorPos1?this._planeEntity.backAirport2():this._planeComp.getOneTarget(),this._pos.x+=this.accelerate.x,this._pos.z+=this.accelerate.z,this._pos.y+=this.accelerate.y,this._planeEntity.node.setWorldPosition(this._pos0.lerp(this._pos,.1)),r.subtract(this._dir,this._pos,this._pos0),s.fromViewUp(this._quat,this._dir,r.UP),this._planeEntity.backWorPos2||this._planeEntity.backWorPos1?this._planeEntity.node.setRotation(this._quat0.lerp(this._quat,.1)):this._planeEntity.node.setRotation(this._quat))}},i}(c.ComblockSystem))||u),i._RF.pop()}}})),System.register("chunks:///_virtual/PlayerCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BagComp.ts","./HpProgressBarComp.ts","./JoystickMoveComp.ts","./RoleAnimComp.ts","./RoleComp.ts","./SoldierComp.ts","./RoleEntity.ts","./ThirdFreeLookCamera.ts","./PoolManager.ts","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.BagComp},function(t){r=t.HpProgressBarComp},function(t){s=t.JoystickMoveComp},function(t){a=t.RoleAnimComp},function(t){l=t.RoleComp},function(t){c=t.SoldierComp},function(t){u=t.RoleEntity},function(t){h=t.ThirdFreeLookCamera},function(t){p=t.default},function(t){d=t.ResEnum},function(t){f=t.GlobalSingle},function(t){g=t.StorageData},function(t){m=t.BaseCtrl}],execute:function(){var v;n._RF.push({},"1e8edCXSjhMQqCmc2F5Mg7u","PlayerCtrl",void 0);var y=i.ccclass;i.property,t("PlayerCtrl",y("PlayerCtrl")(v=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.showPrefab()},i.onDisable=function(){t.prototype.onDisable.call(this)},i.packageEventFun=function(t,e){},i.showPrefab=function(){var t=this;this.isUnlocked=!0,f.instance.playerBorthWorldPos=this.node.worldPosition,p.instance.getItemSync(d.Role).then((function(e){f.instance.player=e,e.name="player";var n=e.getComponent(u);n.isPlayer=!0,e.parent=t.node,e.setWorldPosition(t.node.worldPosition),f.instance.camera3d.getComponent(h).setFollowTarget(e),n.ent.add(s).moveTarget=e,n.ent.add(o).init(),n.ent.add(a);var i=f.instance.tables.Team[g.instance.teamLevel];n.roleId=i.RoleId,n.setRoleData(),n.ent.add(l).init(),n.ent.add(c).init(),n.ent.add(r),p.instance.initSize(d.Role,30)}))},n}(m))||v),n._RF.pop()}}})),System.register("chunks:///_virtual/pool.ts",["cc"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.Vec2,n=t.Vec3,i=t.Vec4,o=t.Quat,r=t.Mat4,s=t.cclegacy}],execute:function(){s._RF.push({},"909c3539B9HBIjKNpHsQPLH","pool",void 0);var a=t("Pool",function(){function t(t){this._pool=[],this._ctor=null,this._ctor=t}var e=t.prototype;return e.get=function(){var t=this._pool.pop();return t||(t=new this._ctor),t},e.put=function(t){this._pool.push(t)},t}());t("default",{Vec2:new a(e),Vec3:new a(n),Vec4:new a(i),Quat:new a(o),Mat4:new a(r)}),s._RF.pop()}}})),System.register("chunks:///_virtual/PoolManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameUtil.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,i=t.NodePool,o=t.Prefab,r=t.instantiate},function(t){s=t.GameUtil}],execute:function(){n._RF.push({},"07c33iqqmhKY6R7IXsznB0W","PoolManager",void 0),t("default",function(){function t(){this.pools={},this.pools_prefab={},this.limitObj={},this.loadArry=[],this.isLoading=!1}var n=t.prototype;return n.checkPool=function(t){this.pools[t]||(this.pools[t]=new i("CCComp"))},n.initOnePool=function(t,e){var n=this;this.checkPool(t),this.limitObj[t]&&this.limitObj[t].limitCount||this.setLimit(t,9999),this.pools_prefab[t]?e():s.instance.getBundle("res").then((function(i){i.load(t,o,(function(i,o){i?console.error(t+"资源加载错误>>>>>",i):n.pools_prefab[t]=o,e()}))}))},n.autoInitPool=function(){var t=this;if(this.loadArry.length>0&&!this.isLoading){this.isLoading=!0;var e=this.loadArry.shift();this.initPool([e],(function(){t.isLoading=!1,t.autoInitPool()}))}},n.isLoaded=function(t){return!!this.pools_prefab[t]},n.getItem=function(t){this.checkPool(t);var e=null;return this.pools[t].size()>0?e=this.pools[t].get():this.pools_prefab[t]?this.limitObj[t].spawnCount<=this.limitObj[t].limitCount&&(e=r(this.pools_prefab[t]),this.limitObj[t].spawnCount++):(console.warn("未初始化对象池："+t),this.loadArry.indexOf(t)<0&&(this.loadArry.push(t),this.autoInitPool())),e&&this.pools_prefab[t]&&this.pools_prefab[t].addRef(),e},n.initPool=function(t,e,n){var i=this;if(t.length>0){var o=t.shift();this.initOnePool(o,(function(){n&&n(),i.initPool(t,e,n)}))}else e&&e()},n.initSize=function(t,e){if(!this.pools[t])return 0;if(!(this.pools[t].size()<e))return this.pools[t].size();for(var n=e-this.pools[t].size(),i=[],o=0;o<n;o++)i.push(this.getItem(t));for(var r=0;r<i.length;r++)this.pools[t].put(i[r])},n.getPoolSize=function(t){return this.pools[t]?this.pools[t].size():0},n.setLimit=function(t,e){this.limitObj[t]?this.limitObj[t].limitCount=e:this.limitObj[t]={spawnCount:0,limitCount:e}},n.getItemSync=function(t){var e=this;return new Promise((function(n,i){e.initPool([t],(function(){n(e.getItem(t))}))}))},n.putItem=function(t,e,n){void 0===n&&(n=!1),t&&e&&e.isValid&&(e.parent&&e.removeFromParent(),e.parent=null,this.checkPool(t),this.pools[t].put(e),this.pools_prefab[t]&&this.pools_prefab[t].decRef(n).refCount<=0&&n&&(this.pools[t].clear(),this.pools[t]=null,delete this.pools[t],this.pools_prefab[t]=null,delete this.pools_prefab[t]))},e(t,null,[{key:"instance",get:function(){return null===t._instance&&(t._instance=new t),t._instance},set:function(e){t._instance=e}}]),t}())._instance=null,n._RF.pop()}}})),System.register("chunks:///_virtual/PostCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.BaseCtrl}],execute:function(){var s;n._RF.push({},"dcf11U88vVHLKWmk5BGVFhn","PostCtrl",void 0);var a=i.ccclass;i.property,t("PostCtrl",a("PostCtrl")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.Post,this.showPrefab()},i.onDisable=function(){t.prototype.onDisable.call(this)},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/PostEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./RoleEntity.ts","./Constant.ts","./StorageData.ts","./EventManager.ts","./PoolManager.ts","./GlobalSingle.ts","./ThirdFreeLookCamera.ts","./UIManager.ts","./Game3dUI.ts","./AudioManager.ts","./JoystickMoveComp.ts","./ArrowComp.ts","./RoleAnimComp.ts","./Util.ts","./UMTrack.ts","./UMEvent.ts","./TruckEntity.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M,T,k,N,R,B,F,L,A,D,x;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.Texture2D,c=t.ConeCollider,u=t.MeshRenderer,h=t.tween,p=t.v3,d=t.Sprite,f=t.Color},function(t){g=t.ecs},function(t){m=t.CCComp},function(t){v=t.RoleEntity},function(t){y=t.ResEnum,b=t.GameEvent,C=t.Sounds,_=t.UIID},function(t){E=t.StorageData},function(t){w=t.EventManager},function(t){S=t.default},function(t){P=t.GlobalSingle},function(t){M=t.ThirdFreeLookCamera},function(t){T=t.UIManager},function(t){k=t.Game3dUI},function(t){N=t.default},function(t){R=t.JoystickMoveComp},function(t){B=t.ArrowComp},function(t){F=t.RoleAnimComp},function(t){L=t.Util},function(t){A=t.UMTrack},function(t){D=t.UMEvent},function(t){x=t.TruckEntity}],execute:function(){var I,U,z,G,H,O,V,j,W,Q,J,X,q,Y;r._RF.push({},"381c7C/+P9LN5F2QYZ8yxdA","PostEntity",void 0);var Z=s.ccclass,K=s.property;t("PostEntity",(I=Z("PostEntity"),U=g.register("PostEntity",!1),z=K(a),G=K([l]),H=K(a),O=K(a),V=K(c),I(j=U((Q=e((W=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"limitNode",Q,o(e)),i(e,"flags",J,o(e)),i(e,"icon",X,o(e)),i(e,"QuadIcon",q,o(e)),i(e,"collider",Y,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){S.instance.putItem(y.Post,this.node)},r.onEnable=function(){w.instance.on(b.LevelEvent,this.levelEventFun,this),w.instance.on(b.TeamLevelEvent,this.TeamLevelEventFun,this),w.instance.on(b.StatusEvent,this.StatusEventFun,this),this.collider.on("onTriggerEnter",this.onTriggerEnter,this),this.collider.enabled=!0,this.init(),this.checkTeamLimit()},r.update=function(){this.limitNode.lookAt(P.instance.camera3d.getWorldPosition())},r.onDisable=function(){w.instance.off(b.LevelEvent,this.levelEventFun,this),w.instance.off(b.TeamLevelEvent,this.TeamLevelEventFun,this),w.instance.off(b.StatusEvent,this.StatusEventFun,this),this.collider.off("onTriggerEnter",this.onTriggerEnter,this),this.ent&&this.ent.destroy(!0)},r.init=function(){this.icon.getComponent(u).material.setProperty("mainTexture",this.flags[0])},r.levelEventFun=function(){this.collider.enabled=!0,this.init()},r.TeamLevelEventFun=function(t,e){this.checkTeamLimit(),this.showGuideArrow()},r.StatusEventFun=function(){this.showGuideArrow()},r.showGuideArrow=function(){P.instance.enemyEntities.length<=0&&1==E.instance.level&&P.instance.guideStep<5&&(P.instance.guideStep=5,this.ent.has(B)||this.ent.add(B).init(this.node))},r.checkTeamLimit=function(){},r.onTriggerEnter=function(t){var e=this,n=t.otherCollider.node.getComponent(v);if(P.instance.enemyEntities.length<=0&&n&&n.isPlayer){N.instance.playSoundEffect(C.Flag),E.instance.enemys={},E.instance.badgeStackUsed=0,this.ent.has(B)&&this.ent.remove(B),P.instance.player.getComponent(v).ent.get(F).idle(),P.instance.player.getComponent(v).ent.get(R).moveTarget=null,L.instance.playFX(y.ConfettiFX,P.instance.map,this.node.worldPosition,3),this.collider.enabled=!1;var i=this.icon.getPosition();h(this.icon).to(1,{position:p(0,-1,0)}).call((function(){e.icon.getComponent(u).material.setProperty("mainTexture",e.flags[1])})).to(1,{position:i}).call((function(){console.log("放烟花, 进入下一关"),N.instance.playSoundEffect(C.Win),1==E.instance.level&&A.instance.trackEvent(D.Level_1_Win),T.instance.open(_.FinishUi,{closeUi:function(){e.nextLevel()}})})).start()}},r.nextLevel=function(){var t=this,e=P.instance.tables.EnemyLevel[E.instance.level],n=P.instance.tables.EnemyLevel[E.instance.level+1];if(n){var i=!1;e.Level1==n.Level1?(i=!1,N.instance.playSoundEffect(C.TruckCarry,!0)):(P.instance.houseMaxLevel=0,i=!0),i?(w.instance.emit(b.PackageEvent,i),this.showLevelMask()):S.instance.getItemSync(y.Truck).then((function(e){e?(e.parent=P.instance.map,e.setPosition(p(0,0,0)),P.instance.camera3d.getComponent(M).setFollowTarget(e),h(e).delay(1).call((function(){w.instance.emit(b.PackageEvent,i)})).delay(1).by(3,{position:p(0,0,-30)}).call((function(){t.showLevelMask((function(){N.instance.stopSoundEffect(C.TruckCarry),e.getComponent(x).ent.destroy(!0)}))})).by(.7,{position:p(0,0,-7)}).start()):h(t.node).delay(1).call((function(){w.instance.emit(b.PackageEvent,i)})).delay(2).call((function(){t.showLevelMask((function(){N.instance.stopSoundEffect(C.TruckCarry),e.getComponent(x).ent.destroy(!0)}))})).start()}))}},r.showLevelMask=function(t){var e=T.instance.getUI(_.Game3dUi).getComponent(k).NextLevelMask.getComponent(d);e.node.active=!0;var n=new f(0,0,0,0),i=function(){e.color=n};h(n).set({a:0}).to(1,{a:255},{onUpdate:i}).call((function(){A.instance.onEnd(E.instance.level.toString(),"第"+E.instance.level+"关"),P.instance.player.setWorldPosition(P.instance.playerBorthWorldPos),P.instance.camera3d.getComponent(M).setFollowTarget(P.instance.player),E.instance.level++,P.instance.player.getComponent(v).ent.get(R).moveTarget=P.instance.player,A.instance.onStart(E.instance.level.toString(),"第"+E.instance.level+"关")})).delay(1).to(1,{a:0},{onUpdate:i}).call((function(){e.node.active=!1,t&&t()})).start()},e}(m)).prototype,"limitNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(W.prototype,"flags",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),X=e(W.prototype,"icon",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(W.prototype,"QuadIcon",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(W.prototype,"collider",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=W))||j)||j)),r._RF.pop()}}})),System.register("chunks:///_virtual/Quaternion.ts",["cc"],(function(t){var e,n,i;return{setters:[function(t){e=t.cclegacy,n=t.Quat,i=t.Vec3}],execute:function(){e._RF.push({},"780cdB+LiRDZ7NDIJ2KDSaQ","Quaternion",void 0),t("Quaternion",function(){function t(){}return t.RotateY=function(t,e){var i=new n;return t.rotation=n.rotateY(i,t.rotation,e*this.Deg2Rad),i},t.RotateX=function(t,e){var i=new n;return t.rotation=n.rotateX(i,t.rotation,e*this.Deg2Rad),i},t.RotateZ=function(t,e){var i=new n;return t.rotation=n.rotateZ(i,t.rotation,e*this.Deg2Rad),i},t.RotateAround=function(t,e,i){var o=new n;return n.rotateAround(o,t,e,i*this.Deg2Rad),o},t.RotateAroundLocal=function(t,e,i){var o=new n;return n.rotateAroundLocal(o,t,e,i*this.Deg2Rad),o},t.RotationAroundNode=function(t,e,o,r){var s=new n,a=new i,l=new i,c=t.position,u=r*this.Deg2Rad;return n.fromAxisAngle(s,o,u),i.subtract(a,c,e),i.transformQuat(l,a,s),t.position=i.add(l,e,l),n.rotateAround(s,t.rotation,o,u),s},t.GetEulerFromQuat=function(t){return n.toEuler(new i,t,!0)},t.GetQuatFromAngle=function(t){return n.fromEuler(new n,t.x,t.y,t.z)},t.Lerp=function(t,e,i){var o=new n;return n.lerp(o,t,e,i),o},t.Slerp=function(t,e,i){var o=new n;return n.slerp(o,t,e,i),o},t.LookRotation=function(t,e){void 0===e&&(e=i.UP);var o=new n;return i.normalize(t,t),n.fromViewUp(o,t,e),o},t}()).Deg2Rad=Math.PI/180,e._RF.pop()}}})),System.register("chunks:///_virtual/raycast.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.createForOfIteratorHelperLoose},function(t){n=t.Layers,i=t.renderer,o=t.Mat4,r=t.Vec3,s=t.cclegacy,a=t.geometry,l=t.gfx}],execute:function(){s._RF.push({},"7881fXu+n9JkY6UxvBywBBF","raycast",void 0);var c=a.intersect,u=a.Ray,h=a.Triangle,p=[],d=new o,f=new u,g=h.create(),m=new r,v=1/0,y=function(t,e,n,i,o){if(void 0===o&&(o=1/0),v=o,n===l.PrimitiveMode.TRIANGLE_LIST)for(var s=e.length,a=0;a<s;a+=3){var u=3*e[a],h=3*e[a+1],p=3*e[a+2];r.set(g.a,t[u],t[u+1],t[u+2]),r.set(g.b,t[h],t[h+1],t[h+2]),r.set(g.c,t[p],t[p+1],t[p+2]);var d=c.rayTriangle(f,g,i);d<=0||d>=v||(v=d)}else if(n===l.PrimitiveMode.TRIANGLE_STRIP)for(var m=e.length-2,y=0,b=0;b<m;b+=1){var C=3*e[b-y],_=3*e[b+y+1],E=3*e[b+2];r.set(g.a,t[C],t[C+1],t[C+2]),r.set(g.b,t[_],t[_+1],t[_+2]),r.set(g.c,t[E],t[E+1],t[E+2]),y=~y;var w=c.rayTriangle(f,g,i);w<=0||w>=v||(v=w)}else if(n===l.PrimitiveMode.TRIANGLE_FAN){var S=e.length-1,P=3*e[0];r.set(g.a,t[P],t[P+1],t[P+2]);for(var M=1;M<S;M+=1){var T=3*e[M],k=3*e[M+1];r.set(g.b,t[T],t[T+1],t[T+2]),r.set(g.c,t[k],t[k+1],t[k+2]);var N=c.rayTriangle(f,g,i);N<=0||N>=v||(v=N)}}};t("default",{raycastAllModels:function(t,s,a,l){void 0===a&&(a=n.Enum.DEFAULT),void 0===l&&(l=1/0),p.length=0;for(var u,h=e(t.models);!(u=h()).done;){var g=u.value,b=g.transform;if(b&&g.enabled&&g.node.layer&a&&g.worldBounds){var C=c.rayAABB(s,g.worldBounds);if(!(C<=0||C>=l)){if(g.type===i.scene.ModelType.DEFAULT){o.invert(d,b.getWorldMatrix(d)),r.transformMat4(f.o,s.o,d),r.normalize(f.d,r.transformMat4Normal(f.d,s.d,d)),C=1/0;for(var _=0;_<g.subModels.length;++_){var E=g.subModels[_].subMesh;if(E&&E.geometricInfo){var w=E.geometricInfo,S=w.positions,P=w.indices,M=w.doubleSided;y(S,P,E.primitiveMode,M,l),C=Math.min(C,v*r.multiply(m,f.d,b.worldScale).length())}}}C<l&&p.push({node:g.node,distance:C})}}}return p.sort((function(t,e){return t.distance-e.distance})),p},raycastModels:function(t,s,a,l){void 0===a&&(a=n.Enum.DEFAULT),void 0===l&&(l=1/0),p.length=0;for(var u,h=e(t);!(u=h()).done;){var g=u.value,b=g.transform;if(b&&g.enabled&&g.node.layer&a&&g.worldBounds){var C=c.rayAABB(s,g.worldBounds);if(!(C<=0||C>=l)){if(g.type===i.scene.ModelType.DEFAULT){o.invert(d,b.getWorldMatrix(d)),r.transformMat4(f.o,s.o,d),r.normalize(f.d,r.transformMat4Normal(f.d,s.d,d)),C=1/0;for(var _=0;_<g.subModels.length;++_){var E=g.subModels[_].subMesh;if(E&&E.geometricInfo){var w=E.geometricInfo,S=w.positions,P=w.indices,M=w.doubleSided;y(S,P,E.primitiveMode,M,l),C=Math.min(C,v*r.multiply(m,f.d,b.worldScale).length())}}}C<l&&p.push({node:g.node,distance:C})}}}return p.sort((function(t,e){return t.distance-e.distance})),p},raycastModel:function(t,e,n){void 0===n&&(n=1/0);var s=t.transform,a=c.rayAABB(e,t.worldBounds);if(a<=0||a>=n)return null;if(t.type===i.scene.ModelType.DEFAULT){o.invert(d,s.getWorldMatrix(d)),r.transformMat4(f.o,e.o,d),r.normalize(f.d,r.transformMat4Normal(f.d,e.d,d)),a=1/0;for(var l=0;l<t.subModels.length;++l){var u=t.subModels[l].subMesh;if(u&&u.geometricInfo){var h=u.geometricInfo,p=h.positions,g=h.indices,b=h.doubleSided;y(p,g,u.primitiveMode,b,n),a=Math.min(a,v*r.multiply(m,f.d,s.worldScale).length())}}}return a<n?{node:t.node,distance:a}:null}}),s._RF.pop()}}})),System.register("chunks:///_virtual/ReadyAreaCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.BaseCtrl}],execute:function(){var s;n._RF.push({},"89d2fqGL41KPo6FfVOXAraH","ReadyAreaCtrl",void 0);var a=i.ccclass;i.property,t("ReadyAreaCtrl",a("ReadyAreaCtrl")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.ReadyArea,this.showPrefab()},i.onDisable=function(){t.prototype.onDisable.call(this)},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/ReadyAreaEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./Constant.ts","./PoolManager.ts","./GlobalSingle.ts","./StorageData.ts","./HouseComp.ts","./SpawnPosEntity.ts","./EventManager.ts","./SpawnPosComp.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.v3},function(t){c=t.ecs},function(t){u=t.CCComp},function(t){h=t.ResEnum,p=t.GameEvent,d=t.HouseType,f=t.ReadyPosType},function(t){g=t.default},function(t){m=t.GlobalSingle},function(t){v=t.StorageData},function(t){y=t.HouseComp},function(t){b=t.SpawnPosEntity},function(t){C=t.EventManager},function(t){_=t.SpawnPosComp}],execute:function(){var E,w,S,P,M,T,k,N,R,B;r._RF.push({},"c72f7GIIhhOYqbScGZPYI7B","ReadyAreaEntity",void 0);var F=s.ccclass,L=s.property;t("ReadyAreaEntity",(E=F("ReadyAreaEntity"),w=c.register("ReadyAreaEntity",!1),S=L(a),P=L(a),M=L(a),E(T=w((N=e((k=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"SoldierPosArry",N,o(e)),i(e,"TankerPosArry",R,o(e)),i(e,"SoldierPosArryBg",B,o(e)),e.teamData=void 0,e._tankerHouseLevel=void 0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){g.instance.putItem(h.ReadyArea,this.node)},r.onEnable=function(){C.instance.on(p.HouseLevelEvent,this.houseLevelEventFun,this),C.instance.on(p.TeamLevelEvent,this.teamLevelEventFun,this),this.init()},r.onDisable=function(){C.instance.off(p.HouseLevelEvent,this.houseLevelEventFun,this),C.instance.off(p.TeamLevelEvent,this.teamLevelEventFun,this),this.ent&&this.ent.destroy(!0)},r.houseLevelEventFun=function(t,e){e.houseType==d.tanker&&this.refreshTanker()},r.teamLevelEventFun=function(){this.init()},r.init=function(){if(this.teamData=m.instance.tables.Team[v.instance.teamLevel],this.SoldierPosArry.children.length<this.teamData.SoldierNum){for(var t=this.SoldierPosArry.children.length,e=this.teamData.SoldierNum-t,n=0;n<e;n++)this.spawnOneSoldierPos(t+n);var i=this.teamData.SoldierNum,o=l(1,1,1);o.x=i>8?12.8:1.6*i,o.z=1.6*Math.ceil(i/8),this.SoldierPosArryBg.setPosition(l(-.8,0,-.8)),this.SoldierPosArryBg.setScale(o)}this.refreshTanker()},r.refreshTanker=function(){this._tankerHouseLevel=0;for(var t=c.query(c.allOf(y)),e=0;e<t.length;e++)if(t[e].get(y).houseType==d.tanker){this._tankerHouseLevel=t[e].get(y).houseLevel;break}if(this._tankerHouseLevel>0&&this.TankerPosArry.children.length<this._tankerHouseLevel){var n=this.TankerPosArry.children.length,i=this._tankerHouseLevel-n;if(i>0)for(var o=0;o<i;o++)this.spawnOneTankerPos(n+o)}},r.spawnOneSoldierPos=function(t){var e=this;g.instance.getItemSync(h.ReadyPos).then((function(n){n.parent=e.SoldierPosArry,n.setPosition(l(1.6*Math.floor(t%8),0,1.6*Math.floor(t/8))),n.setScale(l(1,1,1)),n.name="SoldierPos"+t,n.setSiblingIndex(t),e.unschedule(e.RestoreSoldiers),e.scheduleOnce(e.RestoreSoldiers,.1)}))},r.spawnOneTankerPos=function(t){var e=this;g.instance.getItemSync(h.ReadyPos).then((function(n){n.parent=e.TankerPosArry,n.setPosition(l(4*t,0,0)),n.setScale(l(1.5,1.5,1.5)),n.name="TankerPos"+t,n.setSiblingIndex(t),n.getComponent(b).ent.get(_).posType=f.tanker}))},r.RestoreSoldiers=function(){C.instance.emit(p.RestoreSoldiers)},e}(u)).prototype,"SoldierPosArry",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(k.prototype,"TankerPosArry",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(k.prototype,"SoldierPosArryBg",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=k))||T)||T)),r._RF.pop()}}})),System.register("chunks:///_virtual/ReadyComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o,r,s,a;return{setters:[function(t){e=t.inheritsLoose,n=t.applyDecoratedDescriptor,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator},function(t){a=t.ecs}],execute:function(){var l,c,u,h,p,d;r._RF.push({},"f27b1pxcr5GypDXNH2jCSCV","ReadyComp",void 0);var f=s.ccclass,g=s.property;t("ReadyComp",(l=f("ReadyComp"),c=a.register("ReadyComp"),u=g({tooltip:"指挥官等级"}),l(h=c((p=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"chief",d,o(e)),e}e(n,t);var r=n.prototype;return r.reset=function(){},r.start=function(){},r.update=function(t){},n}(a.Comp),d=n(p.prototype,"chief",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),h=p))||h)||h)),r._RF.pop()}}})),System.register("chunks:///_virtual/Recycle.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component}],execute:function(){var r;n._RF.push({},"b1fa4AmQc9Mf4kBQWUKOtcT","Recycle",void 0);var s=i.ccclass;i.property,t("Recycle",s("Recycle")(r=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).path="",e}return e(n,t),n}(o))||r),n._RF.pop()}}})),System.register("chunks:///_virtual/ResKeeper.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResLoader.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component},function(t){r=t.resLoader}],execute:function(){var s;n._RF.push({},"e7548uPzG1IHbJAG5JOhIeu","ResKeeper",void 0);var a=i.ccclass;t("ResKeeper",a(s=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).resCache=new Set,e}e(n,t);var i=n.prototype;return i.load=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];r.load.apply(r,e)},i.cacheAsset=function(t){this.resCache.has(t)||(t.addRef(),this.resCache.add(t))},i.onDestroy=function(){this.releaseAssets()},i.releaseAssets=function(){this.resCache.forEach((function(t){t.decRef()})),this.resCache.clear()},n}(o))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/ResLoader.ts",["cc","./GameUtil.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.cclegacy,n=t.js,i=t.Asset,o=t.assetManager},function(t){r=t.GameUtil}],execute:function(){e._RF.push({},"4b081G1b9pJvbDtVt9AUhXd","ResLoader",void 0);var s=t("default",function(){function t(){}var e=t.prototype;return e.parseLoadResArgs=function(t,e,o,r){var s=t,a=e,l=o,c=r;if(void 0===r){var u=n.isChildClassOf(e,i);o?(c=o,u&&(l=null)):void 0!==o||u||(c=e,l=null,a=null),void 0===o||u||(l=e,a=null)}return{paths:s,type:a,onProgress:l,onComplete:c}},e.loadByBundleAndArgs=function(t,e){e.dir?t.loadDir(e.paths,e.type,e.onProgress,e.onComplete):(e.paths,t.load(e.paths,e.type,e.onProgress,e.onComplete))},e.loadByArgs=function(t){var e=this;if(t.bundle)if(o.bundles.has(t.bundle)){var n=o.bundles.get(t.bundle);this.loadByBundleAndArgs(n,t)}else o.loadBundle(t.bundle,(function(n,i){n||e.loadByBundleAndArgs(i,t)}));else r.instance.getBundle("ui").then((function(n){e.loadByBundleAndArgs(n,t)}))},e.load=function(t,e,n,i,o){var r=null;"string"==typeof e||e instanceof Array?(r=this.parseLoadResArgs(e,n,i,o)).bundle=t:r=this.parseLoadResArgs(t,e,n,i),this.loadByArgs(r)},e.loadDir=function(t,e,n,i,o){var r=null;"string"==typeof e?(r=this.parseLoadResArgs(e,n,i,o)).bundle=t:r=this.parseLoadResArgs(t,e,n,i),r.dir=r.paths,this.loadByArgs(r)},e.loadRemote=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];o.loadRemote(t,n)},t}());t("resLoader",new s),e._RF.pop()}}})),System.register("chunks:///_virtual/ResReleaseComp.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component}],execute:function(){var r;n._RF.push({},"6e78aiMC8RNK4CBpjEveSxO","ResReleaseComp",void 0);var s=i.ccclass;i.property,t("ResReleaseComp",s("ResReleaseComp")(r=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){},i.onDisable=function(){},n}(o))||r),n._RF.pop()}}})),System.register("chunks:///_virtual/RoleAnimComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./AudioManager.ts","./PoolManager.ts","./BadgeEntity.ts","./RoleEntity.ts","./ECS.ts","./BagComp.ts","./EnemyComp.ts","./HurtComp.ts","./MedicComp.ts","./NavToComp.ts","./RoleComp.ts","./ShootComp.ts","./SoldierComp.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.SkeletalAnimation,r=t.physics,s=t.tween},function(t){a=t.RoleClips,l=t.RoleModel,c=t.Sounds,u=t.ResEnum,h=t.BadgeType},function(t){p=t.GlobalSingle},function(t){d=t.StorageData},function(t){f=t.default},function(t){g=t.default},function(t){m=t.BadgeEntity},function(t){v=t.RoleEntity},function(t){y=t.ecs},function(t){b=t.BagComp},function(t){C=t.EnemyComp},function(t){_=t.HurtComp},function(t){E=t.MedicComp},function(t){w=t.NavToComp},function(t){S=t.RoleComp},function(t){P=t.ShootComp},function(t){M=t.SoldierComp}],execute:function(){var T;n._RF.push({},"a958apnHERGp7Q+7Zr+TYVD","RoleAnimComp",void 0);var k=i.ccclass;i.property,t("RoleAnimComp",k("RoleAnimComp")(T=y.register("RoleAnimComp")(T=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).skeletalAnimation=null,e.roleEntity=void 0,e}e(n,t);var i=n.prototype;return i.reset=function(){this.unRegisterEvent()},i.init=function(){this.roleEntity=this.ent.get(v);var t=this.roleEntity.animNode.getComponent(o);t?(this.skeletalAnimation=t,this.skeletalAnimation.clips=p.instance.clips,this.skeletalAnimation.defaultClip=this.skeletalAnimation.clips[0],this.skeletalAnimation.playOnLoad=!0,this.roleEntity.gunSocket=this.skeletalAnimation.sockets[0].target,this.skeletalAnimation.sockets[1]&&this.ent.has(b)&&(this.ent.get(b).bag=this.skeletalAnimation.sockets[1].target.getChildByName("bag")),this.unRegisterEvent(),this.registerEvent(),this.roleEntity.isPlayer&&this.roleEntity.setMoveSpeed(p.instance.playerMoveSpeed)):(this.skeletalAnimation=null,this.roleEntity.gunSocket=null,this.ent.has(b)&&(this.ent.get(b).bag=null))},i.registerEvent=function(){this.skeletalAnimation&&this.skeletalAnimation.on(o.EventType.FINISHED,this.animEvenFun,this)},i.unRegisterEvent=function(){this.skeletalAnimation&&this.skeletalAnimation.off(o.EventType.FINISHED,this.animEvenFun,this)},i.animEvenFun=function(t,e){if(t==o.EventType.FINISHED){var n=this.ent.get(S);e.name==a.attack1&&n.currentHp>0&&this.roleEntity.isPlayer&&this.skeletalAnimation.getState(a.run).isPlaying,e.name==a.die&&this.dieFun()}},i.idle=function(){this.skeletalAnimation&&!this.skeletalAnimation.getState(a.idle).isPlaying&&this.skeletalAnimation.play(a.idle)},i.attack1=function(t){this.skeletalAnimation&&(t&&(this.skeletalAnimation.getState(a.attack1).speed=t),this.skeletalAnimation.crossFade(a.attack1))},i.run=function(){this.skeletalAnimation&&!this.skeletalAnimation.getState(a.run).isPlaying&&this.skeletalAnimation.play(a.run)},i.motorcycle=function(){this.skeletalAnimation&&!this.skeletalAnimation.getState(a.motorcycle).isPlaying&&this.skeletalAnimation.play(a.motorcycle)},i.die=function(){this.roleEntity.roleModel==l.Tanker?f.instance.playSoundEffect(c.Bomb):f.instance.playSoundEffect(c.Dead),this.roleEntity.rigidbody.useGravity=!1,this.roleEntity.rigidbody.type=r.ERigidBodyType.STATIC,this.roleEntity.collider.enabled=!1,this.roleEntity.ent.remove(w),this.skeletalAnimation?this.skeletalAnimation.play(a.die):this.dieFun(),this.boomBadge(this.roleEntity.node.worldPosition)},i.sit=function(){this.skeletalAnimation&&this.skeletalAnimation.play(a.sit)},i.carry=function(){this.skeletalAnimation&&this.skeletalAnimation.play(a.carry)},i.dieFun=function(){this.roleEntity.ent.has(M)&&this.roleEntity.roleModel!=l.Tanker&&y.query(y.allOf(E)).length>0&&Math.random()<.1?(this.ent.remove(M),this.roleEntity.CureIcon.active=!0,this.roleEntity.ent.add(_)):this.directDeath()},i.directDeath=function(){var t=this;this.ent.remove(M),this.ent.remove(P);var e=this.roleEntity.node.getPosition().clone();e.y-=1,s(this.roleEntity.node).to(.5,{position:e}).call((function(){t.ent&&(t.ent.has(C)&&(d.instance.enemys[t.roleEntity.node.parent.name]=1,d.instance.enemys=d.instance.enemys),t.ent.destroy(!0))})).start()},i.boomBadge=function(t){var e=this;g.instance.getItemSync(u.Badge).then((function(n){var i=n.getComponent(m);e.ent.has(C)?i.badgeType=h.yellow:i.badgeType=h.gray,n.parent=p.instance.map,n.setWorldPosition(t),i.initBadge(n),i.appyForceImpulse()}))},n}(y.Comp))||T)||T),n._RF.pop()}}})),System.register("chunks:///_virtual/RoleComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./UIManager.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator},function(t){r=t.UIID},function(t){s=t.GlobalSingle},function(t){a=t.UIManager},function(t){l=t.RoleEntity},function(t){c=t.ecs}],execute:function(){var u;i._RF.push({},"72858zpBZ9I97ghKcJQtYih","RoleComp",void 0);var h=o.ccclass;o.property,t("RoleComp",h("RoleComp")(u=c.register("RoleComp")(u=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._isShowWarnUi=!1,e._hp=100,e._currentHp=100,e.opponentEntity=null,e.opponentDistance=0,e.nowTime=60,e.lastNavTime=0,e}e(i,t);var o=i.prototype;return o.reset=function(){this.currentHp=this.hp},o.init=function(){var t=s.instance.tables.Role[this.ent.get(l).roleId];this.hp=t.Hp},n(i,[{key:"hp",get:function(){return this._hp},set:function(t){this._hp=t,this.currentHp=t}},{key:"currentHp",get:function(){return this._currentHp},set:function(t){this._currentHp=t,this.ent&&this.ent.get(l).isPlayer&&this.ent.has(i)&&(this.ent.get(i).currentHp/this.ent.get(i).hp<.3?this._isShowWarnUi||(this._isShowWarnUi=!0,a.instance.open(r.HpWarnUi)):this._isShowWarnUi&&(this._isShowWarnUi=!1,a.instance.close(a.instance.getUI(r.HpWarnUi))))}}]),i}(c.Comp))||u)||u),i._RF.pop()}}})),System.register("chunks:///_virtual/RoleCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnemyComp.ts","./RoleAnimComp.ts","./RoleComp.ts","./RoleEntity.ts","./PoolManager.ts","./Constant.ts","./StorageData.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.CCInteger,c=t.v3},function(t){u=t.EnemyComp},function(t){h=t.RoleAnimComp},function(t){p=t.RoleComp},function(t){d=t.RoleEntity},function(t){f=t.default},function(t){g=t.ResEnum},function(t){m=t.StorageData},function(t){v=t.BaseCtrl}],execute:function(){var y,b,C,_,E;s._RF.push({},"288702Y60BLWoDFHChrNIOI","RoleCtrl",void 0);var w=a.ccclass,S=a.property;t("RoleCtrl",(y=w("RoleCtrl"),b=S({type:l,tooltip:"角色表里面的编号",displayName:"角色编号"}),y((E=e((_=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"_roleId",E,o(e)),e.roleEntity=void 0,e}n(e,t);var s=e.prototype;return s.onEnable=function(){this.showPrefab()},s.update=function(t){},s.debugSwitch=function(){this.node.removeAllChildren(),this.debug&&this.showPrefab(!0)},s.showPrefab=function(t){var e=this;this.isUnlocked=!0,m.instance.enemys[this.node.name]||f.instance.getItemSync(g.Role).then((function(n){var i=n.getComponent(d);i.isPlayer=!1,i.initRole(),n.setPosition(c(0,0,0)),n.parent=e.node,t&&(e.roleEntity=i,i.roleId=e.roleId,i.setRoleData()),i.ent.add(u).init(),i.ent.add(h),i.roleId=e.roleId,i.setRoleData();var o=i.ent.add(p);o.init(),o.hp=o.hp*(1+.2*m.instance.level)}))},r(e,[{key:"roleId",get:function(){return this._roleId},set:function(t){this._roleId=t,this.roleEntity.roleId=this._roleId,this.roleEntity.setRoleData()}}]),e}(v)).prototype,"_roleId",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e(_.prototype,"roleId",[b],Object.getOwnPropertyDescriptor(_.prototype,"roleId"),_.prototype),C=_))||C)),s._RF.pop()}}})),System.register("chunks:///_virtual/RoleEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CCComp.ts","./ECS.ts","./Constant.ts","./BadgeEntity.ts","./BagComp.ts","./EventManager.ts","./StorageData.ts","./GlobalSingle.ts","./RoleAnimComp.ts","./GunComp.ts","./RoleComp.ts","./BulletEntity.ts","./NavToComp.ts","./SoldierComp.ts","./PoolManager.ts","./Util.ts","./JoystickMoveComp.ts","./ThirdFreeLookCamera.ts","./VehicleComp.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M,T,k,N,R,B,F,L,A,D,x,I,U,z,G,H,O,V,j;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose,s=t.createClass},function(t){a=t.cclegacy,l=t._decorator,c=t.Node,u=t.Prefab,h=t.Material,p=t.RigidBody,d=t.CylinderCollider,f=t.Color,g=t.Quat,m=t.physics,v=t.Vec3,y=t.instantiate,b=t.ModelComponent,C=t.SkinnedMeshRenderer,_=t.v3},function(t){E=t.CCComp},function(t){w=t.ecs},function(t){S=t.RoleModel,P=t.ResEnum,M=t.GameEvent,T=t.GameState,k=t.RoleClips},function(t){N=t.BadgeEntity},function(t){R=t.BagComp},function(t){B=t.EventManager},function(t){F=t.StorageData},function(t){L=t.GlobalSingle},function(t){A=t.RoleAnimComp},function(t){D=t.GunComp},function(t){x=t.RoleComp},function(t){I=t.BulletEntity},function(t){U=t.NavToComp},function(t){z=t.SoldierComp},function(t){G=t.default},function(t){H=t.Util},function(t){O=t.JoystickMoveComp},function(t){V=t.ThirdFreeLookCamera},function(t){j=t.VehicleComp}],execute:function(){var W,Q,J,X,q,Y,Z,K,$,tt,et,nt,it,ot,rt,st,at,lt,ct,ut;a._RF.push({},"8e04cmaow1ICI7b1Xqkm4Ab","RoleEntity",void 0);var ht=l.ccclass,pt=l.property;t("RoleEntity",(W=ht("RoleEntity"),Q=w.register("RoleEntity",!1),J=pt(c),X=pt([u]),q=pt([h]),Y=pt(c),Z=pt(c),K=pt(c),$=pt(p),tt=pt(d),W(et=Q((it=e((nt=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"modelNode",it,o(e)),i(e,"modelPrefabs",ot,o(e)),i(e,"roleMaterials",rt,o(e)),i(e,"Aureola",st,o(e)),i(e,"CureIcon",at,o(e)),i(e,"StrongArrow",lt,o(e)),e.roleId=void 0,e.animNode=null,e.isPlayer=!1,e._strengthenSize=3,e._roleModel=S.commander_1,i(e,"rigidbody",ct,o(e)),i(e,"collider",ut,o(e)),e._gunAttach=null,e._textureName=void 0,e._isStrengthen=!1,e._isTakePlane=!1,e.otherRoleEntity=void 0,e.skinnedMeshRenderer=void 0,e.srcColor=new f(0,0,0,255),e.hitLightColor=new f(200,117,117,255),e.strengthenColor=new f(29,77,92,255),e._rotateQuat=new g,e.isRelive=!1,e}n(e,t);var a=e.prototype;return a.onLoad=function(){t.prototype.onLoad.call(this)},a.reset=function(){this.rigidbody.useGravity=!0,this.collider.enabled=!0,this.CureIcon.active=!1,this.isRelive=!1,this.rigidbody.type=m.ERigidBodyType.DYNAMIC,G.instance.putItem(P.Role,this.node)},a.onEnable=function(){this.initRole(),this.collider.on("onTriggerEnter",this.onTriggerEnter,this),this.collider.on("onTriggerExit",this.onTriggerExit,this),this.collider.on("onCollisionEnter",this.onCollisionEnter,this),this.collider.on("onCollisionExit",this.onCollisionExit,this),B.instance.on(M.PackageEvent,this.packageEventFun,this),B.instance.on(M.StatusEvent,this.StatusEventFun,this),this.isRelive=!1,this.isPlayer&&(B.instance.on(M.TeamLevelEvent,this.teamLevelChange,this),B.instance.on(M.StatusEvent,this.statusChangeFun,this))},a.update=function(t){if(this.Aureola.active&&F.instance.status==T.battle)for(var n,i=r(L.instance.soldierEntities);!(n=i()).done;){var o=n.value;this.otherRoleEntity=o.get(e),this.otherRoleEntity&&(v.distance(this.node.getWorldPosition(),this.otherRoleEntity.node.worldPosition)<this.strengthenSize?this.otherRoleEntity.strengthen():this.otherRoleEntity.resetStrengthen())}this.CureIcon.active&&this.CureIcon.lookAt(L.instance.camera3d.getWorldPosition()),this.StrongArrow.active&&this.StrongArrow.lookAt(L.instance.camera3d.getWorldPosition()),this.isPlayer&&this.node.worldPosition.z>6&&this.ent.get(x).currentHp<this.ent.get(x).hp&&(this.ent.get(x).currentHp+=Math.floor(.2*this.ent.get(x).hp)/60,this.ent.get(x).currentHp>this.ent.get(x).hp&&(this.ent.get(x).currentHp=this.ent.get(x).hp))},a.onDisable=function(){this.collider.off("onTriggerEnter",this.onTriggerEnter,this),this.collider.off("onTriggerExit",this.onTriggerExit,this),this.collider.off("onCollisionEnter",this.onCollisionEnter,this),this.collider.off("onCollisionExit",this.onCollisionExit,this),B.instance.off(M.PackageEvent,this.packageEventFun,this),B.instance.off(M.StatusEvent,this.StatusEventFun,this),this.isPlayer&&(B.instance.off(M.TeamLevelEvent,this.teamLevelChange,this),B.instance.off(M.StatusEvent,this.statusChangeFun,this))},a.StatusEventFun=function(){F.instance.status==T.battle&&(this.isRelive=!1)},a.packageEventFun=function(t,e){this.isPlayer?this.ent.get(A).idle():this.ent.destroy(!0)},a.statusChangeFun=function(t){F.instance.status==T.ready?this.Aureola.active=!1:this.Aureola.active=!0},a.beHit=function(t){var e=this,n=this.ent.get(x);n&&n.currentHp>0&&(this.ent.has(j)?this.ent.get(j).currentHp-=t:n.currentHp-=t,this.hitLight(),n.currentHp<=0&&(this.CureIcon.active=!1,this.StrongArrow.active=!1,this.isPlayer?(this.ent.get(R).boomBag(this.node.worldPosition),L.instance.camera3d.getComponent(V).setFollowTarget(null),this.node.setWorldPosition(L.instance.playerBorthWorldPos),this.scheduleOnce((function(){L.instance.camera3d.getComponent(V).setFollowTarget(L.instance.player),H.instance.playFX(P.RebornFX,e.node,e.node.worldPosition,2),e.resetHp()}),2)):(this.ent.get(A).die(),this.roleModel==S.Tanker&&H.instance.playFX(P.BoomFX,this.node,this.node.worldPosition,.1))))},a.beHitDelay=function(t,e){var n=this;this.scheduleOnce((function(){n.beHit(t)}),e)},a.hitLight=function(){var t=this;this.skinnedMeshRenderer&&this.scheduleOnce((function(){t.isStrengthen=!1,t.resetColor()}),1/30)},a.strengthen=function(){!this.isPlayer&&!this.isStrengthen&&this.ent.get(x).currentHp>0&&(this.isStrengthen=!0,this.StrongArrow.active=!0)},a.resetStrengthen=function(){this.isStrengthen&&(this.isStrengthen=!1,this.StrongArrow.active=!1,this.resetColor())},a.resetColor=function(){},a.onTriggerEnter=function(t){var e=t.otherCollider.node,n=e.getComponent(I);n&&this.beHit(n.Atk),e.getComponent(N)&&this.isPlayer&&this.ent.get(R).pushBadge(e)},a.onCollisionEnter=function(t){var e=t.otherCollider.node;e.getComponent(N)&&this.isPlayer&&this.ent.get(R).pushBadge(e)},a.onTriggerExit=function(t){},a.onCollisionExit=function(t){},a.initRole=function(){this.roleModel==S.Tanker?this.collider.radius=1.5:this.collider.radius=.6,this.collider.enabled=!0,this.CureIcon.active=!1,this.StrongArrow.active=!1},a.teamLevelChange=function(t){var e=L.instance.tables.Team[F.instance.teamLevel];this.roleId=e.RoleId,this.setRoleData()},a.setRoleData=function(){var t=L.instance.tables.Role[this.roleId];this.roleModel=t.Model,this.textureName=t.Texture;var e=this.ent.get(D);e||(e=this.ent.add(D)),e&&!H.instance.isEmptyStr(t.WeaponID)&&e.setGunTableData(t.WeaponID)},a.setModel=function(t){this.animNode=y(this.modelPrefabs[t]),this.modelNode.removeAllChildren(),this.modelNode.addChild(this.animNode),this.ent.get(A).init()},a.setSkin=function(){for(var t=this.animNode.getComponentInChildren(b).materials,e=0;e<t.length;e++)this.animNode.getComponentInChildren(b).setMaterial(this.roleMaterials[this.textureName],e);this.skinnedMeshRenderer=this.modelNode.getComponentInChildren(C)},a.setMoveSpeed=function(t){this.ent.get(A).skeletalAnimation&&(this.ent.get(A).skeletalAnimation.getState(k.run).speed=t/5),this.isPlayer&&(this.ent.get(O).stopSpeed=t,this.ent.get(O).normalSpeed=t,this.ent.get(O).fastSpeed=t)},a.reLive=function(t,e){this.ent.add(z).init(),this.node.parent=L.instance.map,this.node.setWorldPosition(e),t.occupy=!0,t.occupyNode=this.node,this.CureIcon.active=!1;var n=this.ent.add(U);n.needNavNode=this.node,n.destPos={worldPos:t.idlePos.getWorldPosition(),target:t.idlePos},this.rigidbody.useGravity=!0,this.rigidbody.type=m.ERigidBodyType.DYNAMIC,this.collider.enabled=!0,this.resetHp(),this.isRelive=!0},a.resetHp=function(){this.ent.get(x).currentHp=this.ent.get(x).hp},a.switchGun=function(t){this.ent.remove(D),this.ent.add(D).setGunTableData(t),H.instance.playFX(P.GunFX,L.instance.map,this.gunSocket.worldPosition,.5)},s(e,[{key:"strengthenSize",get:function(){return this._strengthenSize},set:function(t){this._strengthenSize=t,this.Aureola.setScale(_(2*this._strengthenSize,0,2*this._strengthenSize))}},{key:"roleModel",get:function(){return this._roleModel},set:function(t){this._roleModel=t,this.setModel(this._roleModel)}},{key:"gunSocket",get:function(){return this._gunAttach},set:function(t){this._gunAttach=t,this._gunAttach&&this.ent.has(D)&&(this.ent.get(D).attachNode=this._gunAttach)}},{key:"textureName",get:function(){return this._textureName},set:function(t){this._textureName=t,this.setSkin()}},{key:"isStrengthen",get:function(){return this._isStrengthen},set:function(t){this._isStrengthen=t}},{key:"isTakePlane",get:function(){return this._isTakePlane},set:function(t){this._isTakePlane=t,this._isTakePlane?this.Aureola.active&&(this.Aureola.active=!1):F.instance.status==T.battle&&(this.Aureola.active=!0)}}]),e}(E)).prototype,"modelNode",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ot=e(nt.prototype,"modelPrefabs",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),rt=e(nt.prototype,"roleMaterials",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),st=e(nt.prototype,"Aureola",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=e(nt.prototype,"CureIcon",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lt=e(nt.prototype,"StrongArrow",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ct=e(nt.prototype,"rigidbody",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ut=e(nt.prototype,"collider",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),et=nt))||et)||et)),a._RF.pop()}}})),System.register("chunks:///_virtual/RoleSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GameUtil.ts","./GlobalSingle.ts","./StorageData.ts","./EventManager.ts","./EnemyComp.ts","./RoleAnimComp.ts","./RoleComp.ts","./SoldierComp.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Vec3},function(t){s=t.GameEvent,a=t.GameState},function(t){l=t.GameUtil},function(t){c=t.GlobalSingle},function(t){u=t.StorageData},function(t){h=t.EventManager},function(t){p=t.EnemyComp},function(t){d=t.RoleAnimComp},function(t){f=t.RoleComp},function(t){g=t.SoldierComp},function(t){m=t.RoleEntity},function(t){v=t.ecs}],execute:function(){var y;i._RF.push({},"6d11aqowH1OZrMQFySckWvN","RoleSys",void 0);var b=o.ccclass;t("RoleSys",b("RoleSys")(y=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._distanceTemp=void 0,e._minDistance=null,e._minDistanceRoleEntity=null,e}e(i,t);var o=i.prototype;return o.init=function(){this.registerEvent()},o.filter=function(){return v.allOf(f)},o.entityEnter=function(t){this.refreshEntities(0,t)},o.firstUpdate=function(t){},o.entityRemove=function(t){this.refreshEntities(1,t)},o.refreshEntities=function(t,e){c.instance.enemyEntities=v.query(v.allOf(p));for(var n=[],i=v.query(v.allOf(g)),o=0;o<i.length;o++)i[o].get(m).isRelive||n.push(i[o]);c.instance.soldierEntities=n,h.instance.emit(s.RoleNumChangeEvent),1==t&&(1==c.instance.soldierEntities.length&&(u.instance.status=a.ready),0==c.instance.enemyEntities.length&&(u.instance.status=a.win)),0==t&&1==c.instance.soldierEntities.length&&c.instance.soldierEntities[0].get(m).isPlayer||l.instance.storeSoldiers()},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value,s=o.get(m),a=o.get(f);if(o.has(g))if(c.instance.enemyEntities.length>0){for(var l,u=n(c.instance.enemyEntities);!(l=u()).done;){var h=l.value,d=h.get(f);d.currentHp>0&&(this._distanceTemp=Number(r.distance(s.node.worldPosition,d.ent.get(m).node.worldPosition).toFixed(3)),this._minDistance?this._minDistance>this._distanceTemp&&(this._minDistance=this._distanceTemp,this._minDistanceRoleEntity=h):(this._minDistance=this._distanceTemp,this._minDistanceRoleEntity=h))}a.opponentDistance=this._minDistance,a.opponentEntity=this._minDistanceRoleEntity,this._minDistance=null,this._minDistanceRoleEntity=null}else a.opponentDistance=null,a.opponentEntity=null;if(o.has(p))if(c.instance.soldierEntities.length>0){for(var v,y=n(c.instance.soldierEntities);!(v=y()).done;){var b=v.value,C=b.get(f);this._distanceTemp=Number(r.distance(s.node.worldPosition,C.ent.get(m).node.worldPosition).toFixed(3)),this._minDistance?this._minDistance>this._distanceTemp&&(this._minDistance=this._distanceTemp,this._minDistanceRoleEntity=b):(this._minDistance=this._distanceTemp,this._minDistanceRoleEntity=b)}a.opponentDistance=this._minDistance,a.opponentEntity=this._minDistanceRoleEntity,this._minDistance=null,this._minDistanceRoleEntity=null}else a.opponentDistance=null,a.opponentEntity=null}},o.registerEvent=function(){h.instance.on(s.StatusEvent,this.statusChangeFun,this)},o.statusChangeFun=function(t){if(u.instance.status==a.win)for(var e,i=n(c.instance.soldierEntities);!(e=i()).done;){var o=e.value;o.get(m).isPlayer||o.get(d).idle()}},i}(v.ComblockSystem))||y),i._RF.pop()}}})),System.register("chunks:///_virtual/RootSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./SpawnSoldierSys.ts","./JoystickMoveSys.ts","./RoleSys.ts","./NavToSys.ts","./GunSys.ts","./HpProgressBarSys.ts","./ShootSys.ts","./FlySys.ts","./GunFactorySys.ts","./AirDropSys.ts","./UpgradeSys.ts","./BadgeStackSys.ts","./DeskSys.ts","./NBombSys.ts","./HowitzerSys.ts","./PlaneSys.ts","./GuideSys.ts","./VehicleSys.ts","./BadgePopSys.ts","./FullGunPopSys.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs},function(t){r=t.SpawnSoldierSys},function(t){s=t.JoystickMoveSys},function(t){a=t.RoleSys},function(t){l=t.NavToSys},function(t){c=t.GunSys},function(t){u=t.HpProgressBarSys},function(t){h=t.ShootSys},function(t){p=t.FlySys},function(t){d=t.GunFactorySys},function(t){f=t.AirDropSys},function(t){g=t.UpgradeSys},function(t){m=t.BadgeStackSys},function(t){v=t.DeskSys},function(t){y=t.NBombSys},function(t){b=t.HowitzerSys},function(t){C=t.PlaneSys},function(t){_=t.GuideSys},function(t){E=t.VehicleSys},function(t){w=t.BadgePopSys},function(t){S=t.FullGunPopSys}],execute:function(){var P;n._RF.push({},"a0877c/CUBG2Jj3wzz0S+Hi","RootSys",void 0);var M=i.ccclass;t("RootSys",M("RootSys")(P=function(t){function n(){var e;return(e=t.call(this)||this).add(new a),e.add(new s),e.add(new l),e.add(new r),e.add(new c),e.add(new u),e.add(new h),e.add(new p),e.add(new d),e.add(new f),e.add(new g),e.add(new m),e.add(new v),e.add(new y),e.add(new b),e.add(new C),e.add(new _),e.add(new E),e.add(new w),e.add(new S),e}return e(n,t),n}(o.RootSystem))||P),n._RF.pop()}}})),System.register("chunks:///_virtual/ScaleComp.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,s,a;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.tween,r=t.v3,s=t.Tween,a=t.Component}],execute:function(){var l;n._RF.push({},"17cb2fimaRJ/rg7aa3deB1K","ScaleComp",void 0);var c=i.ccclass;i.property,t("ScaleComp",c("ScaleComp")(l=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){o(this.node).to(.5,{scale:r(1.2,1.2,1.2)}).to(.5,{scale:r(1,1,1)}).union().repeatForever().start()},i.onDisable=function(){s.stopAllByTarget(this.node)},n}(a))||l),n._RF.pop()}}})),System.register("chunks:///_virtual/Scripts",["./AirDropComp.ts","./ArrowComp.ts","./BadgeComp.ts","./BadgePopComp.ts","./BadgeStackComp.ts","./BagComp.ts","./BulletHowitzerComp.ts","./CarComp.ts","./DeskComp.ts","./EnemyComp.ts","./FlyComp.ts","./FullGunPopComp.ts","./GunComp.ts","./GunFactoryComp.ts","./HouseComp.ts","./HpProgressBarComp.ts","./HurtComp.ts","./JoystickMoveComp.ts","./MedicComp.ts","./NBombComp.ts","./NavToComp.ts","./PlaneComp.ts","./ReadyComp.ts","./RoleAnimComp.ts","./RoleComp.ts","./ShootComp.ts","./SoldierComp.ts","./SpawnPosComp.ts","./TeamLevelComp.ts","./TowerComp.ts","./UpgradeComp.ts","./VehicleComp.ts","./AirDropEntity.ts","./AircraftEntity.ts","./Arrow3dEntity.ts","./ArrowEntity.ts","./BadgeEntity.ts","./BadgePopEntity.ts","./BadgeStackEntity.ts","./BattleBtnEntity.ts","./BulletEntity.ts","./BulletHowitzerEntity.ts","./BulletPlaneEntity.ts","./CarEntity.ts","./DeskEntity.ts","./FullGunPopEntity.ts","./GroundEntity.ts","./GunFactoryEntity.ts","./GunFactoryUpgradeEntity.ts","./HouseEntity.ts","./HowitzerEntity.ts","./MedicEntity.ts","./MedicStretcherEntity.ts","./MotoEntity.ts","./NBombEntity.ts","./PlaneEntity.ts","./PostEntity.ts","./ReadyAreaEntity.ts","./RoleEntity.ts","./SpawnPosEntity.ts","./StorageEntity.ts","./StretcherEntity.ts","./TeamLevelEntity.ts","./TowerEntity.ts","./TruckEntity.ts","./UpgradeAreaEntity.ts","./WoodenBarrierEntity.ts","./CCComp.ts","./ECS.ts","./RootSys.ts","./AirDropSys.ts","./BadgePopSys.ts","./BadgeStackSys.ts","./DeskSys.ts","./FlySys.ts","./FullGunPopSys.ts","./GuideSys.ts","./GunFactorySys.ts","./GunSys.ts","./HowitzerSys.ts","./HpProgressBarSys.ts","./JoystickMoveSys.ts","./NBombSys.ts","./NavToSys.ts","./PlaneSys.ts","./RoleSys.ts","./ShootSys.ts","./SpawnSoldierSys.ts","./UpgradeSys.ts","./VehicleSys.ts","./Boot.ts","./Constant.ts","./GameAd.ts","./GameUtil.ts","./GlobalSingle.ts","./LevelUtil.ts","./AirDropCtrl.ts","./AircraftCtrl.ts","./BadgeStackCtrl.ts","./BaseCtrl.ts","./BattleBtnCtrl.ts","./CarCtrl.ts","./DeskCtrl.ts","./GunFactoryCtrl.ts","./HouseCtrl.ts","./HowitzerCtrl.ts","./MedicCtrl.ts","./NBombCtrl.ts","./PlayerCtrl.ts","./PostCtrl.ts","./ReadyAreaCtrl.ts","./RoleCtrl.ts","./StorageBoxCtrl.ts","./TeamLevelCtrl.ts","./TowerCtrl.ts","./WoodenBarrierCtrl.ts","./AnimFinishRecycle.ts","./DelayRecycle.ts","./DrawGround.ts","./EnemyLevelCtrl.ts","./EnemyLevelExport.ts","./GroundCtrl.ts","./MapCtrl.ts","./MapNavExport.ts","./MapNode.ts","./Recycle.ts","./StartBattleAnim.ts","./test.ts","./GunPlacePart.ts","./Toast.ts","./StorageData.ts","./UMEvent.ts","./Util.ts","./AirDropUi.ts","./AwardUi.ts","./BadgesUi.ts","./BuffUi.ts","./FinishUi.ts","./Game3dUI.ts","./HpWarnUi.ts","./NbombUi.ts","./BtnFreeItem.ts","./BtnStatusComp.ts","./FlagItem.ts","./HpWarnComp.ts","./LevelProgressComp.ts","./ResReleaseComp.ts","./ScaleComp.ts","./SpinComp.ts","./UpgradeLevelAnim.ts","./UpgradeLevelComp.ts","./UpgradeLevelUi.ts","./AdManager.ts","./AudioManager.ts","./CameraUtil.ts","./Quaternion.ts","./ThirdFreeLookCamera.ts","./VectorTool.ts","./FadeComp.ts","./EventManager.ts","./Joystick.ts","./NavMesh.ts","./NavMeshEditor.ts","./base64.mjs_cjs=&original=.js","./asm-js.mjs_cjs=&original=.js","./recast.mjs_cjs=&original=.js","./wasmBinaryFile.mjs_cjs=&original=.js","./PoolManager.ts","./ResKeeper.ts","./ResLoader.ts","./UIManager.ts","./UIView.ts","./mesh-tiling.ts","./sower.ts","./spline-util-base.ts","./spline-util-renderer.ts","./type.ts","./cubic-bezier-curve.ts","./curve-sample.ts","./asset-operation.ts","./controller.ts","./gizmo.ts","./spline-grid-util.ts","./continuous-line-controller.ts","./editor.ts","./index.ts","./npm.ts","./spline-gizmo.ts","./spline-node-controller.ts","./types.ts","./utils.ts","./spline-curve-interface.ts","./spline-node-wrapper.ts","./spline-node.ts","./spline-smoother.ts","./spline.ts","./animation-curve.ts","./event.ts","./mathf.ts","./fixed-buffer.ts","./fixed-model-mesh.ts","./mesh-bender.ts","./mesh-tesselate.ts","./mesh-utility.ts","./mesh-vertex.ts","./source-mesh.ts","./pool.ts","./raycast.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}})),System.register("chunks:///_virtual/ShootComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"f772dDu+u5ItrZv9mwxAUH1","ShootComp",void 0);var s=i.ccclass;i.property,t("ShootComp",s("ShootComp")(r=o.register("ShootComp")(r=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.reset=function(){},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/ShootSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./Util.ts","./AudioManager.ts","./ThirdFreeLookCamera.ts","./PoolManager.ts","./GunComp.ts","./RoleAnimComp.ts","./RoleComp.ts","./ShootComp.ts","./VehicleComp.ts","./BulletEntity.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Vec3,s=t.Quat,a=t.v3},function(t){l=t.RoleClips,c=t.RoleModel,u=t.Sounds,h=t.ResEnum},function(t){p=t.GlobalSingle},function(t){d=t.Util},function(t){f=t.default},function(t){g=t.ThirdFreeLookCamera},function(t){m=t.default},function(t){v=t.GunComp},function(t){y=t.RoleAnimComp},function(t){b=t.RoleComp},function(t){C=t.ShootComp},function(t){_=t.VehicleComp},function(t){E=t.BulletEntity},function(t){w=t.RoleEntity},function(t){S=t.ecs}],execute:function(){var P;i._RF.push({},"626a2sE1E1HqKMNgwMd+I3l","ShootSys",void 0);var M=o.ccclass;t("ShootSys",M("ShootSys")(P=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._dirQuat=new s,e._moveDir=new r,e.delTime=0,e._destPos=void 0,e._startPos=void 0,e}e(i,t);var o=i.prototype;return o.filter=function(){return S.allOf(b,v,C)},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},o.firstUpdate=function(t){},o.update=function(t){for(var e,i=n(t);!(e=i()).done;){var o=e.value,a=o.get(w),c=o.get(b),u=o.get(v);c.opponentEntity&&c.opponentEntity.get(b).currentHp>0&&!a.isTakePlane&&!o.has(_)&&(this._destPos=c.opponentEntity.get(w).node.getWorldPosition(),this._startPos=a.node.getWorldPosition(),this._destPos.y=0,this._startPos.y=0,r.subtract(this._moveDir,this._destPos,this._startPos),s.fromViewUp(this._dirQuat,this._moveDir,r.UP),a.isPlayer||a.node.setRotation(this._dirQuat),c.nowTime+=1/60,c.nowTime>.4/u.Rate&&(a.isPlayer&&o.get(y).skeletalAnimation.getState(l.run).isPlaying||this.shootOnce(a,c,o.get(y),u)))}},o.shootOnce=function(t,e,n,i){if(p.instance.camera3d.getComponent(g).target&&p.instance.camera3d.getComponent(g).target.getComponent(w)){t.roleModel==c.Tanker?f.instance.playSoundEffect(u.TankAttack):f.instance.playSoundEffect(u.GunAttack);var o=i.gunPoint.getWorldPosition(),l=e.opponentEntity.get(w).node.getWorldPosition(),v=1/i.HitRate,y=a(l.x-v/2+Math.random()*v,o.y-Math.random(),l.z),b=y.clone();b.y=0,r.subtract(this._moveDir,b,this._startPos),s.fromViewUp(this._dirQuat,this._moveDir,r.UP),t.node.setRotation(this._dirQuat),e.nowTime=0,n.attack1(i.Rate/.4);var C=p.instance.tables.Bullet[i.BulletID],_=h.bulletPath+"/"+C.Prefab;m.instance.getItemSync(_).then((function(e){e.getComponent(E).setData(_,t.ent,C,o,y)})),e.opponentDistance>10&&(r.subtract(this._moveDir,y,o),s.fromViewUp(this._dirQuat,this._moveDir,r.UP),d.instance.playFX(h.FireFX,p.instance.map,o,.1,this._dirQuat))}},i}(S.ComblockSystem))||P),i._RF.pop()}}})),System.register("chunks:///_virtual/SoldierComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.RigidBodyGroup},function(t){r=t.RoleEntity},function(t){s=t.ecs}],execute:function(){var a;n._RF.push({},"1343dW78vxJ+6qKft4LYYqG","SoldierComp",void 0);var l=i.ccclass;i.property,t("SoldierComp",l("SoldierComp")(a=s.register("SoldierComp")(a=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.reset=function(){},i.init=function(){var t=this.ent.get(r);t.isPlayer||(t.rigidbody.setGroup(1<<o.Soldier),t.rigidbody.setMask(1<<o.Player|1<<o.Building|1<<o.Soldier|1<<o.Enemy|1<<o.BulletEnemy))},n}(s.Comp))||a)||a),n._RF.pop()}}})),System.register("chunks:///_virtual/source-mesh.ts",["./rollupPluginModLoBabelHelpers.js","cc","./mesh-vertex.ts","./mesh-utility.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,i=t.gfx,o=t.Quat,r=t.Vec3,s=t.Vec4,a=t.Mesh},function(t){l=t.default,c=t.MeshVertexFlags},function(t){u=t.default}],execute:function(){n._RF.push({},"0eba73fr/BFAqywv0rcR6s6","source-mesh",void 0),t("default",function(){n.build=function(t){return new n(t)};var t=n.prototype;function n(t){this.translation=new r,this.rotation=new o,this.scale=new r,this._mesh=void 0,this._vertices=[],this._triangles=[],this._minZ=[0],this._lengthZ=[0],this._minX=[0],this._lengthX=[0],this._minY=[0],this._lengthY=[0],t instanceof a?(this._mesh=t,this.translation=new r,this.rotation=new o,this.scale=new r):(this._mesh=t._mesh,this.translation=t.translation.clone(),this.rotation=t.rotation.clone(),this.scale=t.scale.clone())}return t.getVertices=function(t){return void 0===t&&(t=0),this._vertices[t]||this.buildData(),this._vertices[t]},t.getTriangles=function(t){return void 0===t&&(t=0),this._vertices[t]||this.buildData(),this._triangles[t]},t.getMinX=function(t){return void 0===t&&(t=0),this._vertices[t]||this.buildData(),this._minX[t]},t.getLengthX=function(t){return void 0===t&&(t=0),this._vertices[t]||this.buildData(),this._lengthX[t]},t.subCount=function(){return this.mesh?this.mesh.subMeshCount:0},t.translate=function(t,e,n){return this.reset(),"number"==typeof t?this.translation.set(t,e,n):this.translation.set(t),this},t.rotate=function(t){return this.reset(),this.rotation.set(t),this},t.scaleRes=function(t,e,n){return this.reset(),"number"==typeof t?this.scale.set(t,e,n):this.scale.set(t),this},t.reset=function(){this._vertices.length>0&&(this._vertices.forEach((function(t){t.forEach((function(t){l.pool.put(t)}))})),this._vertices.length=0),this._triangles.length=0},t.buildData=function(){for(var t=this.mesh.subMeshCount,e=0;e<t;e++){var n=this.scale.x<0;this.scale.y<0&&(n=!n),this.scale.z<0&&(n=!n),n?this._triangles[e]=u.getReversedTriangles(this._mesh,e):(this._triangles[e]||(this._triangles[e]=[]),this._mesh.copyIndices(e,this._triangles[e]));for(var a=this._vertices[e]=this._vertices[e]||[],h=this._mesh.readAttribute(e,i.AttributeName.ATTR_POSITION),p=this._mesh.readAttribute(e,i.AttributeName.ATTR_NORMAL),d=this._mesh.readAttribute(e,i.AttributeName.ATTR_TANGENT),f=d&&d.length>0,g=this._mesh.readAttribute(e,i.AttributeName.ATTR_TEX_COORD),m=g&&g.length>0,v=this._mesh.readAttribute(e,i.AttributeName.ATTR_TEX_COORD1),y=v&&v.length>0,b=this._mesh.readAttribute(e,i.AttributeName.ATTR_COLOR),C=b&&b.length>0,_=h.length/3,E=0;E<_;E++){var w=c.Position|c.Normal,S=a[E];S||(S=a[E]=l.pool.get()),S.position.set(h[3*E+0],h[3*E+1],h[3*E+2]),S.normal.set(p[3*E+0],p[3*E+1],p[3*E+2]),m&&(S.uv.set(g[2*E+0],g[2*E+1]),w|=c.UV),y&&(S.uv1.set(v[2*E+0],v[2*E+1]),w|=c.UV1),f&&(S.tangent.set(d[4*E+0],d[4*E+1],d[4*E+2],d[4*E+3]),w|=c.Tangent),C&&(S.color.set(b[4*E+0],b[4*E+1],b[4*E+2],b[4*E+3]),w|=c.Color),this.rotation.equals(o.IDENTITY)||(r.transformQuat(S.position,S.position,this.rotation),r.transformQuat(S.normal,S.normal,this.rotation),f&&s.transformQuat(S.tangent,S.tangent,this.rotation)),this.scale.equals(r.ONE)||r.multiply(S.position,S.position,this.scale),S.position.add(this.translation),S.flag=w}for(;E<a.length;E++)a[E]&&l.pool.put(a[E]);a.length=_,this._minX[e]=Number.MAX_SAFE_INTEGER;var P=-Number.MAX_SAFE_INTEGER;this._minY[e]=Number.MAX_SAFE_INTEGER;var M=-Number.MAX_SAFE_INTEGER;this._minZ[e]=Number.MAX_SAFE_INTEGER;for(var T=-Number.MAX_SAFE_INTEGER,k=0;k<a.length;k++){var N=a[k].position;P=Math.max(P,N.x),this._minX[e]=Math.min(this._minX[e],N.x),M=Math.max(M,N.y),this._minY[e]=Math.min(this._minY[e],N.y),T=Math.max(T,N.z),this._minZ[e]=Math.min(this._minZ[e],N.z)}this._lengthX[e]=Math.abs(P-this._minX[e]),this._lengthY[e]=Math.abs(M-this._minY[e]),this._lengthZ[e]=Math.abs(T-this._minZ[e])}},e(n,[{key:"mesh",get:function(){return this._mesh}},{key:"vertices",get:function(){return this._vertices[0]||this.buildData(),this._vertices[0]}},{key:"triangles",get:function(){return this._vertices[0]||this.buildData(),this._triangles[0]}},{key:"minZ",get:function(){return this._vertices[0]||this.buildData(),this._minZ[0]}},{key:"lengthZ",get:function(){return this._vertices[0]||this.buildData(),this._lengthZ[0]}},{key:"minX",get:function(){return this._vertices[0]||this.buildData(),this._minX[0]}},{key:"lengthX",get:function(){return this._vertices[0]||this.buildData(),this._lengthX[0]}},{key:"minY",get:function(){return this._vertices[0]||this.buildData(),this._minY[0]}},{key:"lengthY",get:function(){return this._vertices[0]||this.buildData(),this._lengthY[0]}}]),n}()),n._RF.pop()}}})),System.register("chunks:///_virtual/sower.ts",["./rollupPluginModLoBabelHelpers.js","cc","./spline-util-renderer.ts","./event.ts","./pool.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.Quat,c=t.Vec3,u=t.Prefab,h=t.instantiate},function(t){p=t.default},function(t){d=t.default},function(t){f=t.default}],execute:function(){var g,m,v,y,b,C,_,E,w,S,P,M;s._RF.push({},"3c449aeMnlEoqzv7EJdDtvX","sower",void 0);var T=a.ccclass,k=a.executeInEditMode,N=a.float,R=a.type,B=(a.boolean,a.property),F=new l;new c,t("default",(g=R(u),m=R(u),T(v=k((b=e((y=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"_spacing",b,o(e)),i(e,"_spacingRange",C,o(e)),i(e,"_scale",_,o(e)),i(e,"_scaleRange",E,o(e)),i(e,"_rotation",w,o(e)),i(e,"_prefab",S,o(e)),i(e,"_translation",P,o(e)),i(e,"_translationRange",M,o(e)),e.onComputedEvent=new d,e}return n(e,t),e.prototype.compute=function(){var t=this.generated.children;if(!(this.spacing+this.spacingRange<=0||null==this.prefab)){for(var e=0,n=this.splineCurve,i=0;e<=n.length;){var o=this.translation.x+Math.random()*this.translationRange.x*Math.sign(this.translation.x)+e;o=Math.min(o,n.length);var r=n.getSampleAtDistance(o),s=t[i];s||((s=h(this.prefab)).parent=this.generated);var a=this.scale+Math.random()*this.scaleRange;a*=Math.min(r.scale.x,r.scale.y),s.setScale(a,a,a),l.fromEuler(F,this.rotation.x,this.rotation.y,this.rotation.z),l.multiply(F,r.rotation,F),s.setRotation(F);var u=f.Vec3.get();u=c.transformQuat(u,c.RIGHT,l.fromViewUp(F,r.tangent,r.up)).normalize();var p=this.translation.z+Math.random()*this.translationRange.z*Math.sign(this.translation.z);p*=r.scale.x,u.multiplyScalar(p);var d=f.Vec3.get();d.set(r.transformedUp).normalize();var g=this.translation.y+Math.random()*this.translationRange.y*Math.sign(this.translation.y);g*=r.scale.y,d.multiplyScalar(g),s.position=u.add(d).add(r.location),e+=this.spacing+Math.random()*this.spacingRange,i++}if(t.length>i)for(var m=t.length-1;m>=i;m--)t[m].parent=null;this.onComputedEvent.invoke()}},r(e,[{key:"spacing",get:function(){return this._spacing},set:function(t){this._spacing=t,this.dirty=!0}},{key:"spacingRange",get:function(){return this._spacingRange},set:function(t){this._spacingRange=t,this.dirty=!0}},{key:"scale",get:function(){return this._scale},set:function(t){this._scale=t,this.dirty=!0}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.dirty=!0}},{key:"scaleRange",get:function(){return this._scaleRange},set:function(t){this._scaleRange=t,this.dirty=!0}},{key:"translation",get:function(){return this._translation},set:function(t){this._translation.set(t),this.dirty=!0}},{key:"translationRange",get:function(){return this._translationRange},set:function(t){this._translationRange.set(t),this.dirty=!0}},{key:"prefab",get:function(){return this._prefab},set:function(t){this._prefab=t,this.generated.removeAllChildren(),this.dirty=!0}}]),e}(p)).prototype,"_spacing",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),C=e(y.prototype,"_spacingRange",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_=e(y.prototype,"_scale",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),E=e(y.prototype,"_scaleRange",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),w=e(y.prototype,"_rotation",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c}}),S=e(y.prototype,"_prefab",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(y.prototype,"_translation",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c}}),M=e(y.prototype,"_translationRange",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c}}),e(y.prototype,"spacing",[N],Object.getOwnPropertyDescriptor(y.prototype,"spacing"),y.prototype),e(y.prototype,"spacingRange",[N],Object.getOwnPropertyDescriptor(y.prototype,"spacingRange"),y.prototype),e(y.prototype,"scale",[N],Object.getOwnPropertyDescriptor(y.prototype,"scale"),y.prototype),e(y.prototype,"rotation",[B],Object.getOwnPropertyDescriptor(y.prototype,"rotation"),y.prototype),e(y.prototype,"scaleRange",[N],Object.getOwnPropertyDescriptor(y.prototype,"scaleRange"),y.prototype),e(y.prototype,"translation",[B],Object.getOwnPropertyDescriptor(y.prototype,"translation"),y.prototype),e(y.prototype,"translationRange",[B],Object.getOwnPropertyDescriptor(y.prototype,"translationRange"),y.prototype),e(y.prototype,"prefab",[m],Object.getOwnPropertyDescriptor(y.prototype,"prefab"),y.prototype),v=y))||v)||v)),s._RF.pop()}}})),System.register("chunks:///_virtual/SpawnPosComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.inheritsLoose,n=t.applyDecoratedDescriptor,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator},function(t){a=t.ReadyPosType},function(t){l=t.ecs}],execute:function(){var c,u,h,p,d,f;r._RF.push({},"1f7b90enS5DiLhVbLKn7laf","SpawnPosComp",void 0);var g=s.ccclass,m=s.property;t("SpawnPosComp",(c=g("SpawnPosComp"),u=l.register("SpawnPosComp"),h=m({type:a,tooltip:"战备区位置类型"}),c(p=u((d=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"posType",f,o(e)),e.idlePos=null,e.occupy=!1,e.occupyNode=null,e}return e(n,t),n.prototype.reset=function(){this.occupy=!1,this.occupyNode=null},n}(l.Comp),f=n(d.prototype,"posType",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return a.solider}}),p=d))||p)||p)),r._RF.pop()}}})),System.register("chunks:///_virtual/SpawnPosEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./SpawnPosComp.ts","./PoolManager.ts","./Constant.ts","./EventManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node},function(t){l=t.ecs},function(t){c=t.CCComp},function(t){u=t.SpawnPosComp},function(t){h=t.default},function(t){p=t.GameEvent,d=t.ResEnum},function(t){f=t.EventManager}],execute:function(){var g,m,v,y,b,C;r._RF.push({},"2bf73Ve1vJDDotmIgf3pZtZ","SpawnPosEntity",void 0);var _=s.ccclass,E=s.property;t("SpawnPosEntity",(g=_("SpawnPosEntity"),m=l.register("SpawnPosEntity",!1),v=E(a),g(y=m((C=e((b=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"idlePos",C,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){},r.onEnable=function(){this.ent.add(u),this.ent.get(u).idlePos=this.idlePos,f.instance.on(p.PackageEvent,this.PackageEventFun,this)},r.onDisable=function(){f.instance.off(p.PackageEvent,this.PackageEventFun,this),this.ent.destroy(!0)},r.PackageEventFun=function(t,e){this.ent&&this.ent.get(u)&&this.ent.get(u).reset(),e&&h.instance.putItem(d.ReadyPos,this.node)},e}(c)).prototype,"idlePos",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=b))||y)||y)),r._RF.pop()}}})),System.register("chunks:///_virtual/SpawnSoldierSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalSingle.ts","./Constant.ts","./SpawnPosComp.ts","./HouseComp.ts","./ECS.ts","./PoolManager.ts","./RoleEntity.ts","./NavToComp.ts","./SoldierComp.ts","./EventManager.ts","./RoleComp.ts","./RoleAnimComp.ts","./HouseEntity.ts","./StorageData.ts","./GunFactoryComp.ts","./GunFactoryEntity.ts","./AudioManager.ts","./SpawnPosEntity.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M,T,k,N,R;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Vec3},function(t){s=t.GlobalSingle},function(t){a=t.GameState,l=t.ReadyPosType,c=t.HouseType,u=t.ResEnum,h=t.Sounds,p=t.RoleModel,d=t.GameEvent},function(t){f=t.SpawnPosComp},function(t){g=t.HouseComp},function(t){m=t.ecs},function(t){v=t.default},function(t){y=t.RoleEntity},function(t){b=t.NavToComp,C=t.DestPosType},function(t){_=t.SoldierComp},function(t){E=t.EventManager},function(t){w=t.RoleComp},function(t){S=t.RoleAnimComp},function(t){P=t.HouseEntity},function(t){M=t.StorageData},function(t){T=t.GunFactoryComp},function(t){k=t.GunFactoryEntity},function(t){N=t.default},function(t){R=t.SpawnPosEntity}],execute:function(){var B;i._RF.push({},"b23c0w2ELNA/rGzNMHa0MGd","SpawnSoldierSys",void 0);var F=o.ccclass;t("SpawnSoldierSys",F("SpawnSoldierSys")(B=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).spawnPosCompEntities=void 0,e.houseCompEntities=void 0,e.timeCount=0,e.worldPos=new r,e.hadRestoreSoldiers=!1,e}e(i,t);var o=i.prototype;return o.init=function(){this.registerEvent()},o.filter=function(){return m.anyOf(g,f)},o.entityEnter=function(t){this.refreshEntities()},o.entityRemove=function(t){this.refreshEntities()},o.refreshEntities=function(){this.spawnPosCompEntities=m.query(m.allOf(f)),this.houseCompEntities=m.query(m.allOf(g)),this.spawnPosCompEntities.sort((function(t,e){return t.get(R).node.getSiblingIndex()-e.get(R).node.getSiblingIndex()}))},o.firstUpdate=function(t){},o.update=function(t){this.timeCount++,this.timeCount>100&&(this.timeLoop(),this.timeCount=0)},o.timeLoop=function(){if(M.instance.status==a.ready&&this.spawnPosCompEntities&&this.houseCompEntities){for(var t,e=[],i=[],o=n(this.spawnPosCompEntities);!(t=o()).done;){var s=t.value,u=s.get(f);if(u.occupy){if(u.occupyNode&&u.occupyNode.getComponent(y).ent&&!u.occupyNode.getComponent(y).ent.has(b)&&r.distance(u.occupyNode.worldPosition,u.idlePos.worldPosition)>.1){var h=u.occupyNode.getComponent(y).ent.add(b);h.needNavNode=u.occupyNode,h.destPos={worldPos:u.idlePos.worldPosition,target:u.idlePos}}}else u.posType==l.solider&&e.push(s),u.posType==l.tanker&&i.push(s)}for(var p,d=new Date,m=n(this.houseCompEntities);!(p=m()).done;){var v=p.value.get(g),C=(d.getTime()-v.lastBorthTime)/1e3;if(v.houseLevel>0&&C>v.spawnDeltaTime){var _=0;if(v.houseType==c.tanker?_=16:(1==v.houseLevel&&(_=18),2==v.houseLevel&&(_=19)),v.houseType==c.soldier&&e.length>0){var E=e.shift();E.get(f).occupy=!0,this.spawnOneSolider(_,v.ent.get(P).borthPos.worldPosition,E)}if(v.houseType==c.tanker&&i.length>0){var w=i.shift();w.get(f).occupy=!0,this.spawnOneSolider(_,v.ent.get(P).borthPos.worldPosition,w)}v.lastBorthTime=d.getTime()}}}},o.spawnOneSolider=function(t,e,n){var i=n.get(f);v.instance.getItemSync(u.Role).then((function(n){N.instance.playSoundEffect(h.Enlist),i.occupyNode=n,n.name="Soldier"+(new Date).getSeconds();var o=n.getComponent(y);o.isPlayer=!1,s.instance.map.addChild(n),n.setWorldPosition(e),o.ent.add(_).init(),o.ent.add(S),o.roleId=t,o.setRoleData(),o.initRole(),o.ent.add(w).init();var r=o.ent.add(b);if(r.needNavNode=n,o.roleModel!=p.Tanker){var a=m.query(m.allOf(T));if(a.length>0){var l=a[0].get(k);l.gunPlace.children.length>0&&r.destPosArry.push({type:C.GunBox,worldPos:l.getGunPoint.getWorldPosition(),target:l.node})}}r.destPosArry.push({worldPos:i.idlePos.getWorldPosition(),target:i.idlePos}),r.destPos=r.destPosArry.shift()}))},o.registerEvent=function(){E.instance.on(d.StatusEvent,this.statusChangeFun,this),E.instance.on(d.RestoreSoldiers,this.restoreSoldiers,this)},o.statusChangeFun=function(t){if(M.instance.status==a.battle)for(var e,i=n(this.spawnPosCompEntities);!(e=i()).done;){var o=e.value.get(f);o.occupy=!1,o.occupyNode=null}},o.restoreSoldiers=function(){if(this.spawnPosCompEntities.length>=M.instance.soldiers.length&&!this.hadRestoreSoldiers){this.hadRestoreSoldiers=!0;for(var t,e=[],i=[],o=n(this.spawnPosCompEntities);!(t=o()).done;){var s=t.value,a=s.get(f);if(a.occupy){if(!a.occupyNode.getComponent(y).ent.has(b)&&r.distance(a.occupyNode.worldPosition,a.idlePos.worldPosition)>.1){var c=a.occupyNode.getComponent(y).ent.add(b);c.needNavNode=a.occupyNode,c.destPos={worldPos:a.idlePos.worldPosition,target:a.idlePos}}}else a.posType==l.solider&&e.push(s),a.posType==l.tanker&&i.push(s)}for(var u=0;u<M.instance.soldiers.length;u++)if(16==M.instance.soldiers[u].roleId){if(i.length>0){var h=i.shift(),p=h.get(f);h.get(f).occupy=!0,this.spawnOneSolider(M.instance.soldiers[u].roleId,p.idlePos.worldPosition,h)}}else if(e.length>0){var d=e.shift(),g=d.get(f);d.get(f).occupy=!0,this.spawnOneSolider(M.instance.soldiers[u].roleId,g.idlePos.worldPosition,d)}M.instance.soldiers=[]}},i}(m.ComblockSystem))||B),i._RF.pop()}}})),System.register("chunks:///_virtual/SpinComp.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Quat,r=t.Component}],execute:function(){var s;n._RF.push({},"5ba4d7+VtZJYp3M86oykRnw","SpinComp",void 0);var a=i.ccclass;i.property,t("SpinComp",a("SpinComp")(s=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this)._aQuat=new o,e}e(n,t);var i=n.prototype;return i.start=function(){},i.update=function(t){o.rotateZ(this._aQuat,this.node.getRotation(),.2),this.node.setRotation(this._aQuat)},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/spline-curve-interface.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"f52bdvdp09JvYK1DHZuLYtH","spline-curve-interface",void 0),t._RF.pop()}}})),System.register("chunks:///_virtual/spline-gizmo.ts",["cc","./gizmo.ts","./utils.ts","./spline-node-controller.ts","./continuous-line-controller.ts","./pool.ts","./spline-node.ts","./spline.ts","./types.ts","./index.ts"],(function(){var t;return{setters:[function(e){t=e.cclegacy},null,null,null,null,null,null,null,null,null],execute:function(){t._RF.push({},"646b1jdVAhEjYOaHNzLi1SR","spline-gizmo",void 0),t._RF.pop()}}})),System.register("chunks:///_virtual/spline-grid-util.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Component,l=t.Vec3}],execute:function(){var c,u,h,p;r._RF.push({},"6d6a74dRY9Ax653BXWidhUA","spline-grid-util",void 0);var d=s.ccclass,f=s.property;t("SplineGridUtil",d("SplineGridUtil")((h=e((u=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"splineNodeGrid",h,o(e)),i(e,"splineDirectionGrid",p,o(e)),e}return n(e,t),e.prototype.start=function(){},e}(a)).prototype,"splineNodeGrid",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(1,1,1)}}),p=e(u.prototype,"splineDirectionGrid",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(1,1,1)}}),c=u))||c),r._RF.pop()}}})),System.register("chunks:///_virtual/spline-node-controller.ts",["./rollupPluginModLoBabelHelpers.js","cc","./controller.ts","./utils.ts","./types.ts","./index.ts","./npm.ts"],(function(t){var e,n,i,o,r,s,a,l,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t.Color,o=t.Vec3},function(t){r=t.default},function(t){s=t.createLineShape,a=t.getNodeWorldPostion},function(t){l=t.SplineMoveType},null,function(t){c=t.cce}],execute:function(){n._RF.push({},"055a8DTQf1L86joS8tyMPw+","spline-node-controller",void 0);var u=10;t("default",function(t){function n(e){var n;return(n=t.call(this,e)||this)._node=null,n._splineNode=null,n._directionLineShape=null,n.positionNode=null,n.directionNode=null,n.invDirectionNode=null,n.initShape(),n}e(n,t);var r=n.prototype;return r.initShape=function(){this.createShapeNode("BoxController");var t=c.gizmos.ControllerUtils.cube(u,u,u,i.YELLOW);t.parent=this.shape,this.positionNode=t,this.initHandle(t,l.Position),(t=c.gizmos.ControllerUtils.cube(u,u,u,i.YELLOW)).parent=this.shape,this.directionNode=t,this.initHandle(t,l.Direction),(t=c.gizmos.ControllerUtils.cube(u,u,u,i.YELLOW)).parent=this.shape,this.invDirectionNode=t,this.initHandle(t,l.InvDirection),this._directionLineShape=s("Direction Line",i.RED),this._directionLineShape.parent=this.shape,this.hide()},r.onShow=function(){this.registerCameraMovedEvent(),this.hideDirection()},r.onHide=function(){this.unregisterCameraMoveEvent()},r.showDirection=function(){this.directionNode.active=!0,this.invDirectionNode.active=!0,this._directionLineShape.active=!0,this.updateLineMesh()},r.hideDirection=function(){this.directionNode.active=!1,this.invDirectionNode.active=!1,this._directionLineShape.active=!1},r.setSplineNode=function(t,e){this._splineNode=e,this._node=t,this.adjustControllerSize(),this.shape.setWorldPosition(a(t,this._splineNode.position)),this.directionNode.setWorldPosition(a(t,this._splineNode.direction)),this.invDirectionNode.setWorldPosition(a(t,this._splineNode.invDirection)),this.updateLineMesh(),this.updateController()},r.updateLineMesh=function(){this._directionLineShape.updatePoints([this.directionNode.position,this.invDirectionNode.position])},r.getSplineNodeWorldPosition=function(){return this.positionNode.getWorldPosition(new o)},r.getSplineNodeWorldDirection=function(){return this.directionNode.getWorldPosition(new o)},r.getSplineNodeWorldInvDirection=function(){return this.invDirectionNode.getWorldPosition(new o)},n}(r)),n._RF.pop()}}})),System.register("chunks:///_virtual/spline-node-wrapper.ts",["./rollupPluginModLoBabelHelpers.js","cc","./spline-node.ts"],(function(t){var e,n,i,o,r,s,a;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator,r=t.Vec3,s=t.Vec2},function(t){a=t.default}],execute:function(){var l,c,u,h,p,d,f;i._RF.push({},"04ae8GydjtEIptiC5odtVpt","spline-node-wrapper",void 0);var g=o.ccclass,m=o.property,v=o.type;t("default",(l=g("SplineNodeWrapper"),c=v(a),u=v(r),h=v(r),p=v(s),l((e((f=function(){function t(){this.node=null}return t.create=function(e){var n=new t;return n.node=e,n},n(t,[{key:"splineNode",get:function(){return this.node}},{key:"position",get:function(){return this.node?this.node.position:r.ZERO},set:function(t){this.node&&(this.node.position=t)}},{key:"direction",get:function(){return this.node?this.node.direction:r.ZERO},set:function(t){this.node&&(this.node.direction=t)}},{key:"scale",get:function(){return this.node?this.node.scale:s.ONE},set:function(t){this.node&&(this.node.scale=t)}},{key:"roll",get:function(){return this.node?this.node.roll:0},set:function(t){this.node&&(this.node.roll=t)}}]),t}()).prototype,"splineNode",[c],Object.getOwnPropertyDescriptor(f.prototype,"splineNode"),f.prototype),e(f.prototype,"position",[u],Object.getOwnPropertyDescriptor(f.prototype,"position"),f.prototype),e(f.prototype,"direction",[h],Object.getOwnPropertyDescriptor(f.prototype,"direction"),f.prototype),e(f.prototype,"scale",[p],Object.getOwnPropertyDescriptor(f.prototype,"scale"),f.prototype),e(f.prototype,"roll",[m],Object.getOwnPropertyDescriptor(f.prototype,"roll"),f.prototype),d=f))||d)),i._RF.pop()}}})),System.register("chunks:///_virtual/spline-node.ts",["./rollupPluginModLoBabelHelpers.js","cc","./event.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.Component,c=t.Vec3,u=t.Vec2},function(t){h=t.default}],execute:function(){var p,d,f,g,m,v,y;s._RF.push({},"ea25fgiLE9K94BRKQOBQ6rg","spline-node",void 0);var b=a.ccclass,C=a.property;t("default",b("SplineNode")((f=e((d=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))||this).changed=new h,i(e,"_position",f,o(e)),i(e,"_direction",g,o(e)),i(e,"_up",m,o(e)),i(e,"_scale",v,o(e)),i(e,"_roll",y,o(e)),e}return n(e,t),r(e,[{key:"position",get:function(){return this._position},set:function(t){this._position.equals(t)||(this._position.set(t),this.changed.invoke(this))}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction.equals(t)||(this._direction.set(t),this.changed.invoke(this))}},{key:"invDirection",get:function(){return this.position.clone().multiplyScalar(2).subtract(this.direction)},set:function(t){this.direction=this.position.clone().multiplyScalar(2).subtract(t)}},{key:"up",get:function(){return this._up},set:function(t){this._up.equals(t)||(this._up.set(t),this.changed.invoke(this))}},{key:"scale",get:function(){return this._scale},set:function(t){this._scale.equals(t)||(this._scale.set(t),this.changed.invoke(this))}},{key:"roll",get:function(){return this._roll},set:function(t){this._roll!==t&&(this._roll=t,this.changed.invoke(this))}}]),e}(l)).prototype,"_position",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c}}),e(d.prototype,"position",[C],Object.getOwnPropertyDescriptor(d.prototype,"position"),d.prototype),g=e(d.prototype,"_direction",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c}}),e(d.prototype,"direction",[C],Object.getOwnPropertyDescriptor(d.prototype,"direction"),d.prototype),m=e(d.prototype,"_up",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return c.UP.clone()}}),e(d.prototype,"up",[C],Object.getOwnPropertyDescriptor(d.prototype,"up"),d.prototype),v=e(d.prototype,"_scale",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return u.ONE.clone()}}),e(d.prototype,"scale",[C],Object.getOwnPropertyDescriptor(d.prototype,"scale"),d.prototype),y=e(d.prototype,"_roll",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(d.prototype,"roll",[C],Object.getOwnPropertyDescriptor(d.prototype,"roll"),d.prototype),p=d))||p),s._RF.pop()}}})),System.register("chunks:///_virtual/spline-smoother.ts",["./rollupPluginModLoBabelHelpers.js","cc","./spline.ts","./pool.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.Vec3,c=t.Component},function(t){u=t.default},function(t){h=t.default}],execute:function(){var p,d,f,g,m;s._RF.push({},"f4722OckFpGqb0dQB+UAi/S","spline-smoother",void 0);var v=a.ccclass,y=a.property,b=a.executeInEditMode;t("splineSmoother",(p=v("splineSmoother"),d=y({step:.1}),p(f=b((m=e((g=function(t){function e(){var e;return(e=t.call(this)||this)._smoothing=!1,e._spline=null,i(e,"_curvature",m,o(e)),e.splineNodeListChanged=e.splineNodeListChanged.bind(o(e)),e.onNodeChanged=e.onNodeChanged.bind(o(e)),e}n(e,t);var s=e.prototype;return s.onEnable=function(){this.smoothAll(),this.spline.nodeListChanged.addListener(this.splineNodeListChanged);for(var t=0;t<this.spline.nodes.length;t++)this.spline.nodes[t].changed.addListener(this.onNodeChanged)},s.onDisable=function(){this.spline.nodeListChanged.removeListener(this.splineNodeListChanged);for(var t=0;t<this.spline.nodes.length;t++)this.spline.nodes[t].changed.removeListener(this.onNodeChanged)},s.splineNodeListChanged=function(t){if(null!=t.newItems)for(var e=0;e<t.newItems.length;e++)t.newItems[e].changed.addListener(this.onNodeChanged);if(null!=t.removedItems)for(var n=0;n<t.removedItems.length;n++)t.removedItems[n].changed.removeListener(this.onNodeChanged)},s.onNodeChanged=function(t){this.smoothNode(t);var e=this.spline.nodes,n=e.indexOf(t);n>0&&this.smoothNode(e[n-1]),n<e.length-1&&this.smoothNode(e[n+1])},s.smoothNode=function(t){if(!this._smoothing){this._smoothing=!0;var e=this.spline.nodes,n=e.indexOf(t),i=t.position,o=h.Vec3.get().set(l.ZERO),r=h.Vec3.get(),s=0;if(0!==n){var a=e[n-1].position,c=r.set(i).subtract(a);s+=c.length(),o.add(c.normalize())}if(n!=e.length-1){var u=e[n+1].position,p=r.set(i).subtract(u);s+=p.length(),o.subtract(p.normalize())}s*=.5;var d=(o=o.normalize().multiplyScalar(s*this.curvature)).add(i);t.direction=d,h.Vec3.put(o),h.Vec3.put(r),this._smoothing=!1}},s.smoothAll=function(){for(var t=this.spline.nodes,e=0;e<t.length;e++)this.smoothNode(t[e])},r(e,[{key:"spline",get:function(){return this._spline||(this._spline=this.getComponentInChildren(u)),this._spline}},{key:"curvature",get:function(){return this._curvature},set:function(t){this._curvature=t,this.smoothAll()}}]),e}(c)).prototype,"_curvature",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),e(g.prototype,"curvature",[d],Object.getOwnPropertyDescriptor(g.prototype,"curvature"),g.prototype),f=g))||f)||f)),s._RF.pop()}}})),System.register("chunks:///_virtual/spline-util-base.ts",["./rollupPluginModLoBabelHelpers.js","cc","./spline.ts","./spline-node.ts"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.createClass},function(t){o=t.cclegacy,r=t._decorator,s=t.Component},function(t){a=t.default},function(t){l=t.default}],execute:function(){var c,u,h;o._RF.push({},"6eeeaOuhfFI3o1us6WtGstr","spline-util-base",void 0);var p=r.ccclass,d=r.executeInEditMode,f=r.type;t("default",(c=f(a),p(u=d((e((h=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._spline=null,e._splineNode=null,e._splineCurve=null,e}return n(e,t),i(e,[{key:"spline",get:function(){if(!this._spline)for(var t=this.node;t&&(this._spline=t.getComponent(a),!this._spline);)t=t.parent;return this._spline}},{key:"splineNode",get:function(){if(!this._splineNode)for(var t=this.node;t&&(this._splineNode=t.getComponent(l),!this._splineNode);)t=t.parent;return this._splineNode}},{key:"splineCurve",get:function(){if(!this._splineCurve){var t=this.splineNode;if(t){var e=t.node.getSiblingIndex();this._splineCurve=this.spline.getCurve(e)}else this._splineCurve=this.spline}return this._splineCurve}}]),e}(s)).prototype,"spline",[c],Object.getOwnPropertyDescriptor(h.prototype,"spline"),h.prototype),u=h))||u)||u)),o._RF.pop()}}})),System.register("chunks:///_virtual/spline-util-renderer.ts",["./rollupPluginModLoBabelHelpers.js","cc","./spline-util-base.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.Mat4,c=t.js,u=t.find,h=t.Node,p=t.CCObject},function(t){d=t.default}],execute:function(){var f,g,m;s._RF.push({},"c7ffansbHtO8oeW7zNMMVAH","spline-util-renderer",void 0);var v=a.ccclass,y=a.property;t("default",v("SplineUtilRenderer")((m=e((g=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"_showGenerated",m,o(e)),e._generated=null,e._dirty=!0,e._dirtyTime=0,e.dirtyWhenSplineMoved=!1,e.splineMatrix=null,e}n(e,t);var s=e.prototype;return s._onDirtyChanged=function(t){t&&!this._dirty&&(this._dirtyTime=0),this._dirty=t},s.onLoad=function(){this.onCurveChanged()},s.onEnable=function(){this.spline&&(this.onCurveChanged&&this.spline.curveChanged.addListener(this.onCurveChanged,this),this.onNodeListChanged&&this.spline.nodeListChanged.addListener(this.onNodeListChanged,this)),this.generated&&(this.generated.active=!0)},s.onDisable=function(){this.spline&&(this.onCurveChanged&&this.spline.curveChanged.removeListener(this.onCurveChanged,this),this.onNodeListChanged&&this.spline.curveChanged.removeListener(this.onNodeListChanged,this)),this.generated&&(this.generated.active=!1)},s.onCurveChanged=function(){this.dirty=!0},s.checkSplineMoved=function(){if(this.dirtyWhenSplineMoved){var t=this.spline.node.worldMatrix;this.splineMatrix?this.splineMatrix.equals(t)||(this.dirty=!0):this.splineMatrix=new l,this.splineMatrix.set(t)}},s.reset=function(){this._generated&&(this._generated.parent=null,this._generated=null),this.onCurveChanged()},s.update=function(t){this.checkSplineMoved(),this.dirty&&this.spline&&(this._dirtyTime+=t,this._dirtyTime>=0&&(this.compute(),this.dirty=!1),CC_EDITOR&&cce.Engine.repaintInEditMode())},s.compute=function(){},r(e,[{key:"showGenerated",get:function(){return this._showGenerated},set:function(t){this._showGenerated=t,this.reset()}},{key:"generated",get:function(){if(!this._generated||this._generated.parent!==this.node){this._generated&&(this._generated.parent=null);var t="generated "+c.getClassName(this);this._generated=u(t,this.node),this._generated||(this._generated=new h(t),this._showGenerated||(this._generated._objFlags|=p.Flags.DontSave|p.Flags.HideInHierarchy),this._generated.parent=this.node)}return this._generated}},{key:"dirty",get:function(){return this._dirty},set:function(t){this._onDirtyChanged(t)}}]),e}(d)).prototype,"_showGenerated",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(g.prototype,"showGenerated",[y],Object.getOwnPropertyDescriptor(g.prototype,"showGenerated"),g.prototype),f=g))||f),s._RF.pop()}}})),System.register("chunks:///_virtual/spline.ts",["./rollupPluginModLoBabelHelpers.js","cc","./spline-node.ts","./cubic-bezier-curve.ts","./event.ts","./spline-node-wrapper.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.Vec3,c=t.Node,u=t.find,h=t.warn,p=t.Component},function(t){d=t.default},function(t){f=t.default},function(t){g=t.default},function(t){m=t.default}],execute:function(){var v,y,b,C,_;s._RF.push({},"4f3betNZrFAk5ghozl0TFWc","spline",void 0);var E=a.ccclass,w=a.type,S=a.boolean,P=(a.integer,a.float,a.executeInEditMode),M="__spline_node_root__";t("default",(v=w([d]),y=w(m),E(b=P((e((C=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))||this).currentSelection=null,e._addSplineNodeAtLast=!1,e._addSplineNodeAfterSelection=!1,e._deleteSelectSplineNode=!1,i(e,"_nodes",_,o(e)),e.curves=[],e.length=0,e._isLoop=!1,e._gizmoEditing=!1,e.nodeListChanged=new g,e.curveChanged=new g,e._nodeRoot=null,e._updatingNodes=!1,e.startNode=null,e.endNode=null,e._samples=[],e._points=[],e._minPos=new l,e._maxPos=new l,e}n(e,t);var s=e.prototype;return s.invokeNodeListChanged=function(){this.nodeListChanged.invoke()},s.invokeCurveChanged=function(){this.curveChanged.invoke()},s.onLoad=function(){this._updateNodes()},s.onEnable=function(){},s.onDisable=function(){},s.addNode=function(t,e,n,i,o){var r=new c("SplineNode"),s=r.addComponent(d);return s.position=t,s.direction=e,void 0!==n&&(s.up=n),void 0!==i&&(s.scale=i),void 0!==o&&(s.roll=o),r.parent=this._nodeRoot,this._nodes.push(s),this._updatingNodes||(this.invokeNodeListChanged(),this._createCurves()),s},s.insertNode=function(t,e,n){var i=new c("SplineNode"),o=i.addComponent(d);return o.position=t,o.direction=e,this._nodeRoot.insertChild(i,n),this._nodes.splice(n,0,o),this._updatingNodes||(this.invokeNodeListChanged(),this._createCurves()),o},s.removeNode=function(t){var e=this._nodes[t];return this._nodeRoot.removeChild(e.node),this._nodes.splice(t,1),this._updatingNodes||(this.invokeNodeListChanged(),this._createCurves()),e},s._updateNodes=function(t){void 0===t&&(t=!0),this._updatingNodes=!0;var e=this._nodeRoot=u(M,this.node);if(e)this._nodes=e.getComponentsInChildren(d);else{if(e=this._nodeRoot=new c(M),this._nodes.length){var n=this._nodes.slice();this._nodes.length=0;for(var i=0;i<n.length;i++){var o=n[i];this.addNode(o.position,o.direction,o.up,o.scale,o.roll)}}else t&&(this.addNode(new l(-5,0,0),new l(-5,0,-3)),this.addNode(new l(5,0,0),new l(5,0,3)));e.parent=this.node}this._createCurves(),this.invokeNodeListChanged(),this._updatingNodes=!1},s._createCurves=function(){this.curves.length=0;for(var t=0;t<this.nodes.length-1;t++){var e=this.nodes[t],n=this.nodes[t+1],i=new f(e,n);i.changed.addListener(this.updateAfterCurveChanged,this),this.curves.push(i)}this.invokeNodeListChanged(),this.updateAfterCurveChanged()},s.getCurves=function(){return this.curves},s.updateAfterCurveChanged=function(){this.length=0;for(var t=0;t<this.curves.length;t++){var e=this.curves[t];this.length+=e.length}this.invokeCurveChanged(),this._points.length=0,this._samples.length=0},s.getSample=function(t,e){var n=this.getNodeIndexForTime(t);return this.curves[n].getSample(t-n,e)},s.getCurve=function(t){return this.curves[this.getNodeIndexForTime(t)]},s.getNodeIndexForTime=function(t){if(t<0||t>this.nodes.length-1)throw new Error("Time must be between 0 and last node index ("+(this.nodes.length-1)+"). Given time was {"+t+"}.");var e=Math.floor(t);return e==this.nodes.length-1&&e--,e},s.getSampleAtDistance=function(t,e){if(t<0||t>this.length)throw new Error("Distance must be between 0 and spline length ("+this.length+"). Given distance was "+t+".");for(var n=0;n<this.curves.length;n++){var i=this.curves[n];if(t>i.length&&t<i.length+1e-4&&(t=i.length),!(t>i.length))return i.getSampleAtDistance(t,e);t-=i.length}throw new Error("Something went wrong with GetSampleAtDistance.")},s.updateLoopBinding=function(){this.startNode&&this.startNode.changed.removeListener(this.startNodeChanged),null!=this.endNode&&this.endNode.changed.removeListener(this.endNodeChanged),this.isLoop?(this.startNode=this.nodes[0],this.endNode=this.nodes[this.nodes.length-1],this.startNode.changed.addListener(this.startNodeChanged),this.endNode.changed.addListener(this.endNodeChanged),this.startNodeChanged()):(this.startNode=null,this.endNode=null)},s.startNodeChanged=function(){var t=this.startNode,e=this.endNode;t&&e&&(e.changed.removeListener(this.endNodeChanged),e.position=t.position,e.direction=t.direction,e.roll=t.roll,e.scale=t.scale,e.up=t.up,e.changed.addListener(this.endNodeChanged))},s.endNodeChanged=function(){var t=this.startNode,e=this.endNode;t&&e&&(t.changed.removeListener(this.startNodeChanged),t.position=e.position,t.direction=e.direction,t.roll=e.roll,t.scale=e.scale,t.up=e.up,t.changed.addListener(this.startNodeChanged))},s.getSamples=function(){if(0===this._samples.length)for(var t=this._samples,e=this.curves,n=0;n<e.length;n++)for(var i=e[n].getSamples(),o=0;o<i.length;o++)t.push(i[o]);return this._samples},s.getPoints=function(){return 0===this._points.length&&this._caclBoundingBox(),this._points},s.getBounding=function(t,e){0===this._points.length&&this._caclBoundingBox(),t.set(this._minPos),e.set(this._maxPos)},s._caclBoundingBox=function(){for(var t=this._points,e=this._minPos.set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),n=this._maxPos.set(-Number.MAX_SAFE_INTEGER,-Number.MAX_SAFE_INTEGER,-Number.MAX_SAFE_INTEGER),i=this.getSamples(),o=0;o<i.length;o++){var r=t[o]=i[o].location;e.x=Math.min(e.x,r.x),e.y=Math.min(e.y,r.y),e.z=Math.min(e.z,r.z),n.x=Math.max(n.x,r.x),n.y=Math.max(n.y,r.y),n.z=Math.max(n.z,r.z)}t.length=i.length},r(e,[{key:"addSplineNodeAtLast",get:function(){return this._addSplineNodeAtLast},set:function(t){if(this._addSplineNodeAtLast!==t){this._addSplineNodeAtLast=t;var e=this.nodes.length-1,n=this.nodes[e],i=this.getSample(e).tangent.clone().multiplyScalar(this.length/this.nodes.length/2);this.addNode(i.add(n.position),n.direction)}}},{key:"addSplineNodeAfterSelection",get:function(){return this._addSplineNodeAfterSelection},set:function(t){if(this._addSplineNodeAfterSelection!==t)if(this._addSplineNodeAfterSelection=t,this.currentSelection){var e=this.nodes.indexOf(this.currentSelection);if(-1!==e){var n=this.getSample(e).tangent.clone().multiplyScalar(this.length/this.nodes.length/2);this.insertNode(n.add(this.currentSelection.position),this.currentSelection.direction,e+1)}}else h("No SpineNode selected.")}},{key:"deleteSelectSplineNode",get:function(){return this._deleteSelectSplineNode},set:function(t){if(this._deleteSelectSplineNode!==t)if(this._deleteSelectSplineNode=t,this.currentSelection){var e=this.nodes.indexOf(this.currentSelection);-1!==e&&this.removeNode(e)}else h("No SpineNode selected.")}},{key:"nodes",get:function(){return this._nodes}},{key:"splineNodes",get:function(){return this._nodes.map((function(t){return m.create(t)}))},set:function(t){}},{key:"isLoop",get:function(){return this._isLoop},set:function(t){this._isLoop=t,this.updateLoopBinding()}},{key:"gizmoEditing",get:function(){return this._gizmoEditing},set:function(t){this._gizmoEditing=t;for(var e=0;e<this.curves.length;e++)this.curves[e].gizmoEditing=t}}]),e}(p)).prototype,"addSplineNodeAtLast",[S],Object.getOwnPropertyDescriptor(C.prototype,"addSplineNodeAtLast"),C.prototype),e(C.prototype,"addSplineNodeAfterSelection",[S],Object.getOwnPropertyDescriptor(C.prototype,"addSplineNodeAfterSelection"),C.prototype),e(C.prototype,"deleteSelectSplineNode",[S],Object.getOwnPropertyDescriptor(C.prototype,"deleteSelectSplineNode"),C.prototype),_=e(C.prototype,"_nodes",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),e(C.prototype,"splineNodes",[y],Object.getOwnPropertyDescriptor(C.prototype,"splineNodes"),C.prototype),e(C.prototype,"isLoop",[S],Object.getOwnPropertyDescriptor(C.prototype,"isLoop"),C.prototype),b=C))||b)||b)),s._RF.pop()}}})),System.register("chunks:///_virtual/StartBattleAnim.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Animation,r=t.Component}],execute:function(){var s;n._RF.push({},"6c21fRUzOFLCo9Zc2lF5pwF","StartBattleAnim",void 0);var a=i.ccclass;i.property,t("StartBattleAnim",a("StartBattleAnim")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){this.node.getComponent(o).play()},i.update=function(t){},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/StorageBoxCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.BaseCtrl}],execute:function(){var s;n._RF.push({},"40da8riQXlIfp3YAjF1iehv","StorageBoxCtrl",void 0);var a=i.ccclass;i.property,t("StorageBoxCtrl",a("StorageBoxCtrl")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.StorageBox,this.init("StorageBox")},i.onDisable=function(){t.prototype.onDisable.call(this)},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/StorageData.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./Constant.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.EventManager},function(t){r=t.GameState,s=t.GameEvent}],execute:function(){var a,l;n._RF.push({},"a8e31sF0mhJV6on8paI9Ly1","StorageData",void 0);var c=i.ccclass;i.property,t("StorageData",c("StorageData")(((l=function(){function t(){this._status=void 0,this._level=void 0,this._teamLevel=void 0,this._storageBadgeNum=void 0,this._grayNum=void 0,this._yellowNum=void 0,this._yellowNumTeam=void 0,this._badgeStackUsed=void 0,this._house=void 0,this._builds=void 0,this._enemys=void 0,this._soldiers=void 0,this._groundBadges=void 0,this._motoVideoCount=void 0}return e(t,[{key:"status",get:function(){if(!this._status){var t=localStorage.getItem("status");this._status=t?Number(t):r.ready}return this._status},set:function(t){this.status!=t&&(this._status=t,o.instance.emit(s.StatusEvent,this._status)),this._status=t}},{key:"level",get:function(){if(!this._level){var t=localStorage.getItem("level");this._level=t?Number(t):1}return this._level},set:function(t){this.level!=t&&(this._level=t,localStorage.setItem("level",t.toString()),o.instance.emit(s.LevelEvent,this._level)),this._level=t}},{key:"teamLevel",get:function(){if(!this._teamLevel){var t=localStorage.getItem("teamLevel");this._teamLevel=t?Number(t):1}return this._teamLevel},set:function(t){this.teamLevel!=t&&(this._teamLevel=t,localStorage.setItem("teamLevel",t.toString()),o.instance.emit(s.TeamLevelEvent,this._teamLevel)),this._teamLevel=t}},{key:"storageBadgeNum",get:function(){if(!this._storageBadgeNum){var t=localStorage.getItem("storageBadgeNum");this._storageBadgeNum=t?Number(t):0}return this._storageBadgeNum},set:function(t){this.storageBadgeNum!=t&&(this._storageBadgeNum=t,localStorage.setItem("storageBadgeNum",t.toString())),this._storageBadgeNum=t}},{key:"grayNum",get:function(){if(!this._grayNum){var t=localStorage.getItem("grayNum");this._grayNum=t?Number(t):0}return this._grayNum},set:function(t){this.grayNum!=t&&(this._grayNum=t,localStorage.setItem("grayNum",t.toString()),o.instance.emit(s.GrayNumEvent,this._grayNum)),this._grayNum=t}},{key:"yellowNum",get:function(){if(!this._yellowNum){var t=localStorage.getItem("yellowNum");this._yellowNum=t?Number(t):0}return this._yellowNum},set:function(t){this.yellowNum!=t&&(this._yellowNum=t,localStorage.setItem("yellowNum",t.toString()),o.instance.emit(s.YellowNumEvent,this._yellowNum)),this._yellowNum=t}},{key:"yellowNumTeam",get:function(){if(!this._yellowNumTeam){var t=localStorage.getItem("yellowNumTeam");this._yellowNumTeam=t?Number(t):0}return this._yellowNumTeam},set:function(t){this.yellowNumTeam!=t&&(this._yellowNumTeam=t,localStorage.setItem("yellowNumTeam",t.toString()),o.instance.emit(s.YellowNumTeamEvent,this._yellowNumTeam)),this._yellowNumTeam=t}},{key:"badgeStackUsed",get:function(){if(!this._badgeStackUsed){var t=localStorage.getItem("badgeStackUsed");this._badgeStackUsed=t?Number(t):0}return this._badgeStackUsed},set:function(t){this.badgeStackUsed!=t&&(this._badgeStackUsed=t,localStorage.setItem("badgeStackUsed",t.toString())),this._badgeStackUsed=t}},{key:"house",get:function(){if(!this._house){var t=localStorage.getItem("house");this._house=t?JSON.parse(t):{House1:0,House2:0,House3:0,House4:0,Tanker:0,House1_currentBadge:null,House2_currentBadge:null,House3_currentBadge:null,House4_currentBadge:null,Tanker_currentBadge:null}}return this._house},set:function(t){this._house=t,localStorage.setItem("house",JSON.stringify(t))}},{key:"builds",get:function(){if(!this._builds){var t=localStorage.getItem("builds");this._builds=t?JSON.parse(t):{}}return this._builds},set:function(t){this._builds=t,localStorage.setItem("builds",JSON.stringify(t))}},{key:"enemys",get:function(){if(!this._enemys){var t=localStorage.getItem("enemys");this._enemys=t?JSON.parse(t):{}}return this._enemys},set:function(t){this._enemys=t,localStorage.setItem("enemys",JSON.stringify(t))}},{key:"soldiers",get:function(){if(!this._soldiers){var t=localStorage.getItem("soldiers");this._soldiers=t?JSON.parse(t):[]}return this._soldiers},set:function(t){this._soldiers=t,localStorage.setItem("soldiers",JSON.stringify(t))}},{key:"groundBadges",get:function(){if(!this._groundBadges){var t=localStorage.getItem("groundBadges");this._groundBadges=t?JSON.parse(t):{}}return this._groundBadges},set:function(t){this._groundBadges=t,localStorage.setItem("groundBadges",JSON.stringify(t))}},{key:"motoVideoCount",get:function(){if(!this._motoVideoCount){var t=localStorage.getItem("motoVideoCount");this._motoVideoCount=t?Number(t):0}return this._motoVideoCount},set:function(t){this.motoVideoCount!=t&&(this._motoVideoCount=t,localStorage.setItem("motoVideoCount",t.toString())),this._motoVideoCount=t}}],[{key:"instance",get:function(){return null===t._instance&&(t._instance=new t),t._instance},set:function(e){t._instance=e}}]),t}())._instance=null,a=l))||a),n._RF.pop()}}})),System.register("chunks:///_virtual/StorageEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./UpgradeComp.ts","./Constant.ts","./RoleEntity.ts","./BagComp.ts","./GlobalSingle.ts","./StorageData.ts","./PoolManager.ts","./BadgeEntity.ts","./EventManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Label,l=t.Node,c=t.BoxCollider,u=t.ERigidBodyType,h=t.v3},function(t){p=t.ecs},function(t){d=t.CCComp},function(t){f=t.UpgradeComp},function(t){g=t.ResEnum,m=t.GameEvent,v=t.BadgeType},function(t){y=t.RoleEntity},function(t){b=t.BagComp},function(t){C=t.GlobalSingle},function(t){_=t.StorageData},function(t){E=t.default},function(t){w=t.BadgeEntity},function(t){S=t.EventManager}],execute:function(){var P,M,T,k,N,R,B,F,L,A,D,x,I,U;r._RF.push({},"279f54UnttMkr3v4ZsvnQpM","StorageEntity",void 0);var z=s.ccclass,G=s.property;t("StorageEntity",(P=z("StorageEntity"),M=p.register("StorageEntity",!1),T=G(a),k=G(l),N=G(l),R=G(l),B=G(l),P(F=M((A=e((L=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"labelNum",A,o(e)),i(e,"labelNumQuad",D,o(e)),i(e,"unloadPos",x,o(e)),i(e,"leftColliderNode",I,o(e)),i(e,"bottomColliderNode",U,o(e)),e.canUnload=!1,e.leftCollider=null,e.bottomCollider=null,e.buildingData=void 0,e.StorageBadgeNum=0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){E.instance.putItem(g.StorageBox,this.node,!0)},r.onEnable=function(){var t=this;this.ent.add(f),this.leftCollider=this.leftColliderNode.getComponent(c),this.bottomCollider=this.bottomColliderNode.getComponent(c),S.instance.on(m.LevelEvent,this.LevelEventFun,this),this.buildingData=C.instance.tables.Building.StorageBox,this.ent.get(f).setData(this.labelNum,this.labelNumQuad,null,this.unloadPos,this.bottomCollider,"asc",v.gray,!1,0,this.buildingData.UpperLimit,90),this.ent.get(f).progress=function(){_.instance.storageBadgeNum=t.unloadPos.children.length},this.leftCollider.on("onTriggerEnter",this.onTriggerEnter,this),this.leftCollider.on("onTriggerExit",this.onTriggerExit,this),this.restore()},r.restore=function(){if(_.instance.storageBadgeNum>0)for(var t=0;t<_.instance.storageBadgeNum;t++)this.spawnOneBadge(t)},r.onDisable=function(){this.leftCollider.off("onTriggerEnter",this.onTriggerEnter,this),this.leftCollider.off("onTriggerExit",this.onTriggerExit,this),S.instance.off(m.LevelEvent,this.LevelEventFun,this),this.ent&&this.ent.destroy(!0)},r.onTriggerEnter=function(t){var e=t.otherCollider.node.getComponent(y);e&&e.ent.has(b)&&(this.canUnload=!0,this.pushBag(e.ent.get(b)))},r.onTriggerExit=function(t){var e=t.otherCollider.node.getComponent(y);e&&e.ent&&e.ent.has(b)&&(this.canUnload=!1)},r.LevelEventFun=function(){this.restore()},r.pushBag=function(t){var e=this;if(this.unloadPos.children.length>0&&this.canUnload){var n=this.unloadPos.children[this.unloadPos.children.length-1],i=n.worldPosition;n.parent=C.instance.map,n.setWorldPosition(i),this.ent.get(f).currentBadge=this.unloadPos.children.length,t.pushBadge(n,(function(){_.instance.storageBadgeNum=e.unloadPos.children.length,e.pushBag(t)}))}},r.spawnOneBadge=function(t){var e=this;E.instance.getItemSync(g.Badge).then((function(n){var i=n.getComponent(w);i.badgeType=v.gray,n.parent=e.unloadPos,i.initBadge(n),i.rigidbody.type=u.KINEMATIC,i.collider.enabled=!1,n.setPosition(h(0,.1*t,0)),n.setRotationFromEuler(h(0,90,0)),e.ent.get(f).currentBadge=e.unloadPos.children.length}))},e}(d)).prototype,"labelNum",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(L.prototype,"labelNumQuad",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(L.prototype,"unloadPos",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(L.prototype,"leftColliderNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(L.prototype,"bottomColliderNode",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=L))||F)||F)),r._RF.pop()}}})),System.register("chunks:///_virtual/StretcherEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./RoleEntity.ts","./SpawnPosComp.ts","./Constant.ts"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs},function(t){r=t.CCComp},function(t){s=t.RoleEntity},function(t){a=t.SpawnPosComp},function(t){l=t.ReadyPosType}],execute:function(){var c;n._RF.push({},"6d4c87BDNlNGItTn/XDLxmo","StretcherEntity",void 0);var u=i.ccclass;i.property,t("StretcherEntity",u("StretcherEntity")(c=o.register("StretcherEntity",!1)(c=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).beUsedSoldier=null,e.worPos=null,e}e(n,t);var i=n.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this)},i.reset=function(){this.beUsedSoldier=null,this.worPos=null},i.onEnable=function(){},i.reliveSoldier=function(t){this.worPos=t,this.scheduleOnce(this.checkPos,5)},i.onDisable=function(){this.unschedule(this.check),this.unschedule(this.checkPos),this.ent.destroy()},i.checkPos=function(){for(var t=null,e=o.query(o.allOf(a)),n=0;n<e.length;n++){var i=e[n].get(a);if(!i.occupy&&i.posType==l.solider){t=i,this.beUsedSoldier.getComponent(s).reLive(i,this.worPos),this.beUsedSoldier=null;break}}null==t&&this.scheduleOnce(this.check,1)},i.check=function(){console.log("没有地方站，5s后再次检测"),this.scheduleOnce(this.checkPos,5)},n}(r))||c)||c),n._RF.pop()}}})),System.register("chunks:///_virtual/TeamLevelComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"a6fdbxBVKJKRpGGsZiFJwO+","TeamLevelComp",void 0);var s=i.ccclass;i.property,t("TeamLevelComp",s("TeamLevelComp")(r=o.register("TeamLevelComp")(r=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.reset=function(){},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/TeamLevelCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.BaseCtrl}],execute:function(){var s;n._RF.push({},"900b0oCAxZCU5e6kbuNeNBn","TeamLevelCtrl",void 0);var a=i.ccclass;i.property,t("TeamLevelCtrl",a("TeamLevelCtrl")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.TeamLevel,this.showPrefab()},i.onDisable=function(){t.prototype.onDisable.call(this)},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/TeamLevelEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./TeamLevelComp.ts","./UpgradeComp.ts","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./Util.ts","./EventManager.ts","./AudioManager.ts","./ArrowComp.ts","./UMTrack.ts","./UMEvent.ts","./PoolManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E,w,S,P,M,T,k;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Label,l=t.Node,c=t.Texture2D,u=t.BoxCollider,h=t.MeshRenderer},function(t){p=t.ecs},function(t){d=t.CCComp},function(t){f=t.TeamLevelComp},function(t){g=t.UpgradeComp},function(t){m=t.ResEnum,v=t.GameEvent,y=t.Sounds,b=t.BadgeType},function(t){C=t.GlobalSingle},function(t){_=t.StorageData},function(t){E=t.Util},function(t){w=t.EventManager},function(t){S=t.default},function(t){P=t.ArrowComp},function(t){M=t.UMTrack},function(t){T=t.UMEvent},function(t){k=t.default}],execute:function(){var N,R,B,F,L,A,D,x,I,U,z,G,H,O,V,j,W,Q,J,X,q,Y;r._RF.push({},"0f766hA8WJCQJr3eSPl0aam","TeamLevelEntity",void 0);var Z=s.ccclass,K=s.property;t("TeamLevelEntity",(N=Z("TeamLevelEntity"),R=p.register("TeamLevelEntity",!1),B=K(a),F=K(l),L=K(l),A=K(l),D=K(l),x=K(l),I=K(l),U=K(l),z=K(c),N(G=R((O=e((H=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"labelNum",O,o(e)),i(e,"labelNumQuad",V,o(e)),i(e,"progressNode",j,o(e)),i(e,"unloadPos",W,o(e)),i(e,"Limit",Q,o(e)),i(e,"UnlockLimit",J,o(e)),i(e,"title",X,o(e)),i(e,"icon",q,o(e)),i(e,"titletext",Y,o(e)),e.collider=null,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){k.instance.putItem(m.TeamLevel,this.node)},r.onEnable=function(){var t=this;this.ent.add(f),this.ent.add(g),this.collider=this.getComponent(u),w.instance.on(v.LevelEvent,this.levelChange,this),w.instance.on(v.HouseMaxLevel,this.HouseMaxLevelFun,this),this.refresh(),this.ent.get(g).complete=function(){S.instance.playSoundEffect(y.RankUp),t.ent.get(g).unloading=!0,E.instance.playFX(m.LvlUpFX,t.node,t.node.worldPosition,1),t.scheduleOnce((function(){_.instance.teamLevel++,M.instance.onSetLevel(_.instance.teamLevel.toString(),"队伍等级"+_.instance.teamLevel),1==_.instance.level&&M.instance.trackEvent(T.Level_1_UpgradeTeam),2==_.instance.level&&M.instance.trackEvent(T.Level_2_Upgrade),M.instance.trackEvent(T.Game_Team),_.instance.teamLevel>=C.instance.tables.EnemyLevel[_.instance.level].EnemyLevel&&t.ent.remove(P),t.refresh()}),1)}},r.onDisable=function(){w.instance.off(v.LevelEvent,this.levelChange,this),w.instance.off(v.HouseMaxLevel,this.HouseMaxLevelFun,this),this.ent&&this.ent.destroy(!0)},r.levelChange=function(t){this.refresh()},r.HouseMaxLevelFun=function(t,e){1==e&&_.instance.yellowNum>0&&1==_.instance.level&&_.instance.teamLevel<C.instance.tables.EnemyLevel[_.instance.level].EnemyLevel&&C.instance.guideStep<3&&(C.instance.guideStep=3,this.ent.has(P)||this.ent.add(P).init(this.node))},r.refresh=function(){var t=this,e=C.instance.tables.Team[_.instance.teamLevel];E.instance.load(m.team+"/gnjm_mc_"+e.ID+"/texture",c).then((function(e){var n=t.title.getScale();n.x=1,n.y=e.height/e.width,t.title.setScale(n.multiplyScalar(1.5)),t.title.getComponent(h).material.setProperty("mainTexture",e)})),E.instance.load(m.team+"/gnjm_bz_"+e.ID+"/texture",c).then((function(e){var n=t.icon.getScale();n.x=1,n.y=e.height/e.width,t.icon.setScale(n),t.icon.getComponent(h).material.setProperty("mainTexture",e)}));var n=e.GoldNumber;_.instance.yellowNumTeam>0&&(n=_.instance.yellowNumTeam),this.ent.get(g).setData(this.labelNum,this.labelNumQuad,this.progressNode,this.unloadPos,this.collider,"desc",b.yellow,!0,n,e.GoldNumber),this.ent.get(g).progress=function(e){t.ent.has(P)&&t.ent.remove(P),_.instance.yellowNumTeam=e},_.instance.level>=e.Level?(this.collider.enabled=!0,this.Limit.active=!0,this.UnlockLimit.active=!1):(this.collider.enabled=!1,this.Limit.active=!1,this.UnlockLimit.active=!0)},e}(d)).prototype,"labelNum",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=e(H.prototype,"labelNumQuad",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=e(H.prototype,"progressNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(H.prototype,"unloadPos",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=e(H.prototype,"Limit",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=e(H.prototype,"UnlockLimit",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(H.prototype,"title",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(H.prototype,"icon",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=e(H.prototype,"titletext",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=H))||G)||G)),r._RF.pop()}}})),System.register("chunks:///_virtual/test.ts",["./rollupPluginModLoBabelHelpers.js","cc","./HouseComp.ts","./HouseEntity.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component},function(t){r=t.HouseComp},function(t){s=t.HouseEntity}],execute:function(){var a;n._RF.push({},"fdebf+i9ShGXLr+oYoeAbiq","test",void 0);var l=i.ccclass;i.property,t("test",l("test")(a=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.start=function(){var t=this;this.scheduleOnce((function(){console.log("移除组件"),t.node.getComponent(s).ent.remove(r)}),3),this.scheduleOnce((function(){console.log("添加组件"),t.node.getComponent(s).ent.add(r)}),10)},i.update=function(t){},n}(o))||a),n._RF.pop()}}})),System.register("chunks:///_virtual/ThirdFreeLookCamera.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Quaternion.ts","./VectorTool.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.Enum,c=t.Vec3,u=t.Quat,h=t.Component},function(t){p=t.Quaternion},function(t){d=t.VectorTool}],execute:function(){var f,g,m,v,y,b,C,_,E,w,S,P;t("ThirdPersonCameraType",void 0),r._RF.push({},"50ac0xJ1AlGVo3ba74kimoy","ThirdFreeLookCamera",void 0);var M,T=s.ccclass,k=s.property;!function(t){t[t.Follow=0]="Follow",t[t.FollowTrackRotation=1]="FollowTrackRotation",t[t.FollowIndependentRotation=2]="FollowIndependentRotation"}(M||(M=t("ThirdPersonCameraType",{}))),t("ThirdFreeLookCamera",(f=T("ThirdFreeLookCamera"),g=k(a),m=k(a),v=k({type:l(M)}),f((C=e((b=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"target",C,o(e)),i(e,"lookAt",_,o(e)),i(e,"cameraType",E,o(e)),i(e,"positionOffset",w,o(e)),i(e,"moveSmooth",S,o(e)),i(e,"rotateSmooth",P,o(e)),e.MouseX=0,e.MouseY=0,e._forward=new c,e._right=new c,e._up=new c,e.angle=null,e.yDel=3,e.isDown=!1,e.velocity=new c,e.forwardView=new c,e}n(e,t);var r=e.prototype;return r.start=function(){this.target&&this.init()},r.init=function(){this.cameraType==M.Follow&&this.node.lookAt(this.target.worldPosition)},r.setFollowTarget=function(t){this.target=t,this.lookAt=t,this.init()},r.MouseDown=function(t){this.isDown=!0},r.MouseMove=function(t){this.cameraType==M.FollowIndependentRotation&&this.SetIndependentRotation(t)},r.MouseUp=function(t){this.isDown=!1},r.update=function(t){if(this.target)switch(this.cameraType){case M.Follow:this.SetFollow();break;case M.FollowTrackRotation:this.SetFollowTrackRotation();break;case M.FollowIndependentRotation:this.SetMove(t)}},r.SetFollow=function(){var t=new c;c.add(t,this.lookAt.worldPosition,new c(0,this.positionOffset.y,this.positionOffset.z)),this.node.position=this.node.position.lerp(t,this.moveSmooth)},r.SetFollowTrackRotation=function(){var t=c.multiplyScalar(new c,c.UP,this.positionOffset.y),e=c.multiplyScalar(new c,this.target.forward,this.positionOffset.z),n=c.add(new c,this.target.position,t);c.add(n,n,e),this.node.position=d.SmoothDampV3(this.node.position,n,this.velocity,this.moveSmooth,1e5,.02),this.forwardView=c.subtract(this.forwardView,this.node.position,this.target.getWorldPosition()),this.node.lookAt(this.target.worldPosition)},r.SetMove=function(t){this._forward=new c,this._right=new c,this._up=new c,c.transformQuat(this._forward,c.FORWARD,this.node.rotation),this._forward.multiplyScalar(this.positionOffset.z);var e=new c;e.y+=this.yDel,e=e.add(this.lookAt.worldPosition).subtract(this._forward).add(this._right).add(this._up),this.node.position=this.node.position.lerp(e,this.moveSmooth*t*100)},r.SetIndependentRotation=function(t){var e=-t.movementX,n=-t.movementY,i=new u,o=c.transformQuat(this._right,c.RIGHT,this.node.rotation);i=p.RotationAroundNode(this.node,this.target.position,o,n),this.angle=p.GetEulerFromQuat(i),this.angle.x=this.angle.x>0?this.Clamp(this.angle.x,120,180):this.Clamp(this.angle.x,-180,-170),u.fromEuler(i,this.angle.x,this.angle.y,this.angle.z),this.node.setWorldRotation(i),i=p.RotationAroundNode(this.node,this.target.position,c.UP,e),this.node.setWorldRotation(i),this.angle=p.GetEulerFromQuat(i),this.MouseX=this.angle.y,this.MouseY=this.angle.x},r.Clamp=function(t,e,n){return t<=e?t=e:t>=n&&(t=n),t},r.GetType=function(){return this.cameraType},e}(h)).prototype,"target",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(b.prototype,"lookAt",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(b.prototype,"cameraType",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.Follow}}),w=e(b.prototype,"positionOffset",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(0,12,20)}}),S=e(b.prototype,"moveSmooth",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.02}}),P=e(b.prototype,"rotateSmooth",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.03}}),y=b))||y)),r._RF.pop()}}})),System.register("chunks:///_virtual/Toast.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./Constant.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Label,l=t.tween,c=t.v3,u=t.Component},function(t){h=t.default},function(t){p=t.ResEnum}],execute:function(){var d,f,g,m,v;r._RF.push({},"87c98x1mHVGRIUmC4A1tNvj","Toast",void 0);var y=s.ccclass,b=s.property;t("Toast",(d=y("Toast"),f=b(a),d((v=e((m=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"msgLabel",v,o(e)),e}n(e,t);var r=e.prototype;return r.setData=function(t){this.msgLabel.string=t},r.onEnable=function(){var t=this;l(this.node).set({position:c(0,300,0)}).to(.5,{position:c(0,400,0)}).delay(1).call((function(){h.instance.putItem(p.Toast,t.node)})).start()},r.update=function(t){},e}(u)).prototype,"msgLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=m))||g)),r._RF.pop()}}})),System.register("chunks:///_virtual/TowerComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts"],(function(t){var e,n,i,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs}],execute:function(){var r;n._RF.push({},"58e317qK2tAeKww2UbnM/qB","TowerComp",void 0);var s=i.ccclass;i.property,t("TowerComp",s("TowerComp")(r=o.register("TowerComp")(r=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.reset=function(){},n}(o.Comp))||r)||r),n._RF.pop()}}})),System.register("chunks:///_virtual/TowerCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TowerEntity.ts","./PoolManager.ts","./Constant.ts","./GlobalSingle.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.TowerEntity},function(t){r=t.default},function(t){s=t.ResEnum},function(t){a=t.GlobalSingle},function(t){l=t.BaseCtrl}],execute:function(){var c;n._RF.push({},"92888QjegRCyorqDOz0G1Se","TowerCtrl",void 0);var u=i.ccclass;i.property,t("TowerCtrl",u("TowerCtrl")(c=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.showPrefab()},i.update=function(t){},i.onDisable=function(){t.prototype.onDisable.call(this)},i.showPrefab=function(){var t=this;this.isUnlocked=!0,r.instance.getItemSync(s.Tower).then((function(e){e.parent=t.node;var n=a.instance.tables.Turret[1];e.getComponent(o).totalHp=n.Hp}))},n}(l))||c),n._RF.pop()}}})),System.register("chunks:///_virtual/TowerEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./TowerComp.ts","./BulletEntity.ts","./Constant.ts","./AudioManager.ts","./Util.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,l=t.Prefab,c=t.CylinderCollider,u=t.instantiate},function(t){h=t.ecs},function(t){p=t.CCComp},function(t){d=t.TowerComp},function(t){f=t.BulletEntity},function(t){g=t.ResEnum,m=t.Sounds},function(t){v=t.default},function(t){y=t.Util}],execute:function(){var b,C,_,E,w,S;s._RF.push({},"c5bd9L+aN1HfZ6Lh59Yo64J","TowerEntity",void 0);var P=a.ccclass,M=a.property;t("TowerEntity",(b=P("TowerEntity"),C=h.register("TowerEntity",!1),_=M([l]),b(E=C((S=e((w=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"towers",S,o(e)),e.collider=void 0,e._totalHp=0,e._currentHp=0,e}n(e,t);var s=e.prototype;return s.onLoad=function(){t.prototype.onLoad.call(this)},s.reset=function(){},s.onEnable=function(){this.ent.add(d),this.collider=this.node.getComponent(c),this.collider.on("onTriggerEnter",this.onTriggerEnter,this)},s.onDisable=function(){this.collider.off("onTriggerEnter",this.onTriggerEnter,this),this.ent&&this.ent.destroy(!0)},s.onTriggerEnter=function(t){var e=t.otherCollider.node.getComponent(f);e&&this.beHit(e.Atk)},s.setModel=function(){this.currentHp>0?this.currentHp/this.totalHp>.8?this.setIndex(0):this.currentHp/this.totalHp>.6?this.setIndex(1):this.currentHp/this.totalHp>.4?this.setIndex(2):this.currentHp/this.totalHp>.2?this.setIndex(3):this.setIndex(4):(y.instance.playFX(g.BoomFX,this.node,this.node.worldPosition,.1),v.instance.playSoundEffect(m.Bomb),this.node.active=!1)},s.setIndex=function(t){var e=u(this.towers[t]);this.node.removeAllChildren(),e.parent=this.node},s.beHit=function(t){this.currentHp-=t},s.beHitDelay=function(t,e){var n=this;this.scheduleOnce((function(){n.beHit(t)}),e)},r(e,[{key:"totalHp",get:function(){return this._totalHp},set:function(t){this._totalHp=t,this.currentHp=this._totalHp}},{key:"currentHp",get:function(){return this._currentHp},set:function(t){this._currentHp=t,this.setModel()}}]),e}(p)).prototype,"towers",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E=w))||E)||E)),s._RF.pop()}}})),System.register("chunks:///_virtual/TruckEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./Constant.ts","./Util.ts","./PoolManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node},function(t){l=t.ecs},function(t){c=t.CCComp},function(t){u=t.ResEnum},function(t){h=t.Util},function(t){p=t.default}],execute:function(){var d,f,g,m,v,y;r._RF.push({},"21847scQC5PiLMusmBNUHsS","TruckEntity",void 0);var b=s.ccclass,C=s.property;t("TruckEntity",(d=b("TruckEntity"),f=l.register("TruckEntity",!1),g=C([a]),d(m=f((y=e((v=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"Trucks",y,o(e)),e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.reset=function(){p.instance.putItem(u.Truck,this.node)},r.onEnable=function(){h.instance.playFX(u.PacketSmokeFX,this.node,this.node.worldPosition,1.5)},r.start=function(){},r.onDisable=function(){},e}(c)).prototype,"Trucks",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),m=v))||m)||m)),r._RF.pop()}}})),System.register("chunks:///_virtual/type.ts",["cc"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy,n=t.Enum}],execute:function(){var i,o;t({ScatterType:void 0,VolumeType:void 0}),e._RF.push({},"33e6exdHldA0LG7DNn25zy1","type",void 0),function(t){t[t.Mesh=0]="Mesh",t[t.Item=1]="Item",t[t.Instance=2]="Instance"}(i||(i=t("ScatterType",{}))),n(i),t("VolumeInfo",(function(){this.volume=0,this.maxCount=0,this.count=0})),function(t){t[t.Area=0]="Area",t[t.Line=1]="Line"}(o||(o=t("VolumeType",{}))),n(o),e._RF.pop()}}})),System.register("chunks:///_virtual/types.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){var n;t("SplineMoveType",void 0),e._RF.push({},"f04a0j9OINCgrkh0zdhdXrp","types",void 0),function(t){t[t.None=0]="None",t[t.Node=1]="Node",t[t.Position=2]="Position",t[t.Direction=3]="Direction",t[t.InvDirection=4]="InvDirection"}(n||(n=t("SplineMoveType",{}))),e._RF.pop()}}})),System.register("chunks:///_virtual/UIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResLoader.ts","./UIView.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d;return{setters:[function(t){e=t.createForOfIteratorHelperLoose,n=t.createClass},function(t){i=t.cclegacy,o=t.Node,r=t.UITransform,s=t.view,a=t.director,l=t.log,c=t.instantiate,u=t.isValid},function(t){h=t.resLoader},function(t){p=t.UIShowTypes,d=t.UIView}],execute:function(){i._RF.push({},"1e5dcyfKDdEoIrGOEeuwIfW","UIManager",void 0),t("UIManager",function(){function t(){this.useCount=0,this.BackGroundUI=0,this.isClosing=!1,this.isOpening=!1,this.UICache={},this.UIStack=[],this.UIOpenQueue=[],this.UICloseQueue=[],this.UIConf={},this.uiOpenBeforeDelegate=null,this.uiOpenDelegate=null,this.uiCloseDelegate=null}var i=t.prototype;return i.initUIConf=function(t){this.UIConf=t},i.setUIConf=function(t,e){this.UIConf[t]=e},i.preventTouchFun=function(t){var e=new o;return e.name="preventTouch",e.addComponent(r).setContentSize(s.getVisibleSize()),a.getScene().getChildByName("Canvas").addChild(e),e.setSiblingIndex(t-1),e.on(o.EventType.TOUCH_START,(function(t){t.propagationStopped=!0}),e),e},i.autoExecNextUI=function(){if(this.UICloseQueue.length>0){var t=this.UICloseQueue[0];this.UICloseQueue.splice(0,1),this.close(t)}else if(this.UIOpenQueue.length>0){var e=this.UIOpenQueue[0];this.UIOpenQueue.splice(0,1),this.open(e.uiId,e.uiArgs)}},i.autoExecAnimation=function(t,e,n){n()},i.autoLoadRes=function(t,e){e()},i.updateUI=function(){for(var t=0,e=this.UIStack.length-1;e>=0;--e){var n=this.UIStack[e].uiView.showType;if(this.UIStack[e].uiView.node.active=!0,p.UIFullScreen==n)break;if(p.UISingle==n){for(var i=0;i<this.BackGroundUI;++i)this.UIStack[i]&&(this.UIStack[i].uiView.node.active=!0);t=this.BackGroundUI;break}}for(var o=t;o<e;++o)this.UIStack[o].uiView.node.active=!1},i.getOrCreateUI=function(t,e,n,i){var o=this,r=this.UICache[t];if(r)n(r);else{var s=this.UIConf[t].prefab;if(null==s)return l("getOrCreateUI "+t+" faile, prefab conf not found!"),void n(null);h.load(s,e,(function(e,a){if(e)return l("getOrCreateUI loadRes "+t+" faile, path: "+s+" error: "+e),void n(null);var u=c(a);return null==u?(l("getOrCreateUI instantiate "+t+" faile, path: "+s),n(null),void a.decRef()):null==(r=u.getComponent(d))?(l("getOrCreateUI getComponent "+t+" faile, path: "+s),u.destroy(),n(null),void a.decRef()):void o.autoLoadRes(r,(function(){r.init(i),n(r),r.cacheAsset(a)}))}))}},i.onUIOpen=function(t,e,n,i){var l=this;if(null!=e){n.uiView=e,e.node.active=!0;var c=e.getComponent(r);if(c||(c=e.addComponent(r)),e.quickClose){var u=e.node.getChildByName("background");u||((u=new o).name="background",u.addComponent(r).setContentSize(s.getVisibleSize()),e.node.addChild(u),u.setSiblingIndex(-1)),u.targetOff(o.EventType.TOUCH_START),u.on(o.EventType.TOUCH_START,(function(t){t.propagationStopped=!0,l.close(e)}),u)}a.getScene().getChildByName("Canvas").addChild(e.node),e.node.setSiblingIndex(this.UIConf[t].zIndex),this.UIConf[t].preventTouch&&(n.preventNode=this.preventTouchFun(this.UIConf[t].zIndex)),this.updateUI();var h=0;this.UIStack.length>1&&(h=this.UIStack[this.UIStack.length-2].uiId),this.uiOpenBeforeDelegate&&this.uiOpenBeforeDelegate(t,h),e.onOpen(h,i),this.autoExecAnimation(e,"uiOpen",(function(){e.onOpenAniOver(),l.uiOpenDelegate&&l.uiOpenDelegate(t,h)}))}},i.open=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null);var o={uiId:t,uiArgs:e,uiView:null};this.isOpening||this.isClosing?this.UIOpenQueue.push(o):-1==this.getUIIndex(t)?(this.UIStack.push(o),this.isOpening=!0,this.getOrCreateUI(t,n,(function(n){if(o.isClose||null==n)return l("getOrCreateUI "+t+" faile!\n                        close state : "+o.isClose+" , uiView : "+n),i.isOpening=!1,void(o.preventNode&&(o.preventNode.destroy(),o.preventNode=null));i.onUIOpen(t,n,o,e),i.isOpening=!1,i.autoExecNextUI()}),e)):this.closeToUI(t,e)},i.replace=function(t,e){void 0===e&&(e=null),this.close(this.UIStack[this.UIStack.length-1].uiView),this.open(t,e)},i.close=function(t){var e=this,n=this.UIStack.length;if(n<1||this.isClosing||this.isOpening)t&&this.UICloseQueue.push(t);else{var i;if(t)for(var o=this.UIStack.length-1;o>=0;o--){var r=this.UIStack[o];if(r.uiView===t){i=r,this.UIStack.splice(o,1);break}}else i=this.UIStack.pop();if(void 0!==i){var s=i.uiId,a=i.uiView;if(i.isClose=!0,i.preventNode&&(i.preventNode.destroy(),i.preventNode=null),a){var c=this.UIStack[n-2];this.updateUI();this.autoExecAnimation(a,"uiClose",(function(){e.isClosing=!1,c&&c.uiView&&e.isTopUI(c.uiId)?(c.uiView.node.active=!0,c.uiView.onTop(s,a.onClose())):a.onClose(),e.uiCloseDelegate&&e.uiCloseDelegate(s),a.cache?(e.UICache[s]=a,a.node.removeFromParent(),l("uiView removeFromParent "+i.uiId)):(a.releaseAssets(),a.node.destroy(),l("uiView destroy "+i.uiId)),e.autoExecNextUI()}))}}}},i.closeAll=function(){for(var t,n=e(this.UIStack);!(t=n()).done;){var i=t.value;i.isClose=!0,i.preventNode&&(i.preventNode.destroy(),i.preventNode=null),i.uiView&&(i.uiView.onClose(),i.uiView.releaseAssets(),i.uiView.node.destroy())}this.UIOpenQueue=[],this.UICloseQueue=[],this.UIStack=[],this.isOpening=!1,this.isClosing=!1},i.closeToUI=function(t,e,n){void 0===n&&(n=!0);var i=this.getUIIndex(t);if(-1!=i){i=n?i:i+1;for(var o=this.UIStack.length-1;o>=i;--o){var r=this.UIStack.pop();if(r){var s=r.uiId,a=r.uiView;r.isClose=!0,r.preventNode&&(r.preventNode.destroy(),r.preventNode=null),this.uiCloseDelegate&&this.uiCloseDelegate(s),a&&(a.onClose(),a.cache?(this.UICache[s]=a,a.node.removeFromParent()):(a.releaseAssets(),a.node.destroy()))}}this.updateUI(),this.UIOpenQueue=[],this.UICloseQueue=[],n&&this.open(t,e)}},i.clearCache=function(){for(var t in this.UICache){var e=this.UICache[t];u(e.node)&&(u(e)&&e.releaseAssets(),e.node.destroy())}this.UICache={}},i.isTopUI=function(t){return 0!=this.UIStack.length&&this.UIStack[this.UIStack.length-1].uiId==t},i.getUI=function(t){for(var e=0;e<this.UIStack.length;e++){var n=this.UIStack[e];if(t==n.uiId)return n.uiView}return null},i.getTopUI=function(){return this.UIStack.length>0?this.UIStack[this.UIStack.length-1].uiView:null},i.getUIIndex=function(t){for(var e=0;e<this.UIStack.length;e++)if(t==this.UIStack[e].uiId)return e;return-1},n(t,null,[{key:"instance",get:function(){return null===t._instance&&(t._instance=new t),t._instance},set:function(e){t._instance=e}}]),t}())._instance=null,i._RF.pop()}}})),System.register("chunks:///_virtual/UIView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResKeeper.ts"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Enum},function(t){l=t.ResKeeper}],execute:function(){var c,u,h,p,d,f,g;t("UIShowTypes",void 0),r._RF.push({},"b3fd73zbXFPLrgj6Pd3HWEd","UIView",void 0);var m,v=s.ccclass,y=s.property;!function(t){t[t.UIFullScreen=0]="UIFullScreen",t[t.UIAddition=1]="UIAddition",t[t.UISingle=2]="UISingle"}(m||(m=t("UIShowTypes",{}))),t("UIView",(c=y({type:a(m)}),v(((g=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"quickClose",p,o(e)),i(e,"cache",d,o(e)),i(e,"showType",f,o(e)),e.UIid=0,e}n(e,t);var r=e.prototype;return r.init=function(){},r.onOpen=function(t){},r.onOpenAniOver=function(){},r.onClose=function(){},r.onTop=function(t){},e}(l)).uiIndex=0,p=e((h=g).prototype,"quickClose",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=e(h.prototype,"cache",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=e(h.prototype,"showType",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return m.UISingle}}),u=h))||u)),r._RF.pop()}}})),System.register("chunks:///_virtual/UMEvent.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){var n;t("UMEvent",void 0),e._RF.push({},"612847nLf9PKLaFdnc9pk8E","UMEvent",void 0),function(t){t.Loading_in="Loading_in",t.Level_1_Win="Level_1_Win",t.Level_2_Upgrade="Level_2_Upgrade",t.Game_Level="Game_Level",t.Level_3_Charge="Level_3_Charge",t.Game_in="Game_in",t.Level_2_Charge="Level_2_Charge",t.Level_1_Charge="Level_1_Charge",t.Level_2_In="Level_2_In",t.Level_1_BuildingHouse="Level_1_BuildingHouse",t.Level_4_Charge="Level_4_Charge",t.Level_5_Charge="Level_5_Charge",t.Level_1_UpgradeTeam="Level_1_UpgradeTeam",t.Game_Charge="Game_Charge",t.Game_Team="Game_Team",t.chufa_yuanzidan="chufa_yuanzidan",t.chufa_hongzji="chufa_hongzji",t.chufa_vi_yuanzidan="chufa_vi_yuanzidan",t.chufa_vi_jsy="chufa_vi_jsy",t.chufa_vi_sliver="chufa_vi_sliver",t.chufa_vi_lack_silver="chufa_vi_lack_silver",t.chufa_vi_hongzji="chufa_vi_hongzji",t.chufa_vi_cjwq="chufa_vi_cjwq",t.chufa_vi_kongtou="chufa_vi_kongtou",t.chufa_vi_upgrade_more_glod="chufa_vi_upgrade_more_glod",t.chufa_kongtou="chufa_kongtou",t.chufa_vi_lack_gold="chufa_vi_lack_gold",t.chufa_vi_gold="chufa_vi_gold",t.chufa_vi_bot_banner="chufa_vi_bot_banner",t.chufa_bot_banner="chufa_bot_banner"}(n||(n=t("UMEvent",{}))),e._RF.pop()}}})),System.register("chunks:///_virtual/UpgradeAreaEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./UpgradeComp.ts","./Constant.ts","./PoolManager.ts","./EventManager.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.Label,c=t.BoxCollider},function(t){u=t.ecs},function(t){h=t.CCComp},function(t){p=t.UpgradeComp},function(t){d=t.ResEnum,f=t.GameEvent,g=t.BadgeType},function(t){m=t.default},function(t){v=t.EventManager}],execute:function(){var y,b,C,_,E,w,S,P,M,T,k,N,R,B,F,L,A,D,x,I,U,z;r._RF.push({},"df68fEtFCJKSYbz0M2eSmFj","UpgradeAreaEntity",void 0);var G=s.ccclass,H=s.property;t("UpgradeAreaEntity",(y=G("UpgradeAreaEntity"),b=u.register("UpgradeAreaEntity",!1),C=H({type:a,tooltip:"数字3d"}),_=H({type:l,tooltip:"数字label"}),E=H({type:a,tooltip:"数字3d"}),w=H({type:a,tooltip:"进度条"}),S=H({type:a,tooltip:"卸载点"}),P=H({type:a,tooltip:"解锁条件节点"}),M=H({type:a,tooltip:"解锁条件icon"}),T=H({type:a}),k=H({type:a}),y(N=b((B=e((R=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"RootNode",B,o(e)),i(e,"labelNum",F,o(e)),i(e,"labelNumQuad",L,o(e)),i(e,"progressNode",A,o(e)),i(e,"unloadPos",D,o(e)),i(e,"MaskNode",x,o(e)),i(e,"MaskIcon",I,o(e)),i(e,"NameQuad",U,o(e)),i(e,"NameQuad2",z,o(e)),e.collider=void 0,e.Requirement=void 0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this),this.collider=this.node.getComponent(c)},r.reset=function(){m.instance.putItem(d.UpgradeArea,this.node)},r.onEnable=function(){v.instance.on(f.TeamLevelEvent,this.teamLevelChange,this)},r.onDisable=function(){v.instance.off(f.TeamLevelEvent,this.teamLevelChange,this),this.ent.destroy(!0)},r.teamLevelChange=function(){this.ent.get(p).setLimitMask(this.Requirement,this.RootNode,this.MaskNode,this.MaskIcon)},r.initUpgradeArea=function(t,e,n,i){this.Requirement=t;var o=new p;o.setData(this.labelNum,this.labelNumQuad,this.progressNode,this.unloadPos,this.collider,"desc",g.gray,!0,e,n),this.ent.add(o),o.setLimitMask(this.Requirement,this.RootNode,this.MaskNode,this.MaskIcon)},e}(h)).prototype,"RootNode",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(R.prototype,"labelNum",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(R.prototype,"labelNumQuad",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(R.prototype,"progressNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(R.prototype,"unloadPos",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(R.prototype,"MaskNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(R.prototype,"MaskIcon",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(R.prototype,"NameQuad",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=e(R.prototype,"NameQuad2",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=R))||N)||N)),r._RF.pop()}}})),System.register("chunks:///_virtual/UpgradeComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./JJMgr.ts","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./Util.ts","./EventManager.ts","./BadgeEntity.ts","./RoleEntity.ts","./ECS.ts","./BadgePopComp.ts","./BagComp.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_,E;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator,r=t.Quat,s=t.MeshRenderer,a=t.ModelComponent,l=t.Texture2D,c=t.tween},function(t){u=t.default},function(t){h=t.ResEnum,p=t.BadgeType,d=t.GameEvent},function(t){f=t.GlobalSingle},function(t){g=t.StorageData},function(t){m=t.Util},function(t){v=t.EventManager},function(t){y=t.BadgeEntity},function(t){b=t.RoleEntity},function(t){C=t.ecs},function(t){_=t.BadgePopComp},function(t){E=t.BagComp}],execute:function(){var w;i._RF.push({},"08ac2hrLIJM64j9DOAqPPtk","UpgradeComp",void 0);var S=o.ccclass;o.property,t("UpgradeComp",S("UpgradeComp")(w=C.register("UpgradeComp")(w=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).labelNum=null,e.labelNumQuad=null,e.progressNode=null,e.badgeType=p.gray,e.canUnload=!0,e.unloading=!1,e._currentBadge=0,e._maxBadge=0,e.collider=null,e.isRecycle=!0,e.unloadPos=null,e.orderType="desc",e.quat=new r,e.RootNode=null,e.MaskNode=null,e.MaskIcon=null,e.onceUnloadCount=0,e.gray_lack_count=0,e.yellow_lack_count=0,e._buildingName="",e.progress=null,e.complete=null,e._pos=void 0,e}e(i,t);var o=i.prototype;return o.reset=function(){this.unloading=!1,this.canUnload=!0,this.progress=null,this.complete=null,this.unloadPos=null,this._buildingName="",this.collider.off("onTriggerStay",this.onTriggerStay,this),this.collider.off("onTriggerExit",this.onTriggerExit,this)},o.setData=function(t,e,n,i,o,s,a,l,c,u,h){void 0===h&&(h=null),this.labelNum=t,this.labelNumQuad=e,this.progressNode=n,this.badgeType=a,this.collider=o,this.isRecycle=l,this.unloadPos=i,this.orderType=s,this.maxBadge=u,this.currentBadge=c,null!=h?r.fromEuler(this.quat,0,h,0):r.fromEuler(this.quat,0,0,0),this.collider.on("onTriggerStay",this.onTriggerStay,this),this.collider.on("onTriggerExit",this.onTriggerExit,this)},o.setNum=function(){"desc"==this.orderType&&(this.labelNum.string=this.currentBadge.toString()),"asc"==this.orderType&&(this.labelNum.string=this.currentBadge+" / "+this.maxBadge),this.labelNum.node.active=!0,this.labelNum.updateRenderData(!0),this.labelNum.node.active=!1,this.labelNumQuad.getComponent(s).material.setProperty("mainTexture",this.labelNum.spriteFrame.texture),this.progressNode&&this.progressNode.getComponent(a).material.setProperty("progress",(this.maxBadge-this.currentBadge)/this.maxBadge)},o.onTriggerStay=function(t){var e=t.otherCollider.node.getComponent(b);this.canUnload&&e&&e.isPlayer&&(f.instance.joystickMoving?this.unloading&&(this.unloading=!1):this.unloading||(this.unloading=!0,this.onceUnloadCount=0,this.startUnload(e.ent.get(E))))},o.onTriggerExit=function(t){var e=t.otherCollider.node;e.getComponent(b)&&e.getComponent(b).isPlayer&&(this.unloading=!1,this.onceUnloadCount=0,this.canUnload=!0,this.ent.has(_)&&this.ent.get(_).badgePopNode&&this.ent.remove(_))},o.setNameQuad=function(t,e,n){this._buildingName=n,"Howitzer1"!=n&&"Howitzer2"!=n||(this._buildingName="Howitzer"),"House1"!=n&&"House2"!=n&&"House3"!=n&&"House4"!=n&&"UpgradeHouse1"!=n&&"UpgradeHouse2"!=n&&"UpgradeHouse3"!=n&&"UpgradeHouse4"!=n||(this._buildingName="House"),"Tanker"!=n&&"UpgradeTanker"!=n||(this._buildingName="Tanker"),this._buildingName?m.instance.load("texture/"+this._buildingName+"/texture",l).then((function(n){if(n){var i=e.getScale();i.x=1,i.y=n.height/n.width*1,t.setScale(i.multiplyScalar(3)),t.getComponent(s).material.setProperty("mainTexture",n),e.setScale(i),e.getComponent(s).material.setProperty("mainTexture",n)}})):console.warn("路径不存在： texture/"+this._buildingName+"/texture")},o.setLimitMask=function(t,e,n,i){var o=this;this.RootNode=e,this.MaskNode=n,this.MaskIcon=i,this.MaskNode&&this.MaskIcon&&(g.instance.teamLevel>=t?(this.canUnload=!0,this.MaskNode.active=!1,this.unloadPos.active=!0,this.RootNode.active=!0):(this.canUnload=!1,this.RootNode.active=!1,this.MaskNode.active=!0,this.unloadPos.active=!1,m.instance.load(h.team+"/gnjm_bz_"+t+"/texture",l).then((function(t){var e=o.MaskIcon.getScale();e.x=1,e.y=t.height/t.width,o.MaskIcon.setScale(e.multiplyScalar(1.7)),o.MaskIcon.getComponent(s).material.setProperty("mainTexture",t)}))))},o.startUnload=function(t){var e=this;if(this.unloading&&("desc"==this.orderType&&this.currentBadge>0||"asc"==this.orderType&&this.currentBadge<this.maxBadge)){var n=t.getBadgeByType(this.badgeType,this._buildingName);if(n){this.onceUnloadCount++;var i=n.worldPosition;n.parent=this.unloadPos,n.setWorldPosition(i),t.resizePos(),this._pos=this.unloadPos.getWorldPosition().clone(),this.isRecycle||(this._pos.y+=.1*this.currentBadge),c(n).to(.05,{worldPosition:this._pos,rotation:this.quat}).call((function(){e.isRecycle&&n.getComponent(y).ent.destroy(!0),"desc"==e.orderType&&(e.currentBadge-=1,e.progress&&e.progress(e.currentBadge),e.currentBadge<=0&&(e.onceUnloadCount=0,e.complete&&e.complete())),"asc"==e.orderType&&(e.currentBadge+=1,e.progress&&e.progress(e.currentBadge),e.currentBadge>=e.maxBadge&&(e.onceUnloadCount=0,e.complete&&e.complete())),e.startUnload(t)})).start()}else{if(100*Math.random()<u.instance.dataConfig.front_vi_fc_chance){var o=this.ent.get(_);o||(o=this.ent.add(_)),o.attachNode=this.unloadPos,o.badgeType=this.badgeType}this.onceUnloadCount>0&&(this.badgeType==p.yellow&&this.yellow_lack_count++,this.badgeType==p.gray&&this.gray_lack_count++,(this.yellow_lack_count>=u.instance.dataConfig.front_gold_lack_count||this.gray_lack_count>=u.instance.dataConfig.front_silver_lack_count)&&(v.instance.emit(d.UpgradeComp_BadgeLack,{unloadPosName:this.unloadPos.name,badgeType:this.badgeType}),this.badgeType==p.yellow&&(this.yellow_lack_count=0),this.badgeType==p.gray&&(this.gray_lack_count=0)))}}},n(i,[{key:"currentBadge",get:function(){return this._currentBadge},set:function(t){this._currentBadge=t,this.setNum()}},{key:"maxBadge",get:function(){return this._maxBadge},set:function(t){this._maxBadge=t}}]),i}(C.Comp))||w)||w),i._RF.pop()}}})),System.register("chunks:///_virtual/UpgradeLevelAnim.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.tween,r=t.v3,s=t.Component}],execute:function(){var a;n._RF.push({},"a4c14zFVMRJBLS4NimmPBcp","UpgradeLevelAnim",void 0);var l=i.ccclass;i.property,t("UpgradeLevelAnim",l("UpgradeLevelAnim")(a=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){o(this.node).set({position:r(this.node.position.x,667*Math.random()-333.5,0)}).delay(1).by(.5,{position:r(0,100,0)}).start()},i.update=function(t){},n}(s))||a),n._RF.pop()}}})),System.register("chunks:///_virtual/UpgradeLevelComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./EventManager.ts","./UIManager.ts"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,o=t.Component},function(t){r=t.GameEvent,s=t.UIID},function(t){a=t.EventManager},function(t){l=t.UIManager}],execute:function(){var c;n._RF.push({},"fffbfk9TFhJtocE3v3OHjxw","UpgradeLevelComp",void 0);var u=i.ccclass;i.property,t("UpgradeLevelComp",u("UpgradeLevelComp")(c=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){a.instance.on(r.TeamLevelEvent,this.TeamLevelEventFun,this)},i.onDisable=function(){a.instance.on(r.TeamLevelEvent,this.TeamLevelEventFun,this)},i.TeamLevelEventFun=function(){l.instance.open(s.UpgradeLevelUi)},n}(o))||c),n._RF.pop()}}})),System.register("chunks:///_virtual/UpgradeLevelUi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./StorageData.ts","./Util.ts","./EventManager.ts","./UIManager.ts","./UIView.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f,g,m,v,y,b,C,_;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.Node,l=t.Label,c=t.Animation,u=t.SpriteFrame,h=t.Sprite,p=t.tween,d=t.v3},function(t){f=t.ResEnum,g=t.GameEvent},function(t){m=t.GlobalSingle},function(t){v=t.StorageData},function(t){y=t.Util},function(t){b=t.EventManager},function(t){C=t.UIManager},function(t){_=t.UIView}],execute:function(){var E,w,S,P,M,T,k,N,R,B,F,L,A,D,x;r._RF.push({},"c558bYAC9BFQLBlRSRlPtsQ","UpgradeLevelUi",void 0);var I=s.ccclass,U=s.property;t("UpgradeLevelUi",(E=I("UpgradeLevelUi"),w=U(a),S=U(a),P=U(a),M=U(a),T=U(l),k=U(c),E((B=e((R=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,i(e,"icon1",B,o(e)),i(e,"icon2",F,o(e)),i(e,"name1",L,o(e)),i(e,"name2",A,o(e)),i(e,"countLabel",D,o(e)),i(e,"anim",x,o(e)),e}return n(e,t),e.prototype.onOpen=function(t){var e=this;this.anim.play();var n=m.instance.tables.Team[v.instance.teamLevel-1],i=m.instance.tables.Team[v.instance.teamLevel];this.icon1.active=!1,y.instance.load(f.team+"/gnjm_bz_"+n.ID+"/spriteFrame",u).then((function(t){e.icon1.getComponent(h).spriteFrame=t,e.icon1.active=!0})),this.icon2.active=!1,y.instance.load(f.team+"/gnjm_bz_"+i.ID+"/spriteFrame",u).then((function(t){e.icon2.getComponent(h).spriteFrame=t,e.icon2.active=!0})),this.name1.active=!1,y.instance.load(f.team+"/gnjm_mc_"+n.ID+"/spriteFrame",u).then((function(t){e.name1.getComponent(h).spriteFrame=t,e.name1.active=!0})),this.name2.active=!1,y.instance.load(f.team+"/gnjm_mc_"+i.ID+"/spriteFrame",u).then((function(t){e.name2.getComponent(h).spriteFrame=t,e.name2.active=!0})),this.countLabel.string=(i.SoldierNum-n.SoldierNum).toString(),p(this.icon1).set({position:d(0,0,0)}).delay(1).to(.5,{position:d(0,350,0)}).delay(1).start(),p(this.icon2).set({position:d(0,-350,0)}).delay(1).to(.5,{position:d(0,0,0)}).call((function(){})).delay(1).call((function(){b.instance.emit(g.UpgradeTeamLevelUIClose),C.instance.close(e)})).start()},e}(_)).prototype,"icon1",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(R.prototype,"icon2",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(R.prototype,"name1",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(R.prototype,"name2",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(R.prototype,"countLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(R.prototype,"anim",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=R))||N)),r._RF.pop()}}})),System.register("chunks:///_virtual/UpgradeSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UpgradeComp.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator},function(t){r=t.UpgradeComp},function(t){s=t.ecs}],execute:function(){var a;i._RF.push({},"527296Pm9NO9KsDCzKY72vl","UpgradeSys",void 0);var l=o.ccclass;t("UpgradeSys",l("UpgradeSys")(a=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var o=i.prototype;return o.filter=function(){return s.allOf(r)},o.init=function(){},o.entityEnter=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},o.firstUpdate=function(t){},o.entityRemove=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},o.update=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},i}(s.ComblockSystem))||a),i._RF.pop()}}})),System.register("chunks:///_virtual/Util.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PoolManager.ts","./GameUtil.ts","./AnimFinishRecycle.ts","./DelayRecycle.ts","./Recycle.ts"],(function(t){var e,n,i,o,r,s,a,l;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.default},function(t){r=t.GameUtil},function(t){s=t.AnimFinishRecycle},function(t){a=t.DelayRecycle},function(t){l=t.Recycle}],execute:function(){var c,u;n._RF.push({},"2d5d2fDnYhG6JAchNWOx2u0","Util",void 0);var h=i.ccclass;i.property,t("Util",h("Util")(((u=function(){function t(){}var n=t.prototype;return n.formatSecondsHMS=function(t){var e=parseInt(t);return(Math.floor(e/3600)<10?"0"+Math.floor(e/3600):Math.floor(e/3600))+":"+(Math.floor(e/60%60)<10?"0"+Math.floor(e/60%60):Math.floor(e/60%60))+":"+(Math.floor(e%60)<10?"0"+Math.floor(e%60):Math.floor(e%60))},n.formatSecondsMS=function(t){var e=parseInt(t);return(Math.floor(e/60%60)<10?"0"+Math.floor(e/60%60):Math.floor(e/60%60))+":"+(Math.floor(e%60)<10?"0"+Math.floor(e%60):Math.floor(e%60))},n.isEmptyStr=function(t){return!("string"==typeof t&&t.length>0)},n.getUniqueNum=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},n.load=function(t,e){return new Promise((function(n,i){r.instance.getBundle("res").then((function(o){o.load(t,e,(function(o,r){o?(console.log(t,e),console.warn(o),i(o)):n(r)}))}))}))},n.playFX=function(t,e,n,i,r){o.instance.getItemSync(t).then((function(o){o&&e&&e.isValid&&(i>0?(o.getComponent(a)||o.addComponent(a),o.getComponent(a).delayTime=i):o.getComponent(s)||o.addComponent(s),r&&o.setRotation(r),o.getComponent(l).path=t,o.parent=e,o.setWorldPosition(n))}))},e(t,null,[{key:"instance",get:function(){return null===t._instance&&(t._instance=new t),t._instance},set:function(e){t._instance=e}}]),t}())._instance=null,c=u))||c),n._RF.pop()}}})),System.register("chunks:///_virtual/utils.ts",["cc","./mesh-utility.ts","./index.ts","./npm.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u;return{setters:[function(t){e=t.cclegacy,n=t.Mat4,i=t.Vec3,o=t.Color,r=t.gfx,s=t.ModelComponent,a=t.Node,l=t.Layers},function(t){c=t.default},null,function(t){u=t.cce}],execute:function(){t({callGizmoFunction:function(t){},create3DNode:d,createLineShape:function(t,e){var n=u.gizmos.EngineUtils,a=(n.createMesh,n.addMeshToNode),l=n.setMeshColor;n.AttributeName,n.updateVBAttr,n.updateIBAttr,t=t||"Line",e=e||o.WHITE;var h=c.createMesh({positions:[new i(0,0,0),new i(0,1,0),new i(1,0,0),new i(1,1,0)],indices:[0,1,1,2,2,3],primitiveType:r.PrimitiveMode.LINE_LIST}),p=d(t);a(p,h),l(p,e);var f=p.getComponent(s),g=[];return p.updatePoints=function(t){g.length=0;for(var e=1;e<t.length;e++)g.push(e-1,e);c.updateOrCreateModelMesh(f,{positions:t,indices:g,primitiveType:r.PrimitiveMode.LINE_LIST})},p},getNodeLocalPostion:f,getNodeWorldPostion:g,node2nodeLength:function(t,e,n){return p.set(n,0,0),m(t,e,p,p,!0),p.length()},node2nodePos:m}),e._RF.push({},"976acvUf6FG467gA3kK0MNs","utils",void 0);var h=new n,p=new i;function d(t){var e=new a(t);return e.layer=l.Enum.GIZMOS,e.modelColor=new o,e}function f(t,e,o,r){return void 0===r&&(r=!1),t.getWorldMatrix(h),n.invert(h,h),r?i.transformMat4Normal(o||new i,e,h):i.transformMat4(o||new i,e,h)}function g(t,e,n,o){return void 0===o&&(o=!1),t.getWorldMatrix(h),o?i.transformMat4Normal(n||new i,e,h):i.transformMat4(n||new i,e,h)}function m(t,e,n,i,o){return void 0===o&&(o=!1),g(t,n,i,o),f(e,i,i,o),i}e._RF.pop()}}})),System.register("chunks:///_virtual/VectorTool.ts",["cc"],(function(t){var e,n;return{setters:[function(t){e=t.cclegacy,n=t.Vec3}],execute:function(){e._RF.push({},"3e1cfnEWrRMS7dsZnhHDXCd","VectorTool",void 0),t("VectorTool",function(){function t(){}return t.SmoothDampV3=function(t,e,i,o,r,s){var a=0,l=0,c=0,u=2/(o=Math.max(1e-4,o)),h=u*s,p=1/(1+h+.48*h*h+.235*h*h*h),d=t.x-e.x,f=t.y-e.y,g=t.z-e.z,m=e,v=r*o,y=v*v,b=d*d+f*f+g*g;if(b>y){var C=Math.sqrt(b);d=d/C*y,f=f/C*y,g=g/C*y}e.x=t.x-d,e.y=t.y-f,e.z=t.z-g;var _=(i.x+u*d)*s,E=(i.y+u*f)*s,w=(i.z+u*g)*s;i.x=(i.x-u*_)*p,i.y=(i.y-u*E)*p,i.z=(i.z-u*w)*p,a=e.x+(d+_)*p,l=e.y+(f+E)*p,c=e.z+(g+w)*p;var S=m.x-t.x,P=m.y-t.y,M=m.z-t.z;return S*(a-m.x)+P*(l-m.y)+M*(c-m.z)>0&&(a=m.x,l=m.y,c=m.z,i.x=(a-m.x)/s,i.y=(l-m.y)/s,i.z=(c-m.z)/s),new n(a,l,c)},t.SmoothDamp=function(e,n,i,o,r,s){var a=2/(o=Math.max(1e-4,o)),l=a*s,c=1/(1+l+.48*l*l+.235*l*l*l),u=e-n,h=n,p=r*o,d=(i+a*(u=t.Clamp(u,-p,p)))*s;i=(i-a*d)*c;var f=(n=e-u)+(u+d)*c;return h-e>0==f>h&&(i=((f=h)-h)/s),f},t.Clamp=function(t,e,n){return t<=e&&(t=e),t>=n&&(t=n),t},t}()),e._RF.pop()}}})),System.register("chunks:///_virtual/VehicleComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./PoolManager.ts","./ECS.ts","./VehicleSys.ts"],(function(t){var e,n,i,o,r,s,a,l,c;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){i=t.cclegacy,o=t._decorator},function(t){r=t.ResEnum},function(t){s=t.GlobalSingle},function(t){a=t.default},function(t){l=t.ecs},function(t){c=t.VehicleType}],execute:function(){var u;i._RF.push({},"5132dBqYdxLAqQTzYRW86NB","VehicleComp",void 0);var h=o.ccclass;o.property,t("VehicleComp",h("VehicleComp")(u=l.register("VehicleComp")(u=function(t){function i(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).vehicleType=void 0,e.vehicleNode=void 0,e._hp=100,e._currentHp=100,e}e(i,t);var o=i.prototype;return o.reset=function(){this.vehicleType==c.moto&&a.instance.putItem(r.Moto,this.vehicleNode,!0)},o.init=function(t){this.vehicleType=t},n(i,[{key:"hp",get:function(){return this._hp},set:function(t){this._hp=t,this.currentHp=this._hp}},{key:"currentHp",get:function(){return this._currentHp},set:function(t){this._currentHp=t,this._currentHp<=0&&(s.instance.vehicleType=null,this.ent.remove(i,!0))}}]),i}(l.Comp))||u)||u),i._RF.pop()}}})),System.register("chunks:///_virtual/VehicleSys.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./GlobalSingle.ts","./EventManager.ts","./PoolManager.ts","./VehicleComp.ts","./RoleEntity.ts","./ECS.ts"],(function(t){var e,n,i,o,r,s,a,l,c,u,h,p,d,f;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t._decorator,r=t.Enum,s=t.v3},function(t){a=t.GameEvent,l=t.ResEnum},function(t){c=t.GlobalSingle},function(t){u=t.EventManager},function(t){h=t.default},function(t){p=t.VehicleComp},function(t){d=t.RoleEntity},function(t){f=t.ecs}],execute:function(){var g;i._RF.push({},"895c5Wud8NK5oC2KHM5TuaL","VehicleSys",void 0);var m=o.ccclass,v=t("VehicleType",r({moto:1}));t("VehicleSys",m("VehicleSys")(g=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var o=i.prototype;return o.filter=function(){return f.allOf(p)},o.init=function(){u.instance.on(a.PackageEvent,this.packageEventFun,this)},o.entityEnter=function(t){for(var e,i=c.instance.player.getComponent(d),o=function(){var t=e.value.get(p);t.vehicleType==v.moto&&(h.instance.getItemSync(l.Moto).then((function(e){t.vehicleNode=e,t.vehicleNode.parent=c.instance.player,t.vehicleNode.setPosition(s(0,0,.3)),t.vehicleNode.setRotationFromEuler(s(0,90,0))})),i.setMoveSpeed(1.2*c.instance.playerMoveSpeed),i.strengthenSize=3*1.2,i.modelNode.setPosition(s(0,.5,0)))},r=n(t);!(e=r()).done;)o()},o.firstUpdate=function(t){},o.entityRemove=function(t){var e=c.instance.player.getComponent(d);e.setMoveSpeed(1.2*c.instance.playerMoveSpeed),e.strengthenSize=3,e.modelNode.setPosition(s(0,0,0))},o.update=function(t){for(var e,i=n(t);!(e=i()).done;)e.value},o.packageEventFun=function(t,e){e&&c.instance.player.getComponent(d).ent.has(p)&&c.instance.player.getComponent(d).ent.remove(p)},i}(f.ComblockSystem))||g),i._RF.pop()}}})),System.register("chunks:///_virtual/WoodenBarrierCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Constant.ts","./BaseCtrl.ts"],(function(t){var e,n,i,o,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ResEnum},function(t){r=t.BaseCtrl}],execute:function(){var s;n._RF.push({},"5bc63vqIL1C/qpld+2PAav/","WoodenBarrierCtrl",void 0);var a=i.ccclass;i.property,t("WoodenBarrierCtrl",a("WoodenBarrierCtrl")(s=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.pPath=o.WoodenBarrier,this.showPrefab()},i.onDisable=function(){t.prototype.onDisable.call(this)},n}(r))||s),n._RF.pop()}}})),System.register("chunks:///_virtual/WoodenBarrierEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ECS.ts","./CCComp.ts","./PoolManager.ts","./Constant.ts"],(function(t){var e,n,i,o,r,s,a;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator},function(t){o=t.ecs},function(t){r=t.CCComp},function(t){s=t.default},function(t){a=t.ResEnum}],execute:function(){var l;n._RF.push({},"f0ffenHpEtKcp4ok5lzhgnJ","WoodenBarrierEntity",void 0);var c=i.ccclass;i.property,t("WoodenBarrierEntity",c("WoodenBarrierEntity")(l=o.register("WoodenBarrierEntity",!1)(l=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onLoad=function(){t.prototype.onLoad.call(this)},i.reset=function(){s.instance.putItem(a.WoodenBarrier,this.node)},i.onEnable=function(){},i.start=function(){},i.onDisable=function(){this.ent&&this.ent.destroy(!0)},n}(r))||l)||l),n._RF.pop()}}})),t="virtual:///prerequisite-imports/Scripts",e="chunks:///_virtual/Scripts",System.register(t,[e],(function(t,e){return{setters:[function(e){var n={};for(var i in e)"default"!==i&&"__esModule"!==i&&(n[i]=e[i]);t(n)}],execute:function(){}}})); 
 			}); 	require("subpackages/Scripts/game.js");
 	