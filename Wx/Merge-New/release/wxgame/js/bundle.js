!function(){"use strict";class e{constructor(){this.bodyId=0,this.handId=0,this.backId=0,this.type=1}}class t{constructor(){this.grade=1,this.skinArr=[1,0,0,0,0,0,0,0],this.itemArr=[1,1,1,0,0,0,0,0,0,0,0,0,0,0],this.chooseArr=[]}}class i{static getPlayerData(){return localStorage.getItem("playerData")?null==this._playerData&&(this._playerData=JSON.parse(localStorage.getItem("playerData"))):(this._playerData=new t,localStorage.setItem("playerData",JSON.stringify(this._playerData))),this._playerData}static setPlayerData(){localStorage.setItem("playerData",JSON.stringify(this._playerData))}static setChooseItem(t,i,a,s){let n=new e;n.bodyId=t,n.handId=i,n.backId=a,n.type=s,this._playerData.chooseArr.length<3?this._playerData.chooseArr.push(n):(this._playerData.chooseArr.shift(),this._playerData.chooseArr.push(n)),this.setPlayerData()}static getFreeBody(){for(let e=0;e<this._playerData.skinArr.length;e++)if(0==this._playerData.skinArr[e])return e;return-1}static getFreeItem(){for(let e=0;e<this._playerData.itemArr.length;e++)if(0==this._playerData.itemArr[e])return e;return-1}static getBodyNameById(e){let t="";switch(e){case 0:t="可乐";break;case 1:t="斑马";break;case 2:t="消防栓";break;case 3:t="章鱼怪";break;case 4:t="剪刀怪";break;case 5:t="呆呆鸟";break;case 6:t="面包机";break;case 7:t="奶牛"}return t}static getItemNameById(e){let t="";switch(e){case 0:t="可乐手臂";break;case 1:t="斑马腿";break;case 2:t="喷水枪";break;case 3:t="章鱼触手";break;case 4:t="剪刀手";break;case 5:t="翅膀";break;case 6:t="机器手臂";break;case 7:t="牛奶壶";break;case 8:t="假手";break;case 9:t="喷胶器";break;case 10:t="马桶";break;case 11:t="怪物手臂";break;case 12:t="铁棒";break;case 13:t="植物手"}return t}static getSkillTimeByTypeId(e){let t=0;switch(e){case 1:t=2*Math.random()+6;break;case 2:t=2*Math.random()+5.5;break;case 3:t=2*Math.random()+5;break;case 4:t=2*Math.random()+4.5;break;case 5:t=2*Math.random()+4}return t}static getAttackEventTime(e){let t=0;switch(e){case 0:t=1330;break;case 1:case 2:case 3:t=880;break;case 4:t=1e3;break;case 5:t=1200;break;case 6:t=750;break;case 7:t=880}return t}static getDamageByType(e){let t=0;switch(e){case 1:t=50*Math.random()+30;break;case 2:t=50*Math.random()+40;break;case 3:t=50*Math.random()+50;break;case 4:t=50*Math.random()+60;break;case 5:t=50*Math.random()+70}return t}static getHpByType(e){let t=0;switch(e){case 1:t=200*Math.random()+500;break;case 2:t=200*Math.random()+600;break;case 3:t=200*Math.random()+700;break;case 4:t=200*Math.random()+800;break;case 5:t=200*Math.random()+900}return t}static getIsNearByHandId(e){return 1==e||2==e||3==e||4==e||5==e||8==e||11==e||12==e||13==e}}i._playerData=null,i.levelDataArr=[];class a{static LoginWx(e){if(!Laya.Browser.onWeiXin)return;let t=Laya.Browser.window.wx.getLaunchOptionsSync();Laya.Browser.window.wx.login({success(i){i.code&&(console.log("res.code:",i.code),e&&e(i.code,t.query))}})}static GetLaunchParam(e){Laya.Browser.onWeiXin&&(this.OnShowFun=e,e(this.GetLaunchPassVar()),Laya.Browser.window.wx.onShow(e=>{null!=this.OnShowFun&&this.OnShowFun(e),console.log("wx on show")}))}static GetLaunchPassVar(){return Laya.Browser.onWeiXin?Laya.Browser.window.wx.getLaunchOptionsSync():null}static WxOnHide(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onHide(e)}static WxOffHide(e){e&&Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offHide(e)}static WxOnShow(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onShow(e)}static WxOffShow(e){e&&Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offShow(e)}static httpRequest(e,t,i="get",a){var s=new Laya.HttpRequest;s.http.timeout=5e3,s.once(Laya.Event.COMPLETE,this,a),s.once(Laya.Event.ERROR,this,this.httpRequest,[e,t,i,a]),"get"==i?s.send(e+"?"+t,"",i,"text"):"post"==i&&s.send(e,JSON.stringify(t),i,"text")}static DoVibrate(e=!0){Laya.Browser.onWeiXin&&this.isVibrate&&(e?Laya.Browser.window.wx.vibrateShort():Laya.Browser.window.wx.vibrateLong())}static OpenAlert(e,t=2e3,i=!1){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.showToast({title:e,duration:t,mask:!1,icon:i?"success":"none"})}static preViewImage(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.previewImage({current:e,urls:[e]})}}a.UnityPath="LayaScene_SampleScene/Conventional/",a.version="",a.isVibrate=!0,a.isMusic=!0,a.OnShowFun=null;class s{constructor(){this.effectArr=[]}static get instance(){return this._instance||(this._instance=new s),this._instance}initLoading(e){var t=[{url:"res/Sounds/bgm.mp3",type:Laya.Loader.SOUND}];Laya.loader.load(t,Laya.Handler.create(this,e)),Laya.SoundManager.setMusicVolume(1),Laya.SoundManager.setSoundVolume(1)}playMusic(e,t=0,i){Laya.SoundManager.playMusic("res/Sounds/"+e+".mp3",t,new Laya.Handler(this,i))}stopMusic(){Laya.SoundManager.stopMusic()}playSoundEffect(e,t=1,i,a,s){return Laya.SoundManager.playSound("res/Sounds/"+e+".mp3",t,new Laya.Handler(this,i),a,s)}stopSound(e){Laya.SoundManager.stopSound("res/Sounds/"+e+".mp3")}}class n{static calcDistance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static getWorldDis(e,t){let i=e.transform.position.clone(),a=t.transform.position.clone();return Laya.Vector3.distance(i,a)}static getDirectionAToB(e,t,i=!0){let a=e.transform.position.clone(),s=t.transform.position.clone(),n=new Laya.Vector3(0,0,0);return Laya.Vector3.subtract(s,a,n),i&&Laya.Vector3.normalize(n,n),n}static fixPosY(e,t=1334){return e*Laya.stage.displayHeight/t}static findNodeByName(e,t){let i=null,a=e=>{for(let s=0;s<e.numChildren;s++){if(e.getChildAt(s).name==t)return void(i=e.getChildAt(s));a(e.getChildAt(s))}};return a(e),i}static TmoveTo(e,t,i,a,s){if(!e.transform)return;let n=new Laya.Tween;var r=e.transform.position;n.to(e.transform.position,{x:i.x,y:i.y,z:i.z,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.position=r)})},t,s,Laya.Handler.create(this,()=>{a&&a()}))}static TmoveToYZ(e,t,i,a,s){if(!e.transform)return;let n=new Laya.Tween;var r=e.transform.position;return n.to(e.transform.position,{y:i.y,z:i.z,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.position=r)})},t,s,Laya.Handler.create(this,()=>{a&&a()})),n}static TmoveToX(e,t,i,a,s){if(!e.transform)return;let n=new Laya.Tween;var r=e.transform.localPosition;n.to(e.transform.localPosition,{x:i.x,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.localPosition=r)})},t,null,Laya.Handler.create(this,()=>{a&&a()}))}static TmoveToY(e,t,i,a,s){if(!e.transform)return;let n=new Laya.Tween;var r=e.transform.localPosition;n.to(e.transform.localPosition,{y:i.y,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.localPosition=r)})},t,s,Laya.Handler.create(this,()=>{a&&a()}))}static TmoveToWorld(e,t,i,a,s){if(!e.transform)return;let n=new Laya.Tween;var r=e.transform.position;n.to(e.transform.position,{y:i.y,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.position=r)})},t,null,Laya.Handler.create(this,()=>{a&&a()}))}static RotateWithPoint(e,t,i){let a=new Laya.Vector3,s=e.transform.localPosition.clone();return i=i*Math.PI/180,a.x=s.x*Math.cos(i)+(t.y*s.z-t.z*s.y)*Math.sin(i)+t.x*(t.x*s.x+t.y*s.y+t.z*s.z)*(1-Math.cos(i)),a.y=s.y*Math.cos(i)+(t.x*s.z-t.z*s.x)*Math.sin(i)+t.y*(t.x*s.x+t.y*s.y+t.z*s.z)*(1-Math.cos(i)),a.z=s.z*Math.cos(i)+(t.x*s.y-t.y*s.x)*Math.sin(i)+t.z*(t.x*s.x+t.y*s.y+t.z*s.z)*(1-Math.cos(i)),a}static RotateTo(e,t,i,a){var s=e.transform.rotationEuler;Laya.Tween.to(e.transform.rotationEuler,{x:i.x,y:i.y,z:i.z,update:new Laya.Handler(this,function(){e&&(e.transform.rotationEuler=s)})},t,Laya.Ease.cubicOut,Laya.Handler.create(this,function(){a&&a()}))}static ScaleTo(e,t,i,a){if(e&&e.transform&&e.transform.localScale){var s=e.transform.localScale;Laya.Tween.to(e.transform.localScale,{x:i.x,y:i.y,z:i.z,update:new Laya.Handler(this,function(){e&&e.transform&&e.transform.localScale&&(e.transform.localScale=s)})},t,Laya.Ease.cubicOut,Laya.Handler.create(this,function(){a&&a()}))}}static tMove2D(e,t,i,a,s){Laya.Tween.to(e,{x:t,y:i},a,null,new Laya.Handler(this,()=>{s&&s()}))}static scaleTo2D(e,t,i,a){Laya.Tween.to(e,{scaleX:t,scaleY:t},i,null,new Laya.Handler(this,()=>{a&&a()}))}static alphaTo2D(e,t,i,a){Laya.Tween.to(e,{alpha:t},i,null,new Laya.Handler(this,()=>{a&&a()}))}static blinkLoop(e){this.alphaTo2D(e,0,200,()=>{this.alphaTo2D(e,1,200,()=>{this.blinkLoop(e)})})}static updateNumber(e,t,i,a=!0,s,n){let r=e*t,o=Math.floor((r-e)/60);o=o<=0?1:o;let h=()=>{s?((e+=o)>=r&&(e=r,n&&n(),Laya.timer.clear(this,h)),a?i.text=e.toString():i.value=e.toString()):((r-=o)<=e&&(r=e,n&&n(),Laya.timer.clear(this,h)),a?i.text=r.toString():i.value=r.toString())};Laya.timer.frameLoop(1,this,h)}static loadJson(e,t){Laya.loader.load(e,Laya.Handler.create(this,t),null,Laya.Loader.JSON)}static objectShake(e,t=1,i=.7){var a=t,s=1,n=e.transform.localPosition.clone();Laya.timer.frameLoop(1,this,function updateShake(){if(a>0){var t=new Laya.Vector3;Laya.Vector3.scale((r=Math.random()>.5?Math.random():-Math.random(),o=Math.random()>.5?Math.random():-Math.random(),new Laya.Vector3(r,o,0)),i,t),Laya.Vector3.add(n,t,t),e.transform.localPosition=t,a-=.02*s}else a=0,e.transform.localPosition=n,Laya.timer.clear(this,updateShake);var r,o})}static getRandomItemInArr(e){return e[Math.floor(Math.random()*e.length)]}static shuffleArr(e){let t=e.length;for(;t;){let i=Math.floor(Math.random()*t--);[e[i],e[t]]=[e[t],e[i]]}return e}static GetRandom(e,t,i=!0){let a=t-e,s=Math.random()*(a+1);return s+=e,i?Math.floor(s):s}static coinCollectAnim(e,t,i,a=10,s){let n=a;for(var r=0;r<a;r++){let a=Laya.Pool.getItemByClass("coin",Laya.Image);a.skin="startUI/zy_zs_1.png",a.x=e.x,a.y=e.y,i.addChild(a);let r=300+100*Math.random()-50;Laya.Tween.to(a,{x:a.x+250*Math.random()-125,y:a.y+250*Math.random()-125},r),Laya.timer.once(r+50,this,function(){Laya.Tween.to(a,{x:t.x,y:t.y},400,null,new Laya.Handler(this,function(){i.removeChild(a),Laya.Pool.recover("coin",a),0==--n&&s&&s()}))})}}static scaleLoop(e,t,i){Laya.Tween.to(e,{scaleX:t,scaleY:t},i,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{scaleX:1,scaleY:1},i,null,new Laya.Handler(this,()=>{this.scaleLoop(e,t,i)}))}))}static rotateLoop(e,t,i){Laya.Tween.to(e,{rotation:t},i,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{rotation:-t},2*i,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{rotation:0},i,null,new Laya.Handler(this,()=>{this.rotateLoop(e,t,i)}))}))}))}static visibleDelay(e,t){e.visible=!1,Laya.timer.once(t,this,()=>{e.visible=!0})}static pointInPolygon(e,t){for(var i=e.x,a=e.y,s=!1,n=0,r=t.length-1;n<t.length;r=n++){var o=t[n].x,h=t[n].y,l=t[r].x,d=t[r].y;h>a!=d>a&&i<(l-o)*(a-h)/(d-h)+o&&(s=!s)}return s}static getSprite3DResByUrl(e,t,i=!1){let s=Laya.loader.getRes(a.UnityPath+e);return Laya.Sprite3D.instantiate(s,t,i,new Laya.Vector3(0,0,0))}static getRandomItemInArrWithoutSelf(e,t,i=1){let a=[].concat(t);return a.splice(a.indexOf(e),1),(a=this.shuffleArr(a)).slice(0,i)}static getBoundBox(e,t=!1){let i=e.getComponent(Laya.PhysicsCollider).colliderShape,a=e.transform.position.clone();a.x+=i.localOffset.x,a.y+=i.localOffset.y,a.z+=i.localOffset.z;let s=e.parent,n=1;s&&s.transform&&t&&(n=s.transform.localScaleZ);let r=new Laya.Vector3(a.x-i.sizeX/2,a.y-i.sizeY/2,a.z-i.sizeZ/2),o=new Laya.Vector3(a.x+i.sizeX/2,a.y+i.sizeY/2,a.z+i.sizeZ*n/2/2);return new Laya.BoundBox(r,o)}static getBoundBoxWithMinMax(e,t){return new Laya.BoundBox(e,t)}static addClickEvent(e,t,i,a,n){if(e.offAllCaller(t),e instanceof Laya.Button&&!n){let s=e=>{i&&i.call(t,e)};e.on(Laya.Event.CLICK,t,s,[a])}else{let n=60,r=1,o=e.scaleX*r,h=e.scaleY*r,l=.9*r,d=!1,c=t=>{d=!0,s.instance.playSoundEffect("Click"),Laya.Tween.to(e,{scaleX:l,scaleY:l},n)};e.on(Laya.Event.MOUSE_DOWN,t,c,[a]);let y=a=>{0!=d&&(d=!1,Laya.Tween.to(e,{scaleX:o,scaleY:h},n,null,new Laya.Handler(t,()=>{i&&i.call(t,a)})))};e.on(Laya.Event.MOUSE_UP,t,y,[a]);let m=t=>{Laya.Tween.to(e,{scaleX:o,scaleY:h},n)};e.on(Laya.Event.MOUSE_OUT,t,m,[a])}}static getVector3(e,t,i){return new Laya.Vector3(Number(e),Number(t),Number(i))}static BezierPoints(e,t,i,a=60){let s=[],n=e.z,r=e.y,o=t.z,h=t.y,l=i.z,d=i.y;for(let e=0;e<=a;e++){let t=e/a;var c=(1-t)*(1-t)*n+2*t*(1-t)*o+t*t*l,y=(1-t)*(1-t)*r+2*t*(1-t)*h+t*t*d;s.push(new Laya.Vector3(0,2*y,c))}return s}static upDownTween(e,t,i){this.TmoveToY(e,1200,i,()=>{e.active&&this.TmoveToY(e,1200,t,()=>{e.active&&this.upDownTween(e,t,i)},Laya.Ease.sineInOut)},Laya.Ease.sineInOut)}}class r extends Laya.Script{constructor(){super(),this.isZooming=!1}onAwake(){this.myOwner=this.owner}onDisable(){}gameStart(){let e=this.myOwner.transform.position.clone();e.x-=4,e.y-=1,e.z+=4;let t=e.clone();t.z+=13,n.TmoveTo(this.myOwner,500,e,()=>{n.TmoveTo(this.myOwner,5500,t,()=>{})});let i=this.myOwner.transform.rotationEuler.clone();i.x-=20,i.y+=25,n.RotateTo(this.myOwner,500,i,null)}zoomSkillTarget(e){if(this.isZooming)return;this.isZooming=!0;let t=this.myOwner.transform.position.clone(),i=this.myOwner.transform.rotationEuler.clone();this.myOwner.transform.lookAt(e.transform.position.clone(),new Laya.Vector3(0,1,0),!1);let a=n.getDirectionAToB(this.myOwner,e);Laya.Vector3.scale(a,2,a),Laya.Vector3.add(t,a,a),n.TmoveTo(this.myOwner,800,a,null),Laya.timer.once(2e3,this,()=>{n.TmoveTo(this.myOwner,500,t,()=>{this.isZooming=!1}),this.myOwner.transform.rotationEuler=i})}onUpdate(){!f.Share.isGameOver&&f.Share.isStartGame}}class o{static initConfigData(e){window.wxsdk.onLoginComplete(()=>{console.log("sdk:onLoginComplete")}),window.wxsdk.login(),window.wxsdk.onInit(()=>{console.log("sdk:onInit");let t=window.wxsdk.conf;this.data=new h;for(let e in this.data)null!=t[e]&&(this.data[e]=t[e]);if(this.data.channel_ditch&&!window.wxsdk.user.channel&&(this.data.allowMistouch=!1),!this.data.allowMistouch)for(let e in this.data)"boolean"==typeof this.data[e]&&(this.data[e]=!1);console.log("参数:",this.data),e&&e()}),window.wxsdk.init({version:this.version,appid:this.appid,secret:this.secret,share:{title:"你能过得了这一关吗？",image:"https://game-oss.smallshark.cn/game/20211119/1216327431258.jpg?imageslim"}})}static get canTrapAll(){return!!this.isWechat&&(this.data.allowMistouch&&this.allowScene&&this.version.split(".")[2]<=this.data.version.split(".")[2])}static get allowScene(){if(this.isWechat&&this.data.sceneList){let e=this._wx.getLaunchOptionsSync().scene.toString();return-1!=this.data.sceneList.split(",").indexOf(e)}return!0}}o.version="1.0.3",o.appid="272",o.secret="5i3ht31d0n4hwxccou5jpjcfyrrw310e",o.isPortrait=!0,o.isShowHomeBanner=!0,o.isShowShopBanner=!0,o.data=null,o._wx=Laya.Browser.window.wx,o.isWechat=Laya.Browser.onWeiXin;class h{constructor(){this.version="",this.allowMistouch=!1,this.channel_ditch=!1,this.sceneList="",this.front_banner_ids="",this.front_video_ids="",this.front_chaping_ids="",this.front_box_ids="",this.front_more_gezi_ids="",this.front_duilian_gezi_ids="",this.front_dangezi_ids="",this.front_duogezi_ids="",this.front_more_dangezi_ids="",this.front_pifu_picture="",this.front_small_remen_number=2,this.front_video_begin_level=1,this.front_tuijian_remen_number=2,this.front_box_dangezi_number=2,this.front_box_level=1,this.front_box_level_interval=1,this.front_game_remen_number=2,this.front_box_second_number=2,this.front_box_second_level=1,this.front_box_second_level_interval=1,this.front_video_jiesuanye_level=1,this.front_order_remen_number=2,this.front_more_gezi_time=3e4,this.front_more_gezi_refresh_num=5,this.front_box_dangezi_time=3e4,this.front_box_dangezi_refresh_num=5,this.front_gezi_time=800,this.remenBanner_count=1,this.refresh_banner_time=5,this.updateBanner=3,this.front_gezi_number=1,this.front_box_before_times=1,this.front_box_dangezi_times=1,this.front_box_second_times=1,this.front_video_before_switch=!1,this.front_small_remen_switch=!1,this.front_small_wuchu_switch=!1,this.front_box_before_switch=!1,this.front_side_switch=!1,this.front_more_haowan_switch=!1,this.front_video_begin_switch=!1,this.front_tuijian_remen_switch=!1,this.front_tuijian_wuchu_switch=!1,this.front_pifu_cancel_switch=!1,this.front_pifu_switch=!1,this.front_video_cancel_switch=!1,this.front_video_tanchuang_switch=!1,this.front_box_dangezi_switch=!1,this.front_game_banner_switch=!1,this.front_game_dangezi_switch=!1,this.front_game_remen_switch=!1,this.front_game_wuchu_switch=!1,this.front_chaping_remen_switch=!1,this.front_box_second_switch=!1,this.front_jiesuanye_duogezi_switch=!1,this.front_jiesuanye_dangezi_switch=!1,this.front_video_jiesuanye_switch=!1,this.front_order_remen_switch=!1,this.front_order_wuchu_switch=!1,this.front_chaping_home_switch=!1,this.front_leave_return_switch=!1}}class l{static inidAd(e){if(!Laya.Browser.onWeiXin)return void(e&&e());this.bannerIds=o.data.front_banner_ids.split(","),this.videoIds=o.data.front_video_ids.split(","),this.interstitialIds=o.data.front_chaping_ids.split(","),this.fullGridIds=o.data.front_more_gezi_ids.split(","),this.fullSingleGridIds=o.data.front_more_dangezi_ids.split(","),this.sideGridIds=o.data.front_duilian_gezi_ids.split(","),this.boxGridIds=o.data.front_box_ids.split(","),this.gameGridIds=o.data.front_dangezi_ids.split(","),this.finishGridIds=o.data.front_duogezi_ids.split(","),this.bannerIds=this.shuffleArr(this.bannerIds),this.videoIds=this.shuffleArr(this.videoIds),this.interstitialIds=this.shuffleArr(this.interstitialIds),this.fullGridIds=this.shuffleArr(this.fullGridIds),this.fullSingleGridIds=this.shuffleArr(this.fullSingleGridIds),this.sideGridIds=this.shuffleArr(this.sideGridIds),this.boxGridIds=this.shuffleArr(this.boxGridIds),this.gameGridIds=this.shuffleArr(this.gameGridIds),this.finishGridIds=this.shuffleArr(this.finishGridIds),this.initGridAD(),this.initBanner(),this.createVideoAd(),this.createInterstitialAd();let t=()=>{this.isFullGridAdLoaded&&(Laya.timer.clear(this,t),e&&e())};Laya.timer.loop(100,this,t)}static getSystemInfoSync(){if(Laya.Browser.onWeiXin)return this.sysInfo||(this.sysInfo=Laya.Browser.window.wx.getSystemInfoSync()),this.sysInfo}static initBanner(){if(Laya.Browser.onWeiXin){!o.canTrapAll&&this.bannerAds.length>1&&this.bannerAds.splice(0,this.bannerAds.length-1),this.bannerAds=[],this.bannerIndex=0,this.bannerTimesArr=[],this.bannerShowCount=[],this.bannerErrorArr=[];for(let e=0;e<this.bannerIds.length;e++)this.bannerTimesArr.push(0),this.bannerShowCount.push(0),this.bannerErrorArr.push(!1);for(let e=0;e<this.bannerIds.length;e++){let t=this.createBannerAd(e);this.bannerAds.push(t)}}}static get isAllBannerError(){let e=!0;for(let t=0;t<this.bannerErrorArr.length;t++)if(!this.bannerErrorArr[t]){e=!1;break}return e}static showBannerAd(){if(Laya.Browser.onWeiXin){if(this.isAllBannerError)return this.stopCountBannerTime(),void this.initBanner();for(let e=0;e<this.bannerErrorArr.length&&this.bannerErrorArr[this.bannerIndex];e++)this.bannerIndex++,this.bannerIndex>=this.bannerIds.length&&(this.bannerIndex=0);this.bannerAds[this.bannerIndex]&&this.bannerAds[this.bannerIndex].show(),this.stopCountBannerTime(),o.canTrapAll&&Laya.timer.loop(100,this,this.countBannerTime)}}static hideBannerAd(){Laya.Browser.onWeiXin&&(this.isAllBannerError?this.stopCountBannerTime():(this.bannerAds[this.bannerIndex]&&this.bannerAds[this.bannerIndex].hide(),this.stopCountBannerTime()))}static countBannerTime(){this.bannerTimesArr[this.bannerIndex]+=.1,this.bannerTimesArr[this.bannerIndex]>=o.data.refresh_banner_time&&(this.bannerAds[this.bannerIndex]&&this.bannerAds[this.bannerIndex].hide(),this.bannerTimesArr[this.bannerIndex]=0,this.bannerShowCount[this.bannerIndex]++,this.bannerShowCount[this.bannerIndex]>=o.data.updateBanner&&(this.bannerShowCount[this.bannerIndex]=0,this.bannerAds[this.bannerIndex]&&this.bannerAds[this.bannerIndex].destroy(),this.bannerAds[this.bannerIndex]=null,this.bannerAds[this.bannerIndex]=this.createBannerAd(this.bannerIndex)),this.bannerIndex++,this.bannerIndex>=this.bannerIds.length&&(this.bannerIndex=0),this.showBannerAd())}static stopCountBannerTime(){Laya.timer.clear(this,this.countBannerTime)}static createBannerAd(e){if(!Laya.Browser.onWeiXin)return;let t=this.getSystemInfoSync(),i=Laya.Browser.window.wx.createBannerAd({adUnitId:this.bannerIds[e],style:{top:.8*t.screenHeight,width:10,left:t.screenWidth/2-150},adIntervals:30});return i.onLoad(()=>{this.bannerErrorArr[e]=!1,console.log("Banner广告加载成功")}),i.onError(t=>{this.bannerErrorArr[e]=!0,console.error("Banner广告加载失败",JSON.stringify(t))}),i.onResize(e=>{let a=i.style.realHeight+.1;i.style.top=t.screenHeight-a}),i}static createVideoAd(e=!1){if(Laya.Browser.onWeiXin){var t,i=this;null!=(t=this.videoAd)&&(t.offLoad(onLoadVideo),t.offError(onErrorVideo),t.offClose(onCloseVideo)),(t=Laya.Browser.window.wx.createRewardedVideoAd({adUnitId:i.videoIds[0]})).onLoad(onLoadVideo),t.onError(onErrorVideo),t.onClose(onCloseVideo),this.videoAd=t}function onLoadVideo(){console.log("video 加载成功"),i.isExistVideoAd=!0,e&&t.show()}function onErrorVideo(e){console.error("video 加载错误",e),i.isExistVideoAd=!1}function onCloseVideo(e){!!(e&&e.isEnded||void 0===e)?(i.videoFinishCallback&&i.videoFinishCallback(),i.videoFinishCallback=null):(i.videoCancelCallback&&i.videoCancelCallback(),i.videoCancelCallback=null),i.videoCompleteCallback&&i.videoCompleteCallback(),i.videoCompleteCallback=null}}static showVideoAd(e,t,i,a=!1){if(!Laya.Browser.onWeiXin)return e&&e(),t&&t(),void(i&&i());if(!Laya.Browser.onWeiXin)return;let s=this;if(this.videoFinishCallback=e,this.videoCancelCallback=t,this.videoCompleteCallback=i,this.isExistVideoAd||this.createVideoAd(),Laya.Browser.onWeiXin){var n=this.videoAd;n.show().then(()=>{}).catch(e=>{n.load().then(()=>n.show()).catch(e=>{s.videoCompleteCallback&&s.videoCompleteCallback(),s.videoCompleteCallback=null,!a&&this.videoFinishCallback&&Laya.Browser.window.wx.showToast({title:"暂无视频",duration:2e3}),a&&this.videoFinishCallback&&(this.videoFinishCallback&&this.videoFinishCallback(),this.videoFinishCallback=null,Laya.Browser.window.wx.showToast({title:"已获得奖励",duration:2e3}))})})}}static destroyVideoAd(){this.videoAd&&(this.videoAd.destroy(),this.videoAd=null)}static initGridAD(){Laya.Browser.onWeiXin&&(this.createFullGrid(),this.createFullSingleGrid(),this.createSideGrid(),this.createMidBoxGrid(),this.createFirstBoxGrid(),this.createSecondBoxGrid(),this.createGameGrid(),o.isPortrait&&this.createFinishGrid())}static createFullGrid(){if(!Laya.Browser.onWeiXin)return;let e=0,t=this.fullGridIds.length,i={};for(let a=0;a<t;a++){i=o.isPortrait?{left:0,top:this.getSystemInfoSync().screenHeight/2-this.getSystemInfoSync().screenWidth/2-50,width:this.getSystemInfoSync().screenWidth}:{left:this.getSystemInfoSync().screenWidth/2-300+300*Math.floor(a%2),top:30,width:10,height:10};let s=Laya.Browser.window.wx.createCustomAd({adUnitId:this.fullGridIds[a],adIntervals:o.data.front_more_gezi_time/1e3,style:i});s.onError(i=>{++e>=t&&(this.isFullGridAdLoaded=!0),console.log("全屏格子加载失败:",JSON.stringify(i))}),s.onLoad(()=>{++e>=t&&(this.isFullGridAdLoaded=!0),this.fullGridAd.push(s)})}}static visibleFullGridAd(e=!0){if(Laya.Browser.onWeiXin&&!(this.fullGridAd.length<=0))if(e){if(o.isPortrait)this.fullGridAd[this.fullGridCurIndex].show();else{let e=2*this.fullGridCurIndex;e>=this.fullGridAd.length&&(e=0,this.fullGridCurIndex=0),this.fullGridAd[e].show();let t=e+1;t<this.fullGridAd.length&&this.fullGridAd[t].show()}this.fullGridShowCount++,this.fullGridShowCount>=o.data.front_more_gezi_refresh_num&&(this.fullGridShowCount=0,this.fullGridCurIndex++,this.fullGridCurIndex>=this.fullGridAd.length&&(this.fullGridCurIndex=0))}else for(let t=0;t<this.fullGridAd.length;t++)e?this.fullGridAd[t].show():this.fullGridAd[t].hide()}static createSideGrid(){if(Laya.Browser.onWeiXin)for(let e=0;e<this.sideGridIds.length;e++){let t=e<this.sideGridIds.length?e:this.sideGridIds.length-1;if(this.sideGridAdL.length<=0){let e=Laya.Browser.window.wx.createCustomAd({adUnitId:this.sideGridIds[t],adIntervals:30,style:{left:0,top:this.getSystemInfoSync().screenHeight/2-220}});e.onError(e=>{console.log("屏幕侧格子加载失败:",JSON.stringify(e))}),e.onLoad(()=>{this.sideGridAdL.push(e)})}else if(this.sideGridAdR.length<=0){let e=Laya.Browser.window.wx.createCustomAd({adUnitId:this.sideGridIds[t],adIntervals:30,style:{left:this.getSystemInfoSync().screenWidth-65,top:this.getSystemInfoSync().screenHeight/2-220}});e.onError(e=>{console.log("屏幕侧格子加载失败:",JSON.stringify(e))}),e.onLoad(()=>{this.sideGridAdR.push(e)})}}}static visibleSideGridAd(e=!0){if(Laya.Browser.onWeiXin){for(let t=0;t<this.sideGridAdL.length;t++)e?this.sideGridAdL[t].show():this.sideGridAdL[t].hide();for(let t=0;t<this.sideGridAdR.length;t++)e?this.sideGridAdR[t].show():this.sideGridAdR[t].hide()}}static createFullSingleGrid(){if(Laya.Browser.onWeiXin)for(let e=0;e<2;e++){let t=e<this.fullSingleGridIds.length?e:this.fullSingleGridIds.length-1,i=Laya.Browser.window.wx.createCustomAd({adUnitId:this.fullSingleGridIds[t],adIntervals:30,style:{left:1==e?this.getSystemInfoSync().screenWidth/2-60:this.getSystemInfoSync().screenWidth/2,top:this.getSystemInfoSync().screenHeight-100}});i.onError(e=>{console.log("全屏单格子加载失败:",JSON.stringify(e))}),i.onLoad(()=>{this.fullSingleGridAd.push(i)})}}static visibleFullSingleGridAd(e=!0){if(Laya.Browser.onWeiXin)for(let t=0;t<this.fullSingleGridAd.length;t++)e?this.fullSingleGridAd[t].show():this.fullSingleGridAd[t].hide()}static createMidBoxGrid(){if(Laya.Browser.onWeiXin)for(let e=0;e<2;e++){let t=Laya.Browser.window.wx.createCustomAd({adUnitId:this.boxGridIds[e],adIntervals:o.data.front_box_dangezi_time/1e3,style:{left:1==e?this.getSystemInfoSync().screenWidth/2-60:this.getSystemInfoSync().screenWidth/2,top:this.getSystemInfoSync().screenHeight/2-65}});t.onError(e=>{console.log("格子宝箱单格子加载失败:",JSON.stringify(e))}),t.onLoad(()=>{this.midBoxGridAd.push(t)})}}static visibleMidBoxGridAd(e=!0){if(Laya.Browser.onWeiXin)for(let t=0;t<this.midBoxGridAd.length;t++)e?this.midBoxGridAd[t].show():this.midBoxGridAd[t].hide()}static createFirstBoxGrid(){if(Laya.Browser.onWeiXin)for(let e=0;e<2;e++){let t=Laya.Browser.window.wx.createCustomAd({adUnitId:this.boxGridIds[e+2],adIntervals:o.data.front_box_dangezi_time/1e3,style:{left:1==e?this.getSystemInfoSync().screenWidth/2-60:this.getSystemInfoSync().screenWidth/2,top:this.getSystemInfoSync().screenHeight-100}});t.onError(e=>{console.log("第一宝箱单格子加载失败:",JSON.stringify(e))}),t.onLoad(()=>{this.firstBoxGridAd.push(t)})}}static visibleFirstBoxGridAd(e=!0){if(Laya.Browser.onWeiXin)for(let t=0;t<this.firstBoxGridAd.length;t++)e?this.firstBoxGridAd[t].show():this.firstBoxGridAd[t].hide()}static createSecondBoxGrid(){if(Laya.Browser.onWeiXin)for(let e=0;e<2;e++){let t=Laya.Browser.window.wx.createCustomAd({adUnitId:this.boxGridIds[e+4],adIntervals:o.data.front_box_dangezi_time/1e3,style:{left:1==e?this.getSystemInfoSync().screenWidth/2-60:this.getSystemInfoSync().screenWidth/2,top:this.getSystemInfoSync().screenHeight-100}});t.onError(e=>{console.log("第二宝箱单格子加载失败:",JSON.stringify(e))}),t.onLoad(()=>{this.secondBoxGridAd.push(t)})}}static visibleSecondBoxGridAd(e=!0){if(Laya.Browser.onWeiXin)for(let t=0;t<this.secondBoxGridAd.length;t++)e?this.secondBoxGridAd[t].show():this.secondBoxGridAd[t].hide()}static createGameGrid(){if(Laya.Browser.onWeiXin)for(let e=0;e<2;e++){let t=e<this.gameGridIds.length?e:this.gameGridIds.length-1,i=Laya.Browser.window.wx.createCustomAd({adUnitId:this.gameGridIds[t],adIntervals:30,style:{left:0==e?0:this.getSystemInfoSync().screenWidth-70,top:.1*this.getSystemInfoSync().screenHeight}});i.onError(e=>{console.log("游戏中单格子加载失败:",JSON.stringify(e))}),i.onLoad(()=>{this.gameGridAd.push(i)})}}static visibleGameGridAd(e=!0){if(Laya.Browser.onWeiXin)for(let t=0;t<this.gameGridAd.length;t++)e?this.gameGridAd[t].show():this.gameGridAd[t].hide()}static createFinishGrid(){if(Laya.Browser.onWeiXin)for(let e=0;e<1;e++){let t=Laya.Browser.window.wx.createCustomAd({adUnitId:this.finishGridIds[e],adIntervals:30,style:{left:0,top:.25*this.getSystemInfoSync().screenHeight,width:this.getSystemInfoSync().screenWidth}});t.onError(e=>{console.log("结算页多格子加载失败:",JSON.stringify(e))}),t.onLoad(()=>{this.finishGridAd.push(t)})}}static visibleFinishGridAd(e=!0){if(Laya.Browser.onWeiXin)for(let t=0;t<this.finishGridAd.length;t++)e?this.finishGridAd[t].show():this.finishGridAd[t].hide()}static createInterstitialAd(){Laya.Browser.onWeiXin&&(this.intersititialAd&&(this.intersititialAd.offError(),this.intersititialAd.offLoad(),this.intersititialAd.offClose(),this.intersititialAd.destroy(),this.intersititialAd=null),this.intersititialAd=Laya.Browser.window.wx.createInterstitialAd({adUnitId:this.interstitialIds[0]}),this.intersititialAd.onError(e=>{this.intersititialError=!0,console.log("插屏广告加载失败:",JSON.stringify(e))}),this.intersititialAd.onLoad(()=>{this.intersititialError=!1}),this.intersititialAd.onClose(()=>{this.intersititialCB&&this.intersititialCB()}),this.intersititialAd.load())}static showInterstitialAd(e){if(!Laya.Browser.onWeiXin||!this.intersititialAd||this.intersititialError)return this.intersititialError&&this.createInterstitialAd(),void(e&&e());this.intersititialCB=e,this.intersititialAd.show().then(()=>{}).catch(e=>{this.intersititialCB&&this.intersititialCB()})}static shuffleArr(e){let t=e.length;for(;t;){let i=Math.floor(Math.random()*t--);[e[i],e[t]]=[e[t],e[i]]}return e}}l.bannerIds=[],l.videoIds=[],l.interstitialIds=[],l.fullGridIds=[],l.fullSingleGridIds=[],l.sideGridIds=[],l.boxGridIds=[],l.gameGridIds=[],l.finishGridIds=[],l.bannerAds=[],l.bannerIndex=0,l.bannerTimesArr=[],l.bannerShowCount=[],l.bannerErrorArr=[],l.isExistVideoAd=!1,l.fullGridAd=[],l.fullGridError=!1,l.fullGridShowCount=0,l.fullGridCurIndex=0,l.isFullGridAdLoaded=!1,l.sideGridAdL=[],l.sideGridAdR=[],l.fullSingleGridAd=[],l.midBoxGridAd=[],l.firstBoxGridAd=[],l.secondBoxGridAd=[],l.gameGridAd=[],l.finishGridAd=[],l.intersititialAd=null,l.intersititialCB=null,l.intersititialError=!1;class d{static init(e){Laya.Browser.onWeiXin?o.initConfigData(()=>{l.inidAd(e),o.data.front_leave_return_switch&&Laya.Browser.window.wx.onShow(()=>{l.showInterstitialAd()})}):e&&e()}static showLoading(e){Laya.Browser.onWeiXin?o.data.front_video_before_switch?l.showVideoAd(null,null,()=>{this.showRemen(0,()=>{this.showBoxMiddle(e)})}):this.showRemen(0,()=>{this.showBoxMiddle(e)}):e&&e()}static inHome(){Laya.Browser.onWeiXin&&(o.isShowHomeBanner&&l.showBannerAd(),o.data.front_side_switch&&l.visibleSideGridAd(!0),this.visibleHomeUI(!0))}static inShop(){Laya.Browser.onWeiXin&&(o.isShowShopBanner||l.hideBannerAd(),l.visibleSideGridAd(!1),this.visibleHomeUI(!1))}static moreGame(){l.hideBannerAd(),l.visibleSideGridAd(!1),this.showRemen(1,()=>{o.isShowHomeBanner&&l.showBannerAd(),o.data.front_side_switch&&l.visibleSideGridAd(!0)},!0)}static startGame(e){Laya.Browser.onWeiXin?(l.hideBannerAd(),l.visibleSideGridAd(!1),this.visibleHomeUI(!1),o.data.front_video_begin_switch&&this.gameCount>=o.data.front_video_begin_level?l.showVideoAd(null,null,()=>{this.showRemen(1,()=>{this.showSkin(()=>{this.showBoxBottom(0,e)})})}):this.showRemen(1,()=>{this.showSkin(()=>{this.showBoxBottom(0,e)})})):e&&e()}static inGame(){Laya.Browser.onWeiXin&&(o.data.front_game_banner_switch?l.showBannerAd():l.hideBannerAd(),o.data.front_game_dangezi_switch&&l.visibleGameGridAd(!0))}static gameOver(e){Laya.Browser.onWeiXin?(l.hideBannerAd(),l.visibleGameGridAd(!1),o.data.front_chaping_remen_switch&&l.showInterstitialAd(),this.showRemen(2,()=>{this.showBoxBottom(1,e)})):e&&e()}static inFinish(){Laya.Browser.onWeiXin&&(l.showBannerAd(),o.isPortrait&&o.data.front_jiesuanye_duogezi_switch&&l.visibleFinishGridAd(!0),o.data.front_jiesuanye_dangezi_switch&&l.visibleGameGridAd(!0))}static backToHome(e){Laya.Browser.onWeiXin?(l.hideBannerAd(),l.visibleFinishGridAd(!1),l.visibleGameGridAd(!1),o.data.front_video_jiesuanye_switch&&this.gameCount>=o.data.front_video_jiesuanye_level?l.showVideoAd(null,null,()=>{this.showRemen(3,()=>{e&&e(),o.data.front_chaping_home_switch&&Laya.timer.once(500,this,()=>{l.showInterstitialAd()}),this.gameCount++})}):this.showRemen(3,()=>{e&&e(),o.data.front_chaping_home_switch&&Laya.timer.once(500,this,()=>{l.showInterstitialAd()}),this.gameCount++})):e&&e()}static showRemen(e,t,i=!1){let a=!1;switch(e){case y.RM_rmxyx:a=o.data.front_small_remen_switch;break;case y.RM_rmtj:a=o.data.front_tuijian_remen_switch;break;case y.RM_rmyx:a=o.data.front_game_remen_switch;break;case y.RM_rmxcx:a=o.data.front_order_remen_switch}a||i?Laya.Scene.open(c.SGRemen,!1,{ccb:t,index:e}):t&&t()}static showBoxMiddle(e){o.data.front_box_before_switch?Laya.Scene.open(c.SGBoxMiddle,!1,{ccb:e}):e&&e()}static showBoxBottom(e,t){let i=!1,a=!1;switch(e){case 0:i=o.data.front_box_dangezi_switch,a=o.data.front_box_level_interval<=0?this.gameCount>=o.data.front_box_level:this.gameCount>=o.data.front_box_level&&0==Math.floor((this.gameCount-o.data.front_box_level)%(o.data.front_box_level_interval+1)),i=i&&a;break;case 1:i=o.data.front_box_second_switch,a=o.data.front_box_second_level_interval<=0?this.gameCount>=o.data.front_box_second_level:this.gameCount>=o.data.front_box_second_level&&0==Math.floor((this.gameCount-o.data.front_box_second_level)%(o.data.front_box_second_level_interval+1)),i=i&&a}i?Laya.Scene.open(c.SGBoxBottom,!1,{ccb:t}):t&&t()}static showSkin(e){o.data.front_pifu_switch?Laya.Scene.open(c.SGSkin,!1,{ccb:e}):e&&e()}static visibleHomeUI(e=!0){e?Laya.Scene.open(c.SGHomeUI,!1):Laya.Scene.close(c.SGHomeUI)}}var c,y,m;d.gameCount=1,function(e){e.SGRemen="SGScene/SGRemen.scene",e.SGBoxBottom="SGScene/SGBoxBottom.scene",e.SGBoxMiddle="SGScene/SGBoxMiddle.scene",e.SGHomeUI="SGScene/SGHomeUI.scene",e.SGSkin="SGScene/SGSkin.scene"}(c||(c={})),function(e){e[e.RM_rmxyx=0]="RM_rmxyx",e[e.RM_rmtj=1]="RM_rmtj",e[e.RM_rmyx=2]="RM_rmyx",e[e.RM_rmxcx=3]="RM_rmxcx"}(y||(y={}));class w{static getFXByName(e,t){let i=f.Share._effectNode.getChildByName(e);return Laya.Sprite3D.instantiate(i,t,!1,new Laya.Vector3)}static createWaterSpray(e){let t=this.getFXByName("FX_Water_Spray",f.Share._levelNode);t.transform.position=e,Laya.timer.once(1e3,this,()=>{t&&!t.destroyed&&t.destroy()})}static createWindTurn(e){let t=this.getFXByName("FX_Wind_Turn",f.Share._levelNode);t.transform.position=e,Laya.timer.once(4e3,this,()=>{t&&!t.destroyed&&t.destroy()}),t.getChildAt(0).getChildAt(0).meshRenderer.receiveShadow=!1}static createSmoke(e){let t=this.getFXByName("FX_Smoke_1",f.Share._levelNode);t.transform.position=e,Laya.timer.once(2e3,this,()=>{t&&!t.destroyed&&t.destroy()})}static createHurt1(e){let t=this.getFXByName("FX_TakeDamage_1",f.Share._levelNode);t.transform.position=e,Laya.timer.once(1e3,this,()=>{t&&!t.destroyed&&t.destroy()})}static createHurt2(e){let t=this.getFXByName("FX_TakeDamage_2",f.Share._levelNode);t.transform.position=e,Laya.timer.once(1e3,this,()=>{t&&!t.destroyed&&t.destroy()})}static createHurt3(e){let t=this.getFXByName("FX_TakeDamage_3",f.Share._levelNode);t.transform.position=e,Laya.timer.once(1e3,this,()=>{t&&!t.destroyed&&t.destroy()})}static createFlyCast(e){let t=e.transform.position.clone();t.y+=1;let i=this.getFXByName("FX_FlyCast_1",e);i.transform.position=t,Laya.timer.once(3e3,this,()=>{i&&!i.destroyed&&i.destroy()});let a=this.getFXByName("FX_FlyCast_2",e);a.transform.position=t,Laya.timer.once(2500,this,()=>{n.ScaleTo(i,200,new Laya.Vector3(0,0,0),()=>{i&&!i.destroyed&&i.destroy()}),n.ScaleTo(a,200,new Laya.Vector3(0,0,0),()=>{a&&!a.destroyed&&a.destroy()})})}static createFlyCast3(e){let t=e.transform.position.clone();t.y+=.05;let i=this.getFXByName("FX_FlyCast_3",f.Share._levelNode);i.transform.position=t,Laya.timer.once(3e3,this,()=>{i&&!i.destroyed&&i.destroy()})}static createAttack1(e,t,i){let a=this.getFXByName("FX_Attack_1",f.Share._levelNode);a.transform.position=e,n.TmoveTo(a,500,t,()=>{a.destroy(),i&&i()})}static createAttack2(e,t,i){let a=this.getFXByName("FX_Attack_2",f.Share._levelNode);a.transform.position=e,n.TmoveTo(a.getChildAt(0),500,t,()=>{a.destroy(),i&&i()})}static createFlyCastBullet(e,t,i){let a=this.getFXByName("FX_Fire_1",f.Share._levelNode);a.transform.position=e,n.TmoveTo(a,500,t,()=>{a.destroy(),i&&i()})}static createSkillHurt(e){let t=this.getFXByName("FX_TakeDamage_4",f.Share._levelNode);t.transform.position=e,Laya.timer.once(1e3,this,()=>{t&&!t.destroyed&&t.destroy()})}static createFireWork(){this.getFXByName("FX_FireWork",f.Share._levelNode).transform.position=new Laya.Vector3(0,4,15)}}class u extends Laya.Script{constructor(){super(),this.pointArr=[],this.curIndex=0}onAwake(){this.myOwnwer=this.owner}init(e){this.pointArr=e,this.move()}move(){n.TmoveTo(this.myOwnwer,20,this.pointArr[this.curIndex],()=>{if(this.curIndex++,this.curIndex>=this.pointArr.length)return this.rotateLoop(),w.createWaterSpray(this.myOwnwer.transform.position),void s.instance.playSoundEffect("water");this.move()})}rotateLoop(){Laya.timer.frameLoop(1,this,()=>{let e=n.RotateWithPoint(this.myOwnwer,new Laya.Vector3(0,-1,0),2);this.myOwnwer.transform.position=e.clone()})}onUpdate(){}}!function(e){e.ANI_IDLE="Idle",e.ANI_RUN="Run",e.ANI_ATTACK="Attack",e.ANI_DEATH="Death",e.ANI_FLYCAST="FlyCast",e.ANI_TAKEDAMEGE="TakeDamage"}(m||(m={}));class g extends Laya.Script{constructor(){super(),this.ani=null,this.target=null,this.armNodeL=null,this.armNodeR=null,this.itemData=null,this.hp=1e3,this.hpMax=1e3,this.moveSpeed=.04,this.curAni=m.ANI_IDLE,this.isAttacking=!1,this.isSkilling=!1,this.isMoveing=!0,this.isNear=!0,this.isPlayer=!0,this.isDied=!1}onAwake(){this.myOwner=this.owner,this.ani=this.myOwner.getComponent(Laya.Animator),this.ani.getControllerLayer().getAnimatorState(m.ANI_ATTACK).clip.islooping=!1,this.armNodeL=n.findNodeByName(this.myOwner,"ArmNodeL"),this.armNodeR=n.findNodeByName(this.myOwner,"ArmNodeR"),this.armNodeL.getChildAt(0).getComponent(Laya.Animator).getControllerLayer().getAnimatorState("Attack").clip.islooping=!1,this.armNodeR.getChildAt(0).getComponent(Laya.Animator).getControllerLayer().getAnimatorState("Attack").clip.islooping=!1}playAni(e,t=1){if(e==this.curAni&&e!=m.ANI_ATTACK)return;Laya.timer.clear(this,this.attackComplete),Laya.timer.clear(this,this.shootBullet),this.armNodeL.getChildAt(0).getComponent(Laya.Animator).play("Idle",0,0),this.armNodeR.getChildAt(0).getComponent(Laya.Animator).play("Idle",0,0),e!=m.ANI_ATTACK&&(this.isAttacking=!1),e!=m.ANI_FLYCAST&&(this.isSkilling=!1),e!=m.ANI_RUN&&(this.isMoveing=!1),this.curAni=e,this.ani.speed=t,this.ani.crossFade(e,.02,0,0)}init(e,t){this.itemData=t,this.isPlayer=e,this.isNear=i.getIsNearByHandId(t.handId);let a=i.getHpByType(t.type);this.hp=e?1.5*a:a,this.hpMax=e?1.5*a:a,Laya.timer.once(e?1e3:6e3,this,()=>{this.chooseTarget(),e||this.monsterAutoSkill()})}chooseTarget(){if(this.isPlayer){let e=[];for(let t=0;t<f.Share._enemyNode.numChildren;t++){let i=f.Share._enemyNode.getChildAt(t);i.getComponent(g).isDied?e.push(999):e.push(n.getWorldDis(i,this.myOwner))}let t=!1;for(let i=0;i<e.length;i++)if(999!=e[i]){t=!0;break}if(!t)return void(this.target=null);let i=[].concat(e);i.sort((e,t)=>e-t);let a=e.indexOf(i[0]);this.target=f.Share._enemyNode.getChildAt(a)}else{let e=[];for(let t=0;t<f.Share._playerNode.numChildren;t++){let i=f.Share._playerNode.getChildAt(t);i.getComponent(g).isDied?e.push(999):e.push(n.getWorldDis(i,this.myOwner))}let t=!1;for(let i=0;i<e.length;i++)if(999!=e[i]){t=!0;break}if(!t)return void(this.target=null);let i=[].concat(e);i.sort((e,t)=>e-t);let a=e.indexOf(i[0]);this.target=f.Share._playerNode.getChildAt(a)}}moveToTarget(){if(!this.target||f.Share.isGameOver||!f.Share.isStartGame||this.isSkilling||this.isAttacking||this.isDied)return;if(this.target.getComponent(g).isDied)return void this.chooseTarget();let e=this.myOwner.transform.position.clone(),t=this.target.transform.position.clone();if(e.y=0,t.y=0,Laya.Vector3.distance(e,t)>(this.isNear?2:3)){let i=new Laya.Vector3(0,0,0);Laya.Vector3.subtract(t,e,i),Laya.Vector3.normalize(i,i),Laya.Vector3.scale(i,this.moveSpeed,i);let a=this.myOwner.transform.position.clone();Laya.Vector3.add(a,i,a),this.myOwner.transform.position=a,this.isMoveing=!0,this.playAni(m.ANI_RUN)}else this.isMoveing=!1,this.attack()}attack(){if(this.target&&!f.Share.isGameOver&&f.Share.isStartGame&&!this.isSkilling&&!this.isAttacking&&!this.isDied)if(this.isAttacking=!0,this.isNear){this.playAni(m.ANI_ATTACK);let e=this.ani.getControllerLayer().getAnimatorState(m.ANI_ATTACK).clip.duration();Laya.timer.once(1e3*e,this,()=>{this.isAttacking=!1}),Laya.timer.once(i.getAttackEventTime(this.itemData.bodyId),this,this.attackComplete)}else{this.isPlayer&&s.instance.playSoundEffect("shoot"),this.playAni(m.ANI_IDLE),this.armNodeL.getChildAt(0).getComponent(Laya.Animator).play("Attack",0,0),this.armNodeR.getChildAt(0).getComponent(Laya.Animator).play("Attack",0,0),Laya.timer.once(500,this,this.shootBullet),Laya.timer.once(1e3,this,()=>{this.isAttacking=!1})}}attackComplete(){if(!this.target)return;this.target.getComponent(g).decHp(i.getDamageByType(this.itemData.type))}shootBullet(){if(!this.target||f.Share.isGameOver||!f.Share.isStartGame||this.isSkilling)return;let e=n.findNodeByName(this.armNodeL,"Pos").transform.position.clone(),t=n.findNodeByName(this.armNodeR,"Pos").transform.position.clone(),a=this.target.transform.position.clone();a.y+=1,6==this.itemData.handId?(w.createAttack2(e,a,()=>{if(!this.target)return;this.target.getComponent(g).decHp(i.getDamageByType(this.itemData.type)/3,2)}),w.createAttack2(t,a,()=>{if(!this.target)return;this.target.getComponent(g).decHp(i.getDamageByType(this.itemData.type)/3,2)})):(w.createAttack1(e,a,()=>{if(!this.target)return;this.target.getComponent(g).decHp(i.getDamageByType(this.itemData.type)/3,1)}),w.createAttack1(t,a,()=>{if(!this.target)return;this.target.getComponent(g).decHp(i.getDamageByType(this.itemData.type)/3,1)}))}skill(){if(!this.target||f.Share.isGameOver||!f.Share.isStartGame||this.isSkilling||this.isDied)return;w.createFlyCast(this.myOwner),this.isPlayer&&s.instance.playSoundEffect("flyCast"),this.isSkilling=!0,this.playAni(m.ANI_FLYCAST);let e=this.myOwner.transform.position.clone(),t=e.clone();e.y+=1.5,n.TmoveTo(this.myOwner,800,e,()=>{Laya.timer.once(1200,this,()=>{n.TmoveTo(this.myOwner,300,t,()=>{w.createFlyCast3(this.myOwner),this.isSkilling=!1;let e=this.isPlayer?f.Share._enemyNode:f.Share._playerNode;for(let t=0;t<e.numChildren;t++){let a=e.getChildAt(t),s=a.getComponent(g);if(s.isDied)continue;let n=a.transform.position.clone();n.y+=1;let r=this.myOwner.transform.position.clone();r.y+=1,w.createFlyCastBullet(r,n,()=>{s.decHp(2*i.getDamageByType(s.itemData.type),4)})}})})},Laya.Ease.linearIn),this.isPlayer&&f.Share._cameraCrl.zoomSkillTarget(this.myOwner)}monsterAutoSkill(){Laya.timer.once(5e3*Math.random()+7e3,this,()=>{this.skill(),this.monsterAutoSkill()})}decHp(e,t=3){if(this.isDied)return;let i=this.myOwner.transform.position.clone();if(1==t?(i.y+=1,w.createHurt1(i),s.instance.playSoundEffect("waterHit")):2==t?(i.y+=1,w.createHurt2(i),s.instance.playSoundEffect("coin")):3==t?(i.y+=1,w.createHurt3(i),s.instance.playSoundEffect("hit")):4==t&&(i.y+=1,w.createSkillHurt(i),s.instance.playSoundEffect("fire")),this.hp-=this.isPlayer?e/2:e,this.hp<0){if(this.hp=0,this.isSkilling)return;this.isDied=!0,Laya.timer.clearAll(this),this.playAni(m.ANI_DEATH)}}onUpdate(){if(this.moveToTarget(),this.target){let e=this.target.transform.position.clone();e.y=0,this.myOwner.transform.lookAt(e,new Laya.Vector3(0,1,0),!1),this.myOwner.transform.rotate(new Laya.Vector3(0,180,0),!1,!1)}}}class f{constructor(){this.camStartPos=new Laya.Vector3(0,0,0),this.camStartRotation=null,this._cameraCrl=null,this.startCamField=60,this.isStartGame=!1,this.isGameOver=!1,this.isWin=!1,this.isPause=!1,this.isFinish=!1,this._levelNode=null,this._tempItemNode=null,this._playerNode=null,this._enemyNode=null,this._effectNode=null,Laya.Browser.onWeiXin||localStorage.clear(),f.Share=this,i.getPlayerData(),Laya.Browser.onWeiXin&&(Laya.Browser.window.wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),Laya.Browser.window.wx.onShareAppMessage(()=>({title:"融合怪物",imageUrl:""}))),Laya.Scene.open("MyScenes/LoadingUI.scene")}initScene(){Laya.Scene3D.load(a.UnityPath+"SampleScene.ls",Laya.Handler.create(this,this.onLoadScene))}onLoadScene(e){Laya.Scene.open("MyScenes/StartUI.scene"),this._scene=Laya.stage.addChild(e),Laya.stage.setChildIndex(this._scene,0),this._camera=this._scene.getChildByName("Main Camera"),this._light=this._scene.getChildByName("Directional Light"),this._light.shadowMode=Laya.ShadowMode.SoftHigh,this._light.shadowDistance=20,this._light.shadowResolution=1024,this._light.shadowCascadesMode=Laya.ShadowCascadesMode.NoCascades,this._light.shadowNormalBias=0,this._light.transform.rotate(new Laya.Vector3(0,-40,0),!1,!1),this.camStartPos=this._camera.transform.position.clone(),this.camStartRotation=this._camera.transform.rotation.clone(),this._camera.fieldOfView=this.startCamField,this._cameraCrl=this._camera.addComponent(r),this._levelNode=this._scene.addChild(new Laya.Sprite3D),this.createLevel()}gameStart(){s.instance.stopMusic(),s.instance.playSoundEffect("warning"),this.isStartGame=!0,this._scene.getChildByName("Scene_Ground1").active=!1,this._scene.getChildByName("Scene_Ground2").active=!0,this._scene.getChildByName("Scene_1").active=!0,this._scene.getChildByName("Object_01").active=!1,this._scene.getChildByName("Back_01").active=!1,this._scene.getChildByName("Chashka_01").active=!1,this._tempItemNode.destroyChildren(),this.createMyMonster(),this.createEnemyMonster(),Laya.Scene.open("MyScenes/GameUI.scene"),this._cameraCrl.gameStart(),Laya.timer.frameLoop(1,this,this.checkGameOver),this._scene.getChildByName("Object_01").transform.position=new Laya.Vector3(0,0,0)}createLevel(){this._effectNode=n.getSprite3DResByUrl("EffectNode.lh",this._levelNode),this._effectNode.active=!1,this._tempItemNode=this._levelNode.addChild(new Laya.Sprite3D),this._playerNode=this._levelNode.addChild(new Laya.Sprite3D),this._enemyNode=this._levelNode.addChild(new Laya.Sprite3D),this._scene.getChildByName("Scene_Ground1").active=!0,this._scene.getChildByName("Scene_Ground2").active=!1,this._scene.getChildByName("Scene_1").active=!1,this._scene.getChildByName("Object_01").active=!1;for(let e=0;e<this._scene.getChildByName("Object_01").numChildren;e++){let t=this._scene.getChildByName("Object_01").getChildAt(e);t.meshRenderer&&(t.meshRenderer.receiveShadow=!1)}this._scene.getChildByName("Back_01").active=!0,this._scene.getChildByName("Chashka_01").active=!0,this._scene.getChildByName("Chashka_01").meshRenderer.receiveShadow=!1,this._scene.getChildByName("Chashka_01").getChildAt(0).meshRenderer.receiveShadow=!1,Laya.timer.frameLoop(1,this,()=>{this._scene.getChildByName("Chashka_01").getChildAt(0).transform.rotate(new Laya.Vector3(0,-2,0),!0,!1)})}createMonster(e,t,i){let a="Body_"+(e+1)+".lh",s="Hand_"+(t+1)+"_L.lh",r="Hand_"+(i+1)+"_L.lh",o=n.getSprite3DResByUrl(a,this._levelNode,!1);o.transform.position=new Laya.Vector3(0,3,0);let h=n.findNodeByName(o,"ArmNodeL"),l=n.getSprite3DResByUrl(s,h,!1);l.transform.localScale=new Laya.Vector3(1,1,1),l.transform.position=h.transform.position.clone(),l.transform.rotationEuler=h.transform.rotationEuler.clone();let d=n.findNodeByName(o,"ArmNodeR"),c=n.getSprite3DResByUrl(s,d,!1);if(c.transform.localScale=new Laya.Vector3(-1,1,1),c.transform.position=d.transform.position.clone(),c.transform.rotationEuler=d.transform.rotationEuler.clone(),5==i){let e=n.findNodeByName(o,"WingL"),t=n.getSprite3DResByUrl(r,e,!1);t.transform.setWorldLossyScale(new Laya.Vector3(1,1,1)),t.transform.position=e.transform.position.clone(),t.transform.rotationEuler=e.transform.rotationEuler.clone();let i=n.findNodeByName(o,"WingR"),a=n.getSprite3DResByUrl(r,i,!1);a.transform.setWorldLossyScale(new Laya.Vector3(-1,1,1)),a.transform.position=i.transform.position.clone(),a.transform.rotationEuler=i.transform.rotationEuler.clone()}else{let e=n.findNodeByName(o,"Back"),t=n.getSprite3DResByUrl(r,e,!1);t.transform.setWorldLossyScale(new Laya.Vector3(1,1,1));let i=e.transform.position.clone();t.transform.position=i,t.transform.rotationEuler=e.transform.rotationEuler.clone()}return o}createUIBody(e){let t="Body_"+(e+1)+".lh",i=n.getSprite3DResByUrl(t,this._tempItemNode,!1);i.transform.position=new Laya.Vector3(0,0,-5);let a=new Laya.Vector3(0,.4,1*Math.random()+.5),s=n.BezierPoints(new Laya.Vector3(2,0,-5),new Laya.Vector3(0,4,-2.5),a,30);i.addComponent(u).init(s)}createUIItem(e){let t="Hand_"+(e+1)+"_L.lh",i=n.getSprite3DResByUrl(t,this._tempItemNode,!1);i.transform.position=new Laya.Vector3(0,0,-5);let a=new Laya.Vector3(0,1,1*Math.random()+.5),s=n.BezierPoints(new Laya.Vector3(2,0,-5),new Laya.Vector3(0,4,-2.5),a,30);i.addComponent(u).init(s)}combineBody(e,t,i){this._tempItemNode.destroyChildren(),this._scene.getChildByName("Chashka_01").active=!1,this._scene.getChildByName("Object_01").active=!0,this._scene.getChildByName("Object_01").getComponent(Laya.Animator).play("start"),Laya.timer.once(400,this,()=>{this._scene.getChildByName("Object_01").getComponent(Laya.Animator).play("idle");let a=this.createMonster(e,t,i);this._tempItemNode.addChild(a),a.transform.rotate(new Laya.Vector3(0,180,0),!1,!1),a.transform.position=new Laya.Vector3(0,3.7,0),a.transform.setWorldLossyScale(new Laya.Vector3(2,2,2));let s=this._scene.getChildByName("Object_01").transform.position.clone(),r=s.clone();r.y+=.2,n.upDownTween(this._scene.getChildByName("Object_01"),s,r),(r=(s=a.transform.position.clone()).clone()).y+=.2,n.upDownTween(a,s,r)})}createMyMonster(){let e=i.getPlayerData().chooseArr.length;for(let t=0;t<e;t++){let e=i.getPlayerData().chooseArr[t],a=this.createMonster(e.bodyId,e.handId,e.backId);this._playerNode.addChild(a);let s=0;1==t&&(s=-2),2==t&&(s=2),a.transform.position=new Laya.Vector3(s,0,0),a.addComponent(g).init(!0,e)}}createEnemyMonster(){let t=i.getPlayerData().chooseArr.length;for(let i=0;i<t;i++){let t=new e;t.bodyId=n.GetRandom(0,7),t.handId=n.GetRandom(0,13),t.backId=n.GetRandom(0,13),t.type=n.GetRandom(1,5);let a=this.createMonster(t.bodyId,t.handId,t.backId);this._enemyNode.addChild(a);let s=0;1==i&&(s=-2),2==i&&(s=2),a.transform.position=new Laya.Vector3(s,0,15),a.transform.rotate(new Laya.Vector3(0,180,0),!1,!1),a.addComponent(g).init(!1,t)}}checkGameOver(){if(!this.isStartGame||this.isGameOver)return;let e=!0;for(let t=0;t<this._playerNode.numChildren;t++){if(!this._playerNode.getChildAt(t).getComponent(g).isDied){e=!1;break}}let t=!0;for(let e=0;e<this._enemyNode.numChildren;e++){if(!this._enemyNode.getChildAt(e).getComponent(g).isDied){t=!1;break}}e&&this.gameOver(!1),t&&this.gameOver(!0)}gameOver(e){Laya.timer.clearAll(this),a.DoVibrate(!1),e?(s.instance.playSoundEffect("win"),s.instance.playSoundEffect("fireWork"),w.createFireWork()):s.instance.playSoundEffect("lose"),this.isWin=e,this.isGameOver=!0,this.isStartGame=!1,Laya.Scene.close("MyScenes/GameUI.scene"),Laya.timer.once(2e3,this,()=>{d.gameOver(()=>{Laya.Scene.open("MyScenes/FinishUI.scene")})})}restartGame(){this.isStartGame=!1,this.isGameOver=!1,this.isWin=!1,this.isPause=!1,this._camera.fieldOfView=this.startCamField,this.isFinish=!1,this._camera.transform.position=this.camStartPos,this._camera.transform.rotation=this.camStartRotation,this._levelNode.destroyChildren(),this.createLevel()}}class _ extends Laya.Scene{constructor(){super(),this.freeSkin=[]}onOpened(){if(this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),this.winTitle.visible=f.Share.isWin,this.nextBtn.visible=f.Share.isWin,this.loseTitle.visible=!f.Share.isWin,this.restartBtn.visible=!f.Share.isWin,this.light1.visible=f.Share.isWin,this.bounesIcon1.visible=f.Share.isWin,this.light2.visible=f.Share.isWin,this.bounesIcon2.visible=f.Share.isWin,n.addClickEvent(this.nextBtn,this,this.closeCB),n.addClickEvent(this.restartBtn,this,this.closeCB),f.Share.isWin){let e=i.getFreeBody(),t=i.getFreeItem();this.light1.visible=e>=0,this.bounesIcon1.visible=e>=0,this.light2.visible=t>=0,this.bounesIcon2.visible=t>=0,e>=0&&(this.bounesIcon1.skin="finishUI/Items/Body_"+(e+1)+".png",i.getPlayerData().skinArr[e]=1),t>=0&&(this.bounesIcon2.skin="finishUI/Items/Hand_"+(t+1)+"_L.png",i.getPlayerData().itemArr[t]=1),i.setPlayerData()}d.inFinish()}onClosed(){}closeCB(){d.backToHome(()=>{f.Share.isWin?(i.getPlayerData().grade++,i.setPlayerData()):(i.getPlayerData().chooseArr.pop(),i.setPlayerData()),f.Share.restartGame(),Laya.Scene.open("MyScenes/StartUI.scene")})}}class p extends Laya.Script{constructor(){super(),this.myOwnwer=null}onAwake(){this.myOwnwer=this.owner}onUpdate(){this.myOwnwer.rotation+=1}}class L extends Laya.Scene{constructor(){super(),this.barArr=[0,0,0],this.timeArr=[]}onOpened(){L.Share=this,this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),Laya.timer.frameLoop(1,this,this.myUpdate);for(let e=0;e<this.skillBtnNode.numChildren;e++){let t=this.skillBtnNode.getChildAt(e);n.addClickEvent(t,this,this.clickSkillBtn,[e])}for(let e=0;e<i.getPlayerData().chooseArr.length;e++){let t=i.getPlayerData().chooseArr[e].type;this.timeArr.push(i.getSkillTimeByTypeId(t))}Laya.timer.once(5e3,this,()=>{Laya.timer.loop(50,this,this.addBar)}),d.inGame()}onClosed(){Laya.timer.clearAll(this)}updateSkillBtn(){let e=i.getPlayerData().chooseArr.length;for(let t=0;t<this.skillBtnNode.numChildren;t++){let a=this.skillBtnNode.getChildAt(t);if(t>=e){a.visible=!1;continue}a.visible=!0;let s=a.getChildByName("light"),n=a.getChildByName("bg"),r=a.getChildByName("bar"),o=a.getChildByName("icon"),h=a.getChildByName("died"),l=a.getChildByName("guide"),d=a.getChildByName("ready");s.visible=this.barArr[t]>=1,n.skin="gameUI/yxz_pj_dk"+i.getPlayerData().chooseArr[t].type+".png",r.skin="gameUI/yxz_pj_cd"+i.getPlayerData().chooseArr[t].type+".png",r.height=164*this.barArr[t],o.skin="gameUI/Body/Body_"+(i.getPlayerData().chooseArr[t].bodyId+1)+".png",h.visible=f.Share._playerNode.getChildAt(t).getComponent(g).isDied,l.visible=1==i.getPlayerData().grade&&this.barArr[t]>=1,d.visible=this.barArr[t]>=1,f.Share._playerNode.getChildAt(t).getComponent(g).isDied&&(n.gray=!0,o.gray=!0)}1==e&&(this.skillBtnNode.getChildAt(0).x=0),2==e&&(this.skillBtnNode.getChildAt(0).x=-100,this.skillBtnNode.getChildAt(1).x=100),3==e&&(this.skillBtnNode.getChildAt(0).x=0,this.skillBtnNode.getChildAt(1).x=200,this.skillBtnNode.getChildAt(2).x=-200)}clickSkillBtn(e){let t=e[0];this.barArr[t]<1||(this.barArr[t]=0,f.Share._playerNode.getChildAt(t).getComponent(g).skill())}addBar(){for(let e=0;e<this.timeArr.length;e++)f.Share._playerNode.getChildAt(e).getComponent(g).isDied?this.barArr[e]=0:(this.barArr[e]+=1/this.timeArr[e]*.05,this.barArr[e]>1&&(this.barArr[e]=1))}updatePlayerHp(){for(let e=0;e<f.Share._playerNode.numChildren;e++){let t=f.Share._playerNode.getChildAt(e),i=t.getComponent(g),a=this.playerHpNode.getChildAt(e),s=new Laya.Vector4(0,0,0),n=t.transform.position.clone();n.y+=2.5,f.Share._camera.viewport.project(n,f.Share._camera.projectionViewMatrix,s),a.pos(s.x/Laya.stage.clientScaleX,s.y/Laya.stage.clientScaleY),a.value=i.hp/i.hpMax}for(let e=0;e<f.Share._enemyNode.numChildren;e++){let t=f.Share._enemyNode.getChildAt(e),i=t.getComponent(g),a=this.enemyHpNode.getChildAt(e),s=new Laya.Vector4(0,0,0),n=t.transform.position.clone();n.y+=2.5,f.Share._camera.viewport.project(n,f.Share._camera.projectionViewMatrix,s),a.pos(s.x/Laya.stage.clientScaleX,s.y/Laya.stage.clientScaleY),a.value=i.hp/i.hpMax}}myUpdate(){this.updateSkillBtn(),this.updatePlayerHp()}}class S extends Laya.Script{constructor(){super(),this.myOwner=null}onAwake(){this.myOwner=this.owner}onUpdate(){this.myOwner.value=i.getPlayerData().grade.toString()}}class A extends Laya.Script{constructor(){super()}onAwake(){this.myOwner=this.owner,n.blinkLoop(this.myOwner)}onUpdate(){}}class B extends Laya.Scene{constructor(){super(),this.resLoaded=!1,this.sdkInited=!1}onOpened(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),Laya.Browser.onWeiXin?this.loadSubpackage():this.loadRes(),Laya.timer.frameLoop(1,this,()=>{this.bar.value+=.002,this.resLoaded&&this.sdkInited&&(s.instance.initLoading(()=>{f.Share.initScene()}),Laya.timer.clearAll(this))}),d.init(()=>{d.showLoading(()=>{this.sdkInited=!0})})}onClosed(){}loadSubpackage(){Laya.Browser.window.wx.loadSubpackage({name:"unity",success:e=>{this.loadRes()},fail:e=>{this.loadSubpackage()}}).onProgressUpdate(e=>{console.log("下载进度",e.progress),console.log("已经下载的数据长度",e.totalBytesWritten),console.log("预期需要下载的数据总长度",e.totalBytesExpectedToWrite)})}loadRes(){var e=[a.UnityPath+"Body_1.lh",a.UnityPath+"Body_2.lh",a.UnityPath+"Body_3.lh",a.UnityPath+"Body_4.lh",a.UnityPath+"Body_5.lh",a.UnityPath+"Body_6.lh",a.UnityPath+"Body_7.lh",a.UnityPath+"Body_8.lh",a.UnityPath+"Hand_1_L.lh",a.UnityPath+"Hand_2_L.lh",a.UnityPath+"Hand_3_L.lh",a.UnityPath+"Hand_4_L.lh",a.UnityPath+"Hand_5_L.lh",a.UnityPath+"Hand_6_L.lh",a.UnityPath+"Hand_7_L.lh",a.UnityPath+"Hand_8_L.lh",a.UnityPath+"Hand_9_L.lh",a.UnityPath+"Hand_10_L.lh",a.UnityPath+"Hand_11_L.lh",a.UnityPath+"Hand_12_L.lh",a.UnityPath+"Hand_13_L.lh",a.UnityPath+"Hand_14_L.lh",a.UnityPath+"EffectNode.lh"];Laya.loader.create(e,Laya.Handler.create(this,this.onComplete),Laya.Handler.create(this,this.onProgress))}onComplete(){this.resLoaded=!0}onProgress(e){}}class b extends Laya.Script{constructor(){super(),this.startY=0}onAwake(){this.myOwner=this.owner,this.startY=this.myOwner.y,this.startTween()}startTween(){Laya.Tween.to(this.myOwner,{y:this.startY+50},1e3,Laya.Ease.sineInOut,new Laya.Handler(this,()=>{Laya.Tween.to(this.myOwner,{y:this.startY},1e3,Laya.Ease.sineInOut,new Laya.Handler(this,()=>{this.startTween()}))}))}}class C extends Laya.Scene{constructor(){super(),this.atkNum=0,this.hpNum=0,this.tempAtkNum=0,this.tempHpNum=0,this.bodyId=0,this.handId=0,this.backId=0,this.type=1,this.selectStep=0,this.itemCountArr=[]}onOpened(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),Laya.timer.frameLoop(1,this,this.myUpdate),n.addClickEvent(this.startBtn,this,this.startBtnCB);for(let e=0;e<i.getPlayerData().itemArr.length;e++)this.itemCountArr.push(2);this.initList(),this.startBtn.getChildAt(0).visible=1==i.getPlayerData().grade,l.showBannerAd()}onClosed(){Laya.timer.clearAll(this)}updateDataNode(){let e=this.dataNode.getChildByName("top"),t=(this.dataNode.getChildByName("btm"),this.dataNode.getChildByName("atk")),i=this.dataNode.getChildByName("hp"),a=Math.floor(this.atkNum/200)+1>5?5:Math.floor(this.atkNum/200)+1;e.skin="startUI/pzy_pj_"+a+".png",this.type=a,this.atkNum<this.tempAtkNum&&(this.atkNum+=5),this.hpNum<this.tempHpNum&&(this.hpNum+=5),this.atkNum>this.tempAtkNum&&(this.atkNum=this.tempAtkNum),this.hpNum>this.tempHpNum&&(this.hpNum=this.tempHpNum),t.value=Math.floor(this.atkNum).toString(),i.value=Math.floor(this.hpNum).toString()}addAtkHp(){if(0==this.selectStep){let e=50*Math.random()+50*this.bodyId;this.tempHpNum=e}else if(1==this.selectStep){let e=50*Math.random()+(40*this.handId+40*this.backId);this.tempAtkNum=e}else if(2==this.selectStep){let e=50*Math.random()+(40*this.handId+40*this.backId);this.tempAtkNum=e}}updateList(){let e=[];e=0==this.selectStep?[].concat(i.getPlayerData().skinArr):[].concat(i.getPlayerData().itemArr),this.myList.array=e}initList(){let e=[];e=[].concat(i.getPlayerData().skinArr),this.myList.hScrollBarSkin="",this.myList.array=e,this.myList.repeatX=e.length,this.myList.repeatY=1,this.myList.renderHandler=Laya.Handler.create(this,this.onListRender,null,!1)}onListRender(e,t){if(t>=this.myList.array.length)return;var a=e.getChildByName("item");let s=a.getChildByName("icon"),r=a.getChildByName("nameBg").getChildByName("name"),o=a.getChildByName("count"),h=a.getChildByName("adPic"),l=a.getChildByName("guide");0==this.selectStep?(s.skin="finishUI/Items/Body_"+(t+1)+".png",r.text=i.getBodyNameById(t),o.visible=!1,h.visible=0==i.getPlayerData().skinArr[t],l.visible=1==i.getPlayerData().grade&&0==t):(s.skin="finishUI/Items/Hand_"+(t+1)+"_L.png",r.text=i.getItemNameById(t),o.visible=1==i.getPlayerData().itemArr[t],o.value=this.itemCountArr[t].toString(),h.visible=0==i.getPlayerData().itemArr[t],1==this.selectStep?l.visible=1==i.getPlayerData().grade&&0==t:2==this.selectStep&&(l.visible=1==i.getPlayerData().grade&&1==t)),n.addClickEvent(a,this,this.chooseCB,[t])}chooseCB(e){let t=e[0];if(0==this.selectStep){if(0==i.getPlayerData().skinArr[t]){let e=()=>{i.getPlayerData().skinArr[t]=1,i.setPlayerData(),this.updateList()};return void l.showVideoAd(e)}this.bodyId=t+1,this.addAtkHp(),this.selectStep++,this.updateList(),this.myList.scrollTo(0),f.Share.createUIBody(t)}else if(1==this.selectStep){if(0==i.getPlayerData().itemArr[t]){let e=()=>{i.getPlayerData().itemArr[t]=1,i.setPlayerData(),this.updateList()};return void l.showVideoAd(e)}this.itemCountArr[t]-=1,this.handId=t+1,this.addAtkHp(),this.selectStep++,this.updateList(),f.Share.createUIItem(t)}else if(2==this.selectStep){if(0==i.getPlayerData().itemArr[t]){let e=()=>{i.getPlayerData().itemArr[t]=1,i.setPlayerData(),this.updateList()};return void l.showVideoAd(e)}this.itemCountArr[t]-=1,this.backId=t+1,this.addAtkHp(),this.updateList(),f.Share.createUIItem(t),this.selectStep++,this.selectBg.visible=!1,Laya.timer.once(2500,this,()=>{let e=f.Share._camera.transform.rotationEuler.clone();e.x+=15,n.RotateTo(f.Share._camera,500,e,null),w.createWindTurn(new Laya.Vector3(0,2.2,0)),s.instance.playSoundEffect("wind"),Laya.timer.once(2800,this,()=>{w.createSmoke(new Laya.Vector3(0,0,0)),s.instance.playSoundEffect("merge"),f.Share.combineBody(this.bodyId-1,this.handId-1,this.backId-1),(e=f.Share._camera.transform.rotationEuler.clone()).x-=15}),Laya.timer.once(5e3,this,()=>{this.startBtn.visible=!0})})}}startBtnCB(){this.close(),i.setChooseItem(this.bodyId-1,this.handId-1,this.backId-1,this.type),f.Share.gameStart()}myUpdate(){this.updateDataNode(),this.selectNum.text=": "+this.selectStep+" / 3"}}class v extends Laya.Script{constructor(){super()}onAwake(){this.myOwnwer=this.owner,this.scaleLoop(this.myOwnwer,1.1,400)}scaleLoop(e,t,i){Laya.Tween.to(e,{scaleX:t,scaleY:t},i,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{scaleX:1,scaleY:1},i,null,new Laya.Handler(this,()=>{this.scaleLoop(e,t,i)}))}))}}class x extends Laya.Scene{constructor(){super()}onOpened(){s.instance.playMusic("bgm"),this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),n.addClickEvent(this.startBtn,this,this.startBtnCB),d.inHome()}onClosed(){}startBtnCB(){d.startGame(()=>{Laya.Scene.open("MyScenes/SelectUI.scene")})}}class I{static getRangeNumer(e,t){return Math.random()*(t-e)+e}static addClickEvent(e,t,i,a,s){if(e.offAllCaller(t),e instanceof Laya.Button&&!s){let s=e=>{i&&i.call(t,e)};e.on(Laya.Event.CLICK,t,s,[a])}else{let s=60,n=1,r=e.scaleX*n,o=e.scaleY*n,h=.9*n,l=!1,d=t=>{l=!0,Laya.Tween.to(e,{scaleX:h,scaleY:h},s)};e.on(Laya.Event.MOUSE_DOWN,t,d,[a]);let c=a=>{0!=l&&(l=!1,Laya.Tween.to(e,{scaleX:r,scaleY:o},s,null,new Laya.Handler(t,()=>{i&&i.call(t,a)})))};e.on(Laya.Event.MOUSE_UP,t,c,[a]);let y=t=>{Laya.Tween.to(e,{scaleX:r,scaleY:o},s)};e.on(Laya.Event.MOUSE_OUT,t,y,[a])}}}class k extends Laya.Scene{constructor(){super(...arguments),this.clickCount=0,this.triggerNum=.7,this.index=0,this.type=1,this.wuchuCount=1,this.hadShowBanner=!1,this.onShowCB=null}onAwake(){this.size(Laya.stage.width,Laya.stage.height)}onOpened(e){switch(e&&e.ccb&&(this.ccb=e.ccb),e&&e.index&&(this.index=e.index),this.index){case 0:this.type=o.data.front_box_dangezi_number,this.wuchuCount=o.data.front_box_dangezi_times;break;case 1:this.type=o.data.front_box_second_number,this.wuchuCount=o.data.front_box_second_times}this.triggerNum=I.getRangeNumer(.2,.6),l.hideBannerAd(),this.btnClick.on(Laya.Event.MOUSE_DOWN,this,()=>{this.onPress(),this.btnClick.scale(1.1,1.1)}),this.btnClick.on(Laya.Event.MOUSE_UP,this,()=>{this.btnClick.scale(1,1)}),Laya.timer.frameLoop(1,this,this.reFreshUI),o.isPortrait&&(this.pBar.centerY=300),this.onShowCB=(()=>{this.close()}),Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onShow(this.onShowCB)}onClosed(){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offShow(this.onShowCB),Laya.timer.clearAll(this),l.hideBannerAd(),l.visibleFirstBoxGridAd(!1),l.visibleSecondBoxGridAd(!1),Laya.timer.once(100,this,()=>{this.ccb&&this.ccb()}),Laya.timer.once(1e3,this,()=>{l.visibleFirstBoxGridAd(!1),l.visibleSecondBoxGridAd(!1)})}onPress(){this.pBar.value+=.15,Laya.Tween.to(this.box,{scaleX:1.1,scaleY:1.1},100,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.box,{scaleX:1,scaleY:1},100)})),this.pBar.value>=this.triggerNum&&!this.hadShowBanner&&(this.hadShowBanner=!0,this.clickCount++,this.triggerNum=I.getRangeNumer(.2,.6),1==this.type?0==this.index?l.visibleFirstBoxGridAd(!0):l.visibleSecondBoxGridAd(!0):2==this.type&&l.showBannerAd(),Laya.timer.once(2e3,this,()=>{this.clickCount>=this.wuchuCount?this.close():(this.hadShowBanner=!1,this.pBar.value=0,1==this.type?(l.visibleFirstBoxGridAd(!1),l.visibleSecondBoxGridAd(!1)):2==this.type&&l.hideBannerAd())}))}reFreshUI(){this.pBar.value-=.0125}}class N extends Laya.Script{constructor(){super(),this.myScale=null}onAwake(){this.myOwnwer=this.owner,this.myScale=new Laya.Vector2(this.myOwnwer.scaleX,this.myOwnwer.scaleY),this.scaleLoop(this.myOwnwer,.1,400)}scaleLoop(e,t,i){Laya.Tween.to(e,{scaleX:this.myScale.x+t,scaleY:this.myScale.y+t},i,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{scaleX:this.myScale.x,scaleY:this.myScale.y},i,null,new Laya.Handler(this,()=>{this.scaleLoop(e,t,i)}))}))}}class G extends Laya.Script{constructor(){super(),this.myOwnwer=null}onAwake(){this.myOwnwer=this.owner}onUpdate(){this.myOwnwer.rotation+=1}}class D extends Laya.Scene{constructor(){super(...arguments),this.clickCount=0,this.triggerNum=.7,this.curProgress=0,this.hadShowBanner=!1}onAwake(){this.size(Laya.stage.width,Laya.stage.height)}onOpened(e){e&&e.ccb&&(this.ccb=e.ccb),this.box.on(Laya.Event.MOUSE_DOWN,this,()=>{this.boxBtnCB(),this.box.scale(1.1,1.1)}),this.box.on(Laya.Event.MOUSE_UP,this,()=>{this.box.scale(1,1)}),this.triggerNum=I.getRangeNumer(.2,.6),Laya.timer.frameLoop(1,this,this.reFreshUI),l.showBannerAd(),this.onShowCB=(()=>{this.close()}),Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onShow(this.onShowCB),this.scaleLoop(this.finger,1.2,200)}onClosed(){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offShow(this.onShowCB),Laya.timer.clearAll(this),l.hideBannerAd(),l.visibleMidBoxGridAd(!1),Laya.timer.once(100,this,()=>{this.ccb&&this.ccb()}),Laya.timer.once(1e3,this,()=>{l.visibleMidBoxGridAd(!1)})}boxBtnCB(){this.curProgress+=.15,this.curProgress>=this.triggerNum&&!this.hadShowBanner&&(this.hadShowBanner=!0,this.clickCount++,this.triggerNum=I.getRangeNumer(.2,.6),l.visibleMidBoxGridAd(!0),Laya.timer.once(2e3,this,()=>{this.clickCount>=o.data.front_box_before_times?this.close():(l.visibleMidBoxGridAd(!1),this.hadShowBanner=!1,this.curProgress=0)}))}reFreshUI(){this.curProgress-=.0115,this.curProgress<0&&(this.curProgress=0)}scaleLoop(e,t,i){Laya.Tween.to(e,{scaleX:t,scaleY:t},i,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{scaleX:1,scaleY:1},i,null,new Laya.Handler(this,()=>{this.scaleLoop(e,t,i)}))}))}}class T extends Laya.Scene{constructor(){super()}onOpened(e){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),I.addClickEvent(this.remenBtn,this,this.remenCB),this.remenBtn.visible=o.data.front_more_haowan_switch}onClosed(){}remenCB(){d.moreGame()}}class M extends Laya.Scene{constructor(){super(),this.ccb=null,this.onShowCB=null,this.clickCount=0,this.index=y.RM_rmxyx,this.type=1,this.isWuchu=!1,this.gridFuncName=""}onAwake(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight)}onOpened(e){switch(e&&e.ccb&&(this.ccb=e.ccb),e&&null!=e.index&&(this.index=e.index),this.title.getChildAt(this.index).visible=!0,I.addClickEvent(this.btnContinue,this,this.btnContinueCB),l.visibleFullGridAd(!0),this.index){case 0:this.type=o.data.front_small_remen_number,this.isWuchu=o.data.front_small_wuchu_switch;break;case 1:this.type=o.data.front_tuijian_remen_number,this.isWuchu=o.data.front_tuijian_wuchu_switch;break;case 2:this.type=o.data.front_game_remen_number,this.isWuchu=o.data.front_game_wuchu_switch;break;case 3:this.type=o.data.front_order_remen_number,this.isWuchu=o.data.front_order_wuchu_switch}this.isWuchu&&this.showHide(),this.onShowCB=(()=>{this.close()}),Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onShow(this.onShowCB)}onClosed(){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offShow(this.onShowCB),Laya.timer.clearAll(this),l.hideBannerAd(),l.visibleFullSingleGridAd(!1),l.visibleFullGridAd(!1),Laya.timer.once(100,this,()=>{this.ccb&&this.ccb()}),Laya.timer.once(1e3,this,()=>{l.visibleFullSingleGridAd(!1),l.visibleFullGridAd(!1)})}showHide(){2==this.type?(l.hideBannerAd(),Laya.timer.once(o.data.front_gezi_time,this,()=>{l.showBannerAd(),Laya.timer.once(800,this,()=>{this.showHide()})})):1==this.type&&(l.visibleFullSingleGridAd(!0),Laya.timer.once(o.data.front_gezi_time,this,()=>{l.visibleFullSingleGridAd(!1),Laya.timer.once(800,this,()=>{this.showHide()})}))}btnContinueCB(){this.clickCount++,this.clickCount>=o.data.front_gezi_number&&this.close()}}class O extends Laya.Scene{constructor(){super()}onOpened(e){e&&e.ccb&&(this.ccb=e.ccb),this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),I.addClickEvent(this.btnGet,this,this.btnGetCB),I.addClickEvent(this.btnCancel,this,this.btnCancelCB),this.icon.skin=o.data.front_pifu_picture,o.isPortrait?l.showBannerAd():l.hideBannerAd()}onClosed(){Laya.timer.once(100,this,()=>{this.ccb&&this.ccb()})}btnGetCB(){this.showAd()}btnCancelCB(){o.data.front_pifu_cancel_switch?this.showAd():Laya.Scene.close(c.SGSkin)}showAd(){l.showVideoAd(()=>{Laya.Browser.window.wx.showToast({title:"恭喜获得1000金币！",duration:2e3,mask:!1,icon:"none"}),Laya.Scene.close(c.SGSkin)},()=>{this.showWxVirtual()},null,!0)}showWxVirtual(){o.data.front_video_tanchuang_switch?Laya.Browser.window.wx.showModal({title:"提示",content:"未观看完广告无法获取奖励，是否继续？",success(e){e.confirm?l.showVideoAd(()=>{Laya.Browser.window.wx.showToast({title:"恭喜获得1000金币！",duration:2e3,mask:!1,icon:"none"})},null,()=>{Laya.Scene.close(c.SGSkin)}):e.cancel&&(o.data.front_video_cancel_switch?l.showVideoAd(()=>{Laya.Browser.window.wx.showToast({title:"恭喜获得1000金币！",duration:2e3,mask:!1,icon:"none"})},null,()=>{Laya.Scene.close(c.SGSkin)}):Laya.Scene.close(c.SGSkin))}}):Laya.Scene.close(c.SGSkin)}}class H{constructor(){}static init(){var e=Laya.ClassUtils.regClass;e("View/FinishUI.ts",_),e("Libs/RotateLoop.ts",p),e("View/GameUI.ts",L),e("Mod/UpdateGrade.ts",S),e("Libs/Blink.ts",A),e("View/LoadingUI.ts",B),e("Mod/UpDownLoop.ts",b),e("View/SelectUI.ts",C),e("Libs/ScaleLoop.ts",v),e("View/StartUI.ts",x),e("SGSDK/SGBoxBottom.ts",k),e("SGSDK/SGScale.ts",N),e("SGSDK/SGRotate.ts",G),e("SGSDK/SGBoxMiddle.ts",D),e("SGSDK/SGHomeUI.ts",T),e("SGSDK/SGRemen.ts",M),e("SGSDK/SGSkin.ts",O)}}H.width=750,H.height=1334,H.scaleMode="fixedwidth",H.screenMode="vertical",H.alignV="top",H.alignH="left",H.startScene="SGScene/SGBoxMiddle.scene",H.sceneRoot="",H.debug=!1,H.stat=!1,H.physicsDebug=!1,H.exportSceneToJson=!0,H.init();new class{constructor(){window.Laya3D?Laya3D.init(H.width,H.height):Laya.init(H.width,H.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=H.scaleMode,Laya.stage.screenMode=H.screenMode,Laya.stage.alignV=H.alignV,Laya.stage.alignH=H.alignH,Laya.URL.exportSceneToJson=H.exportSceneToJson,Laya.stage.useRetinalCanvas=!0,(H.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),H.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),H.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){new f}}}();